<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>16&nbsp; Asignación taxonómica – Workshop</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./17Asignaciontaxonomica.html" rel="next">
<link href="./15Ensamblemetagenomico.html" rel="prev">
<link href="./rsgMexico.jpeg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b4769d4efdca78c57d6efa02c7377920.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-b8fe0e0e59d85b1c54ceb4dd9ede1a89.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12Iniciandomiproyectometagenomico.html"><strong>Sección 4</strong> - Procesamiento y visualización de datos metagenómicos</a></li><li class="breadcrumb-item"><a href="./16Binningmetagenomico.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Asignación taxonómica</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Workshop</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://iscb-rsg-mexico.github.io/Taller_Metagenomica/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-git"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Información general</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Sección 1</strong> - Organización de proyectos metagenómicos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1Ordendedatos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organización de proyectos metagenómicos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2Planificaciondeproyectos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Planificación de proyectos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3DatosdeNCBI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Examinando datos del NCBI</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Sección 2</strong> - Introducción a línea de comandos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4IntroduccionnavigationShell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introducción a Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5Operacionesyexploraciondefastq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Operaciones en archivos y carpetas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6Redireccion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Redirección</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7Buclesscriptsdescarga.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Bucles</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8Organizacionproyecto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Organización de proyectos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Sección 3</strong> - Primeros pasos con R Studio</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9IntroduccionRStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introducción a R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10Tiposdedatos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Estructuras de datos en R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11Graficandoconggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Creando gráficos con ggplot2</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Sección 4</strong> - Procesamiento y visualización de datos metagenómicos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12Iniciandomiproyectometagenomico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Iniciando mi proyecto metagenómico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13Controldecalidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Control de calidad</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14Filtraciondedatosdesecuenciacion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Filtración de datos de secuenciación</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15Ensamblemetagenomico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Binning metagenómico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16Binningmetagenomico.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Asignación taxonómica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17Asignaciontaxonomica.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Explorando la diversidad con librerías de R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18Exploraciondetaxonomiaconr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Análisis de taxonomía con R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19Exploraciondediversidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Control de calidad</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20Analisistaxonomico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Control de calidad</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21Otrosrecursos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Control de calidad</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#qué-es-la-asignación-taxonómica" id="toc-qué-es-la-asignación-taxonómica" class="nav-link active" data-scroll-target="#qué-es-la-asignación-taxonómica"><span class="header-section-number">16.0.1</span> ¿Qué es la asignación taxonómica?</a></li>
  <li><a href="#estrategias-para-la-asignación-taxonómica" id="toc-estrategias-para-la-asignación-taxonómica" class="nav-link" data-scroll-target="#estrategias-para-la-asignación-taxonómica"><span class="header-section-number">16.0.2</span> <strong>Estrategias para la asignación taxonómica</strong></a></li>
  <li><a href="#sesgo-de-abundancia" id="toc-sesgo-de-abundancia" class="nav-link" data-scroll-target="#sesgo-de-abundancia"><span class="header-section-number">16.0.3</span> <strong>Sesgo de abundancia</strong></a></li>
  <li><a href="#usando-kraken-2" id="toc-usando-kraken-2" class="nav-link" data-scroll-target="#usando-kraken-2"><span class="header-section-number">16.1</span> <strong>Usando Kraken 2</strong></a>
  <ul>
  <li><a href="#asignación-taxonómica-de-lecturas-metagenómicas" id="toc-asignación-taxonómica-de-lecturas-metagenómicas" class="nav-link" data-scroll-target="#asignación-taxonómica-de-lecturas-metagenómicas"><span class="header-section-number">16.1.1</span> <strong>Asignación taxonómica de lecturas metagenómicas</strong></a></li>
  <li><a href="#asignación-taxonómica-de-los-contigs-de-un-mag" id="toc-asignación-taxonómica-de-los-contigs-de-un-mag" class="nav-link" data-scroll-target="#asignación-taxonómica-de-los-contigs-de-un-mag"><span class="header-section-number">16.1.2</span> <strong>Asignación taxonómica de los contigs de un MAG</strong></a></li>
  </ul></li>
  <li><a href="#visualización-de-los-resultados-de-la-asignación-taxonómica" id="toc-visualización-de-los-resultados-de-la-asignación-taxonómica" class="nav-link" data-scroll-target="#visualización-de-los-resultados-de-la-asignación-taxonómica"><span class="header-section-number">16.2</span> <strong>Visualización de los resultados de la asignación taxonómica</strong></a>
  <ul>
  <li><a href="#corona" id="toc-corona" class="nav-link" data-scroll-target="#corona"><span class="header-section-number">16.2.1</span> <strong>Corona</strong></a></li>
  <li><a href="#pavía" id="toc-pavía" class="nav-link" data-scroll-target="#pavía"><span class="header-section-number">16.2.2</span> <strong>Pavía</strong></a></li>
  </ul></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="header-section-number">16.3</span> <img src="figures/asignaciontax3.png" class="img-fluid"></a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"><span class="header-section-number">16.4</span> <img src="figures/asignaciontax5.png" class="img-fluid"></a>
  <ul>
  <li><a href="#lecturas-no-clasificadas" id="toc-lecturas-no-clasificadas" class="nav-link" data-scroll-target="#lecturas-no-clasificadas"><span class="header-section-number">16.4.1</span> Lecturas no clasificadas</a></li>
  </ul></li>
  <li><a href="#referencias" id="toc-referencias" class="nav-link" data-scroll-target="#referencias"><span class="header-section-number">16.5</span> Referencias</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12Iniciandomiproyectometagenomico.html"><strong>Sección 4</strong> - Procesamiento y visualización de datos metagenómicos</a></li><li class="breadcrumb-item"><a href="./16Binningmetagenomico.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Asignación taxonómica</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Asignación taxonómica</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="qué-es-la-asignación-taxonómica" class="level3" data-number="16.0.1">
<h3 data-number="16.0.1" class="anchored" data-anchor-id="qué-es-la-asignación-taxonómica"><span class="header-section-number">16.0.1</span> ¿Qué es la asignación taxonómica?</h3>
<p>Una asignación taxonómica es un proceso que consiste en asignar una Unidad Taxonómica Operativa (OTU, es decir, grupos de individuos relacionados) a secuencias que pueden ser lecturas o contigs. Las secuencias se comparan con una base de datos construida a partir de genomas completos. Cuando una secuencia encuentra una coincidencia suficientemente buena en la base de datos, se asigna a la OTU correspondiente.</p>
</section>
<section id="estrategias-para-la-asignación-taxonómica" class="level3" data-number="16.0.2">
<h3 data-number="16.0.2" class="anchored" data-anchor-id="estrategias-para-la-asignación-taxonómica"><span class="header-section-number">16.0.2</span> <strong>Estrategias para la asignación taxonómica</strong></h3>
<p>Existen muchos programas para realizar mapeo taxonómico, y casi todos ellos siguen una de las siguientes estrategias:</p>
<ol type="1">
<li><p>BLAST: Utilizando <a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi">BLAST</a> o <a href="https://github.com/bbuchfink/diamond">DIAMOND</a>, estos mapeadores buscan la coincidencia más probable para cada secuencia dentro de una base de datos de genomas. Esta estrategia es lenta.</p></li>
<li><p>Marcadores: Buscan marcadores de una base de datos realizada <em>a priori</em> en las secuencias a clasificar y les asignan la taxonomía en función de los hits obtenidos.</p></li>
<li><p>K-meros: Una base de datos genómica se divide en fragmentos de longitud <em>k</em> para poder buscar fragmentos únicos por grupo taxonómico, desde el ancestro común más antiguo (LCA), pasando por el phyllum hasta la especie.</p></li>
</ol>
</section>
<section id="sesgo-de-abundancia" class="level3" data-number="16.0.3">
<h3 data-number="16.0.3" class="anchored" data-anchor-id="sesgo-de-abundancia"><span class="header-section-number">16.0.3</span> <strong>Sesgo de abundancia</strong></h3>
<p>Al realizar la asignación taxonómica de metagenomas, un resultado clave es la abundancia de cada taxón u OTU en la muestra. La abundancia absoluta de un taxón es el número de secuencias (lecturas o contigs, según el método) asignadas. Además, su abundancia relativa es la proporción de secuencias asignadas. Es fundamental tener en cuenta los numerosos sesgos que pueden distorsionar las abundancias a lo largo del proceso metagenómico, como se muestra en la figura, y que, debido a ellos, es posible que no obtengamos la abundancia real de los organismos en la muestra.</p>
</section>
<section id="usando-kraken-2" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="usando-kraken-2"><span class="header-section-number">16.1</span> <strong>Usando Kraken 2</strong></h2>
<p><a href="https://ccb.jhu.edu/software/kraken2/">Kraken 2</a> es la versión más nueva de Kraken, un sistema de clasificación taxonómica que utiliza coincidencias exactas de k-mer para lograr una alta precisión y velocidades de clasificación rápidas. <code>kraken2</code>ya está instalado en el <strong>entorno de metagenómica</strong> , echemos un vistazo a <code>kraken2</code>la ayuda.</p>
<pre><code>$ kraken2  --help </code></pre>
<pre><code>Need to specify input filenames! Usage: kraken2 [options] &lt;filename(s)&gt;  Options:   --db NAME               Name for Kraken 2 DB                           (default: none)   --threads NUM           Number of threads (default: 1)   --quick                 Quick operation (use first hit or hits)   --unclassified-out FILENAME                           Print unclassified sequences to filename   --classified-out FILENAME                           Print classified sequences to filename   --output FILENAME       Print output to filename (default: stdout); "-" will                           suppress normal output   --confidence FLOAT      Confidence score threshold (default: 0.0); must be                           in [0, 1].   --minimum-base-quality NUM                           Minimum base quality used in classification (def: 0,                           only effective with FASTQ input).   --report FILENAME       Print a report with aggregate counts/clade to file   --use-mpa-style         With --report, format report output like Kraken 1's                           kraken-mpa-report   --report-zero-counts    With --report, report counts for ALL taxa, even if                           counts are zero   --report-minimizer-data With --report, report minimizer, and distinct minimizer                           count information in addition to normal Kraken report   --memory-mapping        Avoids loading database into RAM   --paired                The filenames provided have paired-end reads   --use-names             Print scientific names instead of just taxids   --gzip-compressed       Input files are compressed with gzip   --bzip2-compressed      Input files are compressed with bzip2   --minimum-hit-groups NUM                           Minimum number of hit groups (overlapping k-mers                           sharing the same minimizer) needed to make a call                           (default: 2)   --help                  Print this message   --version               Print version information  If none of the *-compressed flags are specified, and the filename provided is a regular file, automatic format detection is attempted.  </code></pre>
<p>En la ayuda, vemos que, además de nuestros archivos de entrada, también necesitamos una base de datos para compararlos. La base de datos que utilice determinará el resultado que obtenga. Imagine que busca un linaje recientemente descubierto que no forma parte de las bases de datos disponibles. ¿Lo encontraría?</p>
<p>Existen <a href="http://ccb.jhu.edu/software/kraken2/downloads.shtml">varias bases de datos</a> compatibles para ser utilizadas con kraken2 en el proceso de asignación taxonómica.</p>
<p>Desafortunadamente, incluso la base de datos más pequeña de Kraken, Minikraken, que requiere 8 GB de RAM libre, no es lo suficientemente pequeña para las máquinas que usamos, por lo que <strong>no podremos ejecutarla<code>kraken2</code></strong> . Podemos comprobar nuestra RAM disponible con <code>free -h</code>para asegurarnos.</p>
<pre><code>$ free -h </code></pre>
<pre><code>              total        used        free      shared  buff/cache   available Mem:           3.9G        272M        3.3G         48M        251M        3.3G Swap:            0B          0B          0B </code></pre>
<section id="asignación-taxonómica-de-lecturas-metagenómicas" class="level3" data-number="16.1.1">
<h3 data-number="16.1.1" class="anchored" data-anchor-id="asignación-taxonómica-de-lecturas-metagenómicas"><span class="header-section-number">16.1.1</span> <strong>Asignación taxonómica de lecturas metagenómicas</strong></h3>
<p>Como hemos aprendido, las asignaciones taxonómicas pueden intentarse antes del ensamblaje. En este caso, usaríamos archivos FASTQ como entrada, que serían <code>JP4D_R1.trim.fastq.gz</code>y <code>JP4D_R2.trim.fastq.gz</code>. Y las salidas serían dos archivos: el informe <code>JP4D.report</code>y el archivo Kraken <code>JP4D.kraken</code>.</p>
<p>Para ejecutar kraken2, usaríamos un comando como este:<br>
<strong>No es necesario ejecutar esto</strong></p>
<pre><code>$ mkdir TAXONOMY_READS $ kraken2 --db kraken-db --threads 8 --paired JP4D_R1.trim.fastq.gz JP4D_R2.trim.fastq.gz --output TAXONOMY_READS/JP4D.kraken --report TAXONOMY_READS/JP4D.report </code></pre>
<p>Como no podemos ejecutarlo <code>kraken2</code>aquí, precalculamos sus resultados en un servidor, es decir, en una máquina más potente. En el servidor, ejecutamos <code>kraken2</code>y obtuvimos [ <code>JP4D-kraken.kraken</code>y] <code>JP4D.report</code>.</p>
<p>Veamos las salidas precalculadas <code>kraken2</code>para nuestras lecturas JP4D.</p>
<pre><code>head ~/dc_workshop/taxonomy/JP4D.kraken   </code></pre>
<pre><code>U   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:19691:2037   0   250|251 0:216 |:| 0:217 U   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:14127:2052   0   250|238 0:216 |:| 0:204 U   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:14766:2063   0   251|251 0:217 |:| 0:217 C   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:15697:2078   2219696 250|120 0:28 350054:5 1224:2 0:1 2:5 0:77 2219696:5 0:93 |:| 379:4 0:82 U   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:15529:2080   0   250|149 0:216 |:| 0:115 U   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:14172:2086   0   251|250 0:217 |:| 0:216 U   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:17552:2088   0   251|249 0:217 |:| 0:215 U   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:14217:2104   0   251|227 0:217 |:| 0:193 C   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:15110:2108   2109625 136|169 0:51 31989:5 2109625:7 0:39 |:| 0:5 74033:2 31989:5 1077935:1 31989:7 0:7 60890:2 0:105 2109625:1 C MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:19558:2111   119045  251|133 0:18 1224:9 2:5 119045:4 0:181 |:| 0:99 </code></pre>
<p>Esta información podría necesitar aclaración. Consultemos nuestra hoja de referencia para comprender algunos de sus componentes:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Ejemplo de columna</th>
<th style="text-align: left;">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">do</td>
<td style="text-align: left;">Clasificado o no clasificado</td>
</tr>
<tr class="even">
<td style="text-align: left;">MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:15697:2078</td>
<td style="text-align: left;">Encabezado FASTA de la secuencia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2219696</td>
<td style="text-align: left;">Identificación fiscal</td>
</tr>
<tr class="even">
<td style="text-align: left;">250:120</td>
<td style="text-align: left;">Longitud de lectura</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0:28 350054:5 1224:2 0:1 2:5 0:77 2219696:5 0:93 379:4 0:82</td>
<td style="text-align: left;">Los kmers coinciden con un ID taxonómico <em>, p.&nbsp;ej.,</em> el ID fiscal 350054 tiene cinco coincidencias, el ID fiscal 1224 tiene dos coincidencias, etc.</td>
</tr>
</tbody>
</table>
<p>El archivo Kraken podría ser más legible. Analicemos el archivo del informe:</p>
<pre><code>head ~/dc_workshop/taxonomy/JP4D.report </code></pre>
<pre><code> 78.13  587119  587119  U   0   unclassified  21.87 164308  1166    R   1   root  21.64 162584  0   R1  131567    cellular organisms  21.64 162584  3225    D   2       Bacteria  18.21 136871  3411    P   1224          Proteobacteria  14.21 106746  3663    C   28211           Alphaproteobacteria   7.71  57950   21  O   204455            Rhodobacterales   7.66    57527   6551    F   31989               Rhodobacteraceae   1.23 9235    420 G   1060                  Rhodobacter   0.76    5733    4446    S   1063                    Rhodobacter sphaeroides </code></pre>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Ejemplo de columna</th>
<th style="text-align: left;">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">78.13</td>
<td style="text-align: left;">Porcentaje de lecturas cubiertas por el clado enraizado en este taxón</td>
</tr>
<tr class="even">
<td style="text-align: left;">587119</td>
<td style="text-align: left;">Número de lecturas cubiertas por el clado enraizado en este taxón</td>
</tr>
<tr class="odd">
<td style="text-align: left;">587119</td>
<td style="text-align: left;">Número de lecturas asignadas directamente a este taxón</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tú</td>
<td style="text-align: left;">Un código de rango que indica (Sin)clasificar, (Dominio), (Reino), (Filo), (Clase), (Orden), (Familia), (Género) o (Especie. Todos los demás rangos se indican simplemente con ‘-’.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">Identificación de taxonomía del NCBI</td>
</tr>
<tr class="even">
<td style="text-align: left;">sin clasificar</td>
<td style="text-align: left;">Nombre científico con sangría</td>
</tr>
</tbody>
</table>
</section>
<section id="asignación-taxonómica-de-los-contigs-de-un-mag" class="level3" data-number="16.1.2">
<h3 data-number="16.1.2" class="anchored" data-anchor-id="asignación-taxonómica-de-los-contigs-de-un-mag"><span class="header-section-number">16.1.2</span> <strong>Asignación taxonómica de los contigs de un MAG</strong></h3>
<p>Ahora tenemos la identidad taxonómica de las lecturas de todo el metagenoma, pero necesitamos saber a qué taxón corresponden nuestros MAG. Para ello, debemos realizar la asignación taxonómica con sus contigs en lugar de sus lecturas, ya que no disponemos de las lecturas correspondientes a un MAG separadas de las lecturas de toda la muestra.</p>
<p>Para esto, <code>kraken2</code>es un poco diferente; aquí podemos ver el comando para el <code>JP4D.001.fasta</code>MAG:</p>
<p><strong>No es necesario ejecutar esto</strong></p>
<pre><code>$ mkdir TAXONOMY_MAG $ kraken2 --db kraken-db --threads 12 -input JP4D.001.fasta --output TAXONOMY_MAG/JP4D.001.kraken --report TAXONOMY_MAG/JP4D.001.report </code></pre>
<p>Los resultados de esto se calculan previamente en el <code>~/dc_workshop/taxonomy/mags_taxonomy/</code>directorio.</p>
<pre><code>$ cd ~/dc_workshop/taxonomy/mags_taxonomy $ ls </code></pre>
<pre><code>JP4D.001.kraken JP4D.001.report </code></pre>
<pre><code>more ~/dc_workshop/taxonomy/mags_taxonomy/JP4D.001.report </code></pre>
<pre><code> 50.96  955 955 U   0   unclassified  49.04 919 1   R   1   root  48.83 915 0   R1  131567    cellular organisms  48.83 915 16  D   2       Bacteria  44.40 832 52  P   1224          Proteobacteria  19.37 363 16  C   28216           Betaproteobacteria  16.22   304 17  O   80840             Burkholderiales   5.66    106 12  F   506             Alcaligenaceae   2.72   51  3   G   517               Bordetella   1.12 21  21  S   2163011                 Bordetella sp. HZ20   .   .   . </code></pre>
<p>Al examinar el informe, observamos que la mitad de los contigs no están clasificados y que a una pequeña proporción se les ha asignado una OTU. Este resultado es extraño, ya que esperábamos encontrar solo un genoma en el bin.</p>
<p>Para ejemplificar cómo debería ser un informe de un MAG completo y no contaminado, veamos el informe de este MAG de otro estudio:</p>
<pre><code>100.00  108 0   R   1   root 100.00 108 0   R1  131567    cellular organisms 100.00 108 0   D   2       Bacteria 100.00 108 0   P   1224          Proteobacteria 100.00 108 0   C   28211           Alphaproteobacteria 100.00  108 0   O   356           Rhizobiales 100.00    108 0   F   41294               Bradyrhizobiaceae 100.00    108 0   G   374               Bradyrhizobium 100.00 108 108 S   2057741                 Bradyrhizobium sp. SK17 </code></pre>
</section>
</section>
<section id="visualización-de-los-resultados-de-la-asignación-taxonómica" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="visualización-de-los-resultados-de-la-asignación-taxonómica"><span class="header-section-number">16.2</span> <strong>Visualización de los resultados de la asignación taxonómica</strong></h2>
<p>Tras asignar la taxonomía, a continuación se presenta una visualización de nuestros resultados. <a href="https://github.com/marbl/Krona/wiki">Krona</a> es un software de visualización de datos jerárquico. Krona permite explorar los datos con zoom y gráficos circulares multicapa, y es compatible con diversas herramientas bioinformáticas y formatos de datos sin procesar. Para usar Krona en nuestros resultados, primero accedamos a nuestro directorio de taxonomía, que contiene los resultados precalculados de Kraken.</p>
<section id="corona" class="level3" data-number="16.2.1">
<h3 data-number="16.2.1" class="anchored" data-anchor-id="corona"><span class="header-section-number">16.2.1</span> <strong>Corona</strong></h3>
<p>Con Krona, exploraremos la taxonomía del JP4D.001 MAG.</p>
<pre><code>$ cd ~/dc_workshop/taxonomy/mags_taxonomy </code></pre>
<p>Krona se llama con el <code>ktImportTaxonomy</code>comando que requiere un archivo de entrada y uno de salida.<br>
En nuestro caso, crearemos el archivo de entrada con las columnas tres y cuatro del <code>JP4D.001.kraken</code>archivo.</p>
<pre><code>$ cut -f2,3 JP4D.001.kraken &gt; JP4D.001.krona.input </code></pre>
<p>Ahora llamamos a Krona en nuestro <code>JP4D.001.krona.input</code>archivo y guardamos los resultados en formato <code>JP4D.001.krona.out.html</code>.</p>
<pre><code>$ ktImportTaxonomy JP4D.001.krona.input -o JP4D.001.krona.out.html </code></pre>
<pre><code>Loading taxonomy... Importing JP4D.001.krona.input...    [ WARNING ]  The following taxonomy IDs were not found in the local database and were set to root                 (if they were recently added to NCBI, use updateTaxonomy.sh to update the local                 database): 1804984 2109625 2259134 </code></pre>
<p>Y finalmente, abra otra terminal en su computadora local, descargue la salida de Krona y ábrala en un navegador.</p>
<pre><code>$ scp dcuser@ec2-3-235-238-92.compute-1.amazonaws.com:~/dc_workshop/taxonomy/JP4D.001.krona.out.html .  </code></pre>
<p>Verás una página como ésta:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/03-06-03.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="pavía" class="level3" data-number="16.2.2">
<h3 data-number="16.2.2" class="anchored" data-anchor-id="pavía"><span class="header-section-number">16.2.2</span> <strong>Pavía</strong></h3>
<p>Pavian es otra herramienta de visualización que permite comparar múltiples muestras. Pavian debe instalarse localmente y requiere R y Shiny, pero podemos probar el <a href="https://fbreitwieser.shinyapps.io/pavian/">sitio web de demostración de Pavian</a> para visualizar nuestros resultados.</p>
<p>Primero, necesitamos descargar los archivos necesarios como entrada en Pavian; en esta ocasión, visualizaremos la asignación de las lecturas de ambas muestras: <code>JC1A.report</code>y <code>JP4D.report</code>.<br>
Estos archivos corresponden a nuestros informes de Kraken. De nuevo en nuestra máquina local, usemos el <code>scp</code>comando.</p>
<pre><code>$ scp dcuser@ec2-3-235-238-92.compute-1.amazonaws.com:~/dc_workshop/taxonomy/*report .  </code></pre>
<p>Accedemos al <a href="https://fbreitwieser.shinyapps.io/pavian/">sitio web de demostración de Pavian</a> , hacemos clic en “Explorar” y seleccionamos nuestros informes. Debe seleccionar ambos informes a la vez.</p>
<p><img src="figures/asignaciontax1.png" class="img-fluid"></p>
<p><img src="figures/asignaciontax2.png" class="img-fluid"></p>
</section>
</section>
<section id="section" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="section"><span class="header-section-number">16.3</span> <img src="figures/asignaciontax3.png" class="img-fluid"></h2>
</section>
<section id="section-1" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="section-1"><span class="header-section-number">16.4</span> <img src="figures/asignaciontax5.png" class="img-fluid"></h2>
<section id="lecturas-no-clasificadas" class="level3" data-number="16.4.1">
<h3 data-number="16.4.1" class="anchored" data-anchor-id="lecturas-no-clasificadas"><span class="header-section-number">16.4.1</span> Lecturas no clasificadas</h3>
<p>Como puede ver, un porcentaje de nuestros datos no pudo asignarse a una OTU específica.<br>
¿Qué factores pueden afectar la asignación taxonómica para que una lectura no se clasifique?</p>
<p><strong>Las lecturas no clasificadas</strong>&nbsp;pueden ser el resultado de diferentes factores que pueden ir desde errores de secuenciación hasta problemas con el algoritmo que se utiliza para generar el resultado. Las plataformas de secuenciación de próxima generación (NGS) ampliamente utilizadas mostraron una&nbsp;<a href="https://www.nature.com/articles/s41598-018-29325-6">tasa de error promedio de 0,24 ± 0,06 % por base</a>&nbsp;. Además del error de secuenciación, debemos considerar el estado de la base de datos que se utiliza para realizar la asignación taxonómica.<br>
Todos los genomas caracterizados obtenidos por diferentes grupos de investigación se encuentran dispersos en diferentes repositorios, páginas y bancos en la nube. Algunos aún no se han publicado. Las bases de datos incompletas pueden afectar el rendimiento de la asignación taxonómica. Imagine que la OTU dominante en su muestra pertenece a un linaje que nunca se ha caracterizado y no tiene un genoma público disponible para ser utilizado como plantilla para la base de datos. Esta posibilidad hace que la asignación sea una tarea imposible y puede promover la generación de falsos positivos porque el algoritmo asignará una identidad diferente a todas esas lecturas.</p>
</section>
</section>
<section id="referencias" class="level2" data-number="16.5">
<h2 data-number="16.5" class="anchored" data-anchor-id="referencias"><span class="header-section-number">16.5</span> Referencias</h2>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./15Ensamblemetagenomico.html" class="pagination-link" aria-label="Binning metagenómico">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Binning metagenómico</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./17Asignaciontaxonomica.html" class="pagination-link" aria-label="Explorando la diversidad con librerías de R">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Explorando la diversidad con librerías de R</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>