<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>17&nbsp; Explorando la diversidad con librerías de R – Workshop</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./18Exploraciondetaxonomiaconr.html" rel="next">
<link href="./16Binningmetagenomico.html" rel="prev">
<link href="./rsgMexico.jpeg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b4769d4efdca78c57d6efa02c7377920.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-b8fe0e0e59d85b1c54ceb4dd9ede1a89.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12Iniciandomiproyectometagenomico.html"><strong>Sección 4</strong> - Procesamiento y visualización de datos metagenómicos</a></li><li class="breadcrumb-item"><a href="./17Asignaciontaxonomica.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Explorando la diversidad con librerías de R</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Workshop</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://iscb-rsg-mexico.github.io/Taller_Metagenomica/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-git"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Información general</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Sección 1</strong> - Organización de proyectos metagenómicos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1Ordendedatos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organización de proyectos metagenómicos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2Planificaciondeproyectos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Planificación de proyectos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3DatosdeNCBI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Examinando datos del NCBI</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Sección 2</strong> - Introducción a línea de comandos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4IntroduccionnavigationShell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introducción a Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5Operacionesyexploraciondefastq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Operaciones en archivos y carpetas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6Redireccion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Redirección</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7Buclesscriptsdescarga.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Bucles</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8Organizacionproyecto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Organización de proyectos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Sección 3</strong> - Primeros pasos con R Studio</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9IntroduccionRStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introducción a R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10Tiposdedatos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Estructuras de datos en R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11Graficandoconggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Creando gráficos con ggplot2</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Sección 4</strong> - Procesamiento y visualización de datos metagenómicos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12Iniciandomiproyectometagenomico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Iniciando mi proyecto metagenómico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13Controldecalidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Control de calidad</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14Filtraciondedatosdesecuenciacion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Filtración de datos de secuenciación</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15Ensamblemetagenomico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Binning metagenómico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16Binningmetagenomico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Asignación taxonómica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17Asignaciontaxonomica.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Explorando la diversidad con librerías de R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18Exploraciondetaxonomiaconr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Análisis de taxonomía con R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19Exploraciondediversidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Control de calidad</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20Analisistaxonomico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Control de calidad</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21Otrosrecursos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Control de calidad</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#primera-inmersión-en-la-diversidad" id="toc-primera-inmersión-en-la-diversidad" class="nav-link active" data-scroll-target="#primera-inmersión-en-la-diversidad"><span class="header-section-number">17.1</span> <strong>Primera inmersión en la diversidad</strong></a></li>
  <li><a href="#diversidad-α" id="toc-diversidad-α" class="nav-link" data-scroll-target="#diversidad-α"><span class="header-section-number">17.2</span> <strong>diversidad α</strong></a>
  <ul>
  <li><a href="#diversidad-β" id="toc-diversidad-β" class="nav-link" data-scroll-target="#diversidad-β"><span class="header-section-number">17.2.1</span> <strong>diversidad β</strong></a></li>
  </ul></li>
  <li><a href="#ejercicio-1-medida-simple-de-diversidades-alfa-y-beta." id="toc-ejercicio-1-medida-simple-de-diversidades-alfa-y-beta." class="nav-link" data-scroll-target="#ejercicio-1-medida-simple-de-diversidades-alfa-y-beta."><span class="header-section-number">17.3</span> <strong>Ejercicio 1: Medida simple de diversidades alfa y beta.</strong></a></li>
  <li><a href="#solución" id="toc-solución" class="nav-link" data-scroll-target="#solución"><span class="header-section-number">17.4</span> <strong>Solución</strong></a></li>
  <li><a href="#diversidad-alfa-de-la-gráfica" id="toc-diversidad-alfa-de-la-gráfica" class="nav-link" data-scroll-target="#diversidad-alfa-de-la-gráfica"><span class="header-section-number">17.5</span> <strong>Diversidad alfa de la gráfica</strong></a></li>
  <li><a href="#abundancias-absolutas-y-relativas" id="toc-abundancias-absolutas-y-relativas" class="nav-link" data-scroll-target="#abundancias-absolutas-y-relativas"><span class="header-section-number">17.6</span> <strong>Abundancias absolutas y relativas</strong></a></li>
  <li><a href="#diversidad-beta" id="toc-diversidad-beta" class="nav-link" data-scroll-target="#diversidad-beta"><span class="header-section-number">17.7</span> <strong>Diversidad beta</strong></a></li>
  <li><a href="#ejercicio-3-agregar-metadatos-a-la-visualización-de-la-diversidad-beta" id="toc-ejercicio-3-agregar-metadatos-a-la-visualización-de-la-diversidad-beta" class="nav-link" data-scroll-target="#ejercicio-3-agregar-metadatos-a-la-visualización-de-la-diversidad-beta"><span class="header-section-number">17.8</span> <strong>Ejercicio 3: Agregar metadatos a la visualización de la diversidad beta</strong></a></li>
  <li><a href="#discusión-índices-de-diversidad" id="toc-discusión-índices-de-diversidad" class="nav-link" data-scroll-target="#discusión-índices-de-diversidad"><span class="header-section-number">17.9</span> <strong>Discusión: Índices de diversidad</strong></a></li>
  <li><a href="#referencias" id="toc-referencias" class="nav-link" data-scroll-target="#referencias"><span class="header-section-number">17.11</span> Referencias</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12Iniciandomiproyectometagenomico.html"><strong>Sección 4</strong> - Procesamiento y visualización de datos metagenómicos</a></li><li class="breadcrumb-item"><a href="./17Asignaciontaxonomica.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Explorando la diversidad con librerías de R</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Explorando la diversidad con librerías de R</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="primera-inmersión-en-la-diversidad" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="primera-inmersión-en-la-diversidad"><span class="header-section-number">17.1</span> <strong>Primera inmersión en la diversidad</strong></h2>
<p>La diversidad de especies, en su definición más simple, es el número de especies en un área determinada y su abundancia relativa (uniformidad). Una vez que conocemos la composición taxonómica de nuestros metagenomas, podemos realizar análisis de diversidad. Aquí analizaremos las dos métricas de diversidad más utilizadas: la diversidad α (dentro de un metagenoma) y la diversidad β (entre metagenomas).</p>
<ul>
<li>Diversidad α: Puede representarse únicamente como riqueza ( <em>es decir,</em> el número de especies diferentes en un entorno), o también puede medirse considerando la abundancia de las especies en el entorno ( <em>es decir,</em> el número de individuos de cada especie en el entorno). Para medir la diversidad α, utilizamos índices como el de Shannon, el de Simpson, el de Chao1, etc.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/diversidad1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<ul>
<li>La diversidad β es la diferencia (medida como distancia) entre dos o más entornos. Puede medirse con métricas como la disimilitud de Bray-Curtis, la distancia de Jaccard o la distancia Unifrac, por nombrar algunas. Cada una de estas medidas se centra en una característica de la comunidad ( <em>p.&nbsp;ej.,</em> la distancia Unifrac mide la relación filogenética entre las especies de la comunidad).</li>
</ul>
<p>En el siguiente ejemplo, analizaremos los componentes α y β de la diversidad de un conjunto de datos de peces en tres lagos. La forma más sencilla de calcular la diversidad β es calcular las especies distintas entre dos lagos (sitios). Tomemos como ejemplo la diversidad entre el lago A y el lago B. El número de especies en el lago A es 3. A esta cantidad, restaremos el número de estas especies que se comparten con el lago B: 2. Por lo tanto, el número de especies únicas en el lago A en comparación con el lago B es (3-2) = 1. A este número, sumaremos el resultado de las mismas operaciones, pero ahora tomaremos el lago B como nuestro sitio de referencia. Al final, la diversidad β entre el lago A y el lago B es (3-2) + (3-2) = 2. Este proceso puede repetirse, tomando cada par de lagos como los sitios de enfoque.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/diversidad2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="diversidad-α" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="diversidad-α"><span class="header-section-number">17.2</span> <strong>diversidad α</strong></h2>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Índices de diversidad</th>
<th style="text-align: left;">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Shannon (H)</td>
<td style="text-align: left;">Estimación de la riqueza y la uniformidad de especies. Mayor importancia para la riqueza.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Simpson (D)</td>
<td style="text-align: left;">Estimación de la riqueza y la uniformidad de especies. Mayor importancia para la uniformidad.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Caos1</td>
<td style="text-align: left;">Abundancia basada en especies representadas por un solo individuo (singletons) y dos individuos (doubletons).</td>
</tr>
</tbody>
</table>
<ul>
<li>Shannon (H):</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Variable</th>
<th style="text-align: center;">Definición</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">H= −∑Syo = 1pagienpagiH=−∑i=1Spagien⁡pagi</td>
<td style="text-align: center;">Definición</td>
</tr>
<tr class="even">
<td style="text-align: center;">SS</td>
<td style="text-align: center;">Número de OTU</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pagipagi</td>
<td style="text-align: center;">La proporción de la comunidad representada por OTU i</td>
</tr>
</tbody>
</table>
<ul>
<li>Simpson (D)</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Variable</th>
<th style="text-align: center;">Definición</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">D =1∑Syo = 1pag2iD=1∑i=1Spagi2</td>
<td style="text-align: center;">Definición</td>
</tr>
<tr class="even">
<td style="text-align: center;">SS</td>
<td style="text-align: center;">Número total de especies en la comunidad</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pagipagi</td>
<td style="text-align: center;">Proporción de la comunidad representada por OTU i</td>
</tr>
</tbody>
</table>
<ul>
<li>Caos1</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Variable</th>
<th style="text-align: center;">Definición</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Sc h a o 1=SObs​​+F1× (F1− 1 )2 × (F2+ 1 )Sdohao1=SOhbs+F1×(F1−1)2×(F2+1)</td>
<td style="text-align: center;">Recuento de singletons y doubletons respectivamente</td>
</tr>
<tr class="even">
<td style="text-align: center;">F1,F2F1,F2</td>
<td style="text-align: center;">Recuento de singletons y doubletons respectivamente</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Sc h a o 1=SObs​​Sdohao1=SOhbs</td>
<td style="text-align: center;">El número de especies observadas</td>
</tr>
</tbody>
</table>
<section id="diversidad-β" class="level3" data-number="17.2.1">
<h3 data-number="17.2.1" class="anchored" data-anchor-id="diversidad-β"><span class="header-section-number">17.2.1</span> <strong>diversidad β</strong></h3>
<p>La diversidad β mide qué tan diferentes son dos o más comunidades, ya sea en su composición (riqueza) o en la abundancia de los organismos que la componen (abundancia).</p>
<ul>
<li><p>Disimilitud de Bray-Curtis: Diferencia en riqueza y abundancia entre entornos (muestras). Ponderación de la abundancia. Mide las diferencias de 0 (comunidades iguales) a 1 (comunidades diferentes).</p></li>
<li><p>Distancia de Jaccard: Se basa en la presencia o ausencia de especies (diversidad). Va de 0 (misma especie en la comunidad) a 1 (ninguna especie en común).</p></li>
<li><p>UniFrac: Mide la distancia filogenética; la similitud entre los árboles de cada comunidad. Existen dos tipos: sin ponderaciones (diversidad) y con ponderaciones (diversidad y abundancia).</p></li>
</ul>
</section>
</section>
<section id="ejercicio-1-medida-simple-de-diversidades-alfa-y-beta." class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="ejercicio-1-medida-simple-de-diversidades-alfa-y-beta."><span class="header-section-number">17.3</span> <strong>Ejercicio 1: Medida simple de diversidades alfa y beta.</strong></h2>
<p>En la siguiente imagen se muestran dos lagos con diferentes especies de peces: <em>Figura 3.</em><a href="https://carpentries-lab.github.io/metagenomics-analysis/fig/03-08-03.png"><img src="https://carpentries-lab.github.io/metagenomics-analysis/fig/03-08-03.png" class="img-fluid" alt="En el lago A, tenemos cuatro especies diferentes, dos de las cuales tienen tres ejemplares cada una. Este lago también tiene dos ejemplares de una tercera especie y solo uno de una cuarta. En total, encontramos nueve peces. El lago B tiene solo tres especies diferentes; la especie más abundante también está presente en el lago A y tiene cinco ejemplares, y solo tenemos un ejemplar de cada una de las otras dos especies. En total, encontramos siete especies en el lago B."></a></p>
<p>¿Cuál de las siguientes opciones es verdadera para la diversidad alfa en los lagos A y B, y la diversidad beta entre los lagos A y B, respectivamente?</p>
<ol type="1">
<li><p>4, 3, 1</p></li>
<li><p>4, 3, 5</p></li>
<li><p>9, 7, 16</p></li>
</ol>
<p>Por favor, pegue su resultado en el documento colaborativo proporcionado por los instructores. <em>¡</em> Aquí <em>hay leones</em> !</p>
</section>
<section id="solución" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="solución"><span class="header-section-number">17.4</span> <strong>Solución</strong></h2>
<p>Respuesta: 2. 4, 3, 5. <strong>La diversidad alfa</strong> , en este caso, es la suma de las especies. El lago <strong>A</strong> tiene <strong>4</strong> especies y el lago <strong>B 3. La diversidad beta</strong> se refiere a la diferencia entre el lago A y el lago B. Si usamos la fórmula de <em>la Figura 2,</em> vemos que para calcular la diversidad beta, debemos detectar el número de especies y el número de especies compartidas en ambos lagos. Solo hay una especie compartida, así que debemos restar el número de especies compartidas al total de especies y sumar el resultado. En este caso, en el lago A, tenemos 4 especies y una especie compartida, siendo el lago B (4-1)=3, y en el lago B tenemos tres especies y una especie compartida, siendo el lago A (3-1)=2. Si sumamos 3+2, el resultado es 5.</p>
</section>
<section id="diversidad-alfa-de-la-gráfica" class="level2" data-number="17.5">
<h2 data-number="17.5" class="anchored" data-anchor-id="diversidad-alfa-de-la-gráfica"><span class="header-section-number">17.5</span> <strong>Diversidad alfa de la gráfica</strong></h2>
<p>Queremos conocer la diversidad bacteriana, así que eliminaremos todos los organismos no bacterianos de nuestro <code>merged_metagenomes</code>objeto Phyloseq. Para ello, crearemos un subconjunto de todos los grupos bacterianos y lo guardaremos.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> merged_metagenomes <span class="ot">&lt;-</span> <span class="fu">subset_taxa</span>(merged_metagenomes, Kingdom <span class="sc">==</span> <span class="st">"Bacteria"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Ahora veamos algunas estadísticas de nuestros metagenomas. La salida del <code>sample_sums()</code>comando muestra cuántas lecturas hay en la biblioteca. La biblioteca JC1A es la más pequeña, con 18412 lecturas, mientras que la biblioteca JP4D es la más grande, con 149590 lecturas.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> merged_metagenomes </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>phyloseq<span class="sc">-</span>class experiment<span class="sc">-</span>level object <span class="fu">otu_table</span>()   OTU Table<span class="sc">:</span>         [ <span class="dv">4024</span> taxa and <span class="dv">3</span> samples ] <span class="fu">tax_table</span>()   Taxonomy Table<span class="sc">:</span>    [ <span class="dv">4024</span> taxa by <span class="dv">7</span> taxonomic ranks ] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">sample_sums</span>(merged_metagenomes) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>  JC1A   JP4D   JP41   <span class="dv">18412</span> <span class="dv">149590</span>  <span class="dv">76589</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Además, los valores máximo, mínimo y medio de la salida <code>summary()</code>nos dan una idea de la uniformidad. Por ejemplo, la OTU que aparece más veces en la muestra JC1A aparece 399 veces, y en promedio, en la muestra JP4D, una OTU aparece en 37,17 lecturas.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(merged_metagenomes<span class="sc">@</span>otu_table<span class="sc">@</span>.Data) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>      JC1A              JP4D              JP41          Min.   <span class="sc">:</span>  <span class="fl">0.000</span>   Min.   <span class="sc">:</span>   <span class="fl">0.00</span>   Min.   <span class="sc">:</span>   <span class="fl">0.00</span>    <span class="dv">1</span>st Qu.<span class="sc">:</span>  <span class="fl">0.000</span>   <span class="dv">1</span>st Qu.<span class="sc">:</span>   <span class="fl">3.00</span>   <span class="dv">1</span>st Qu.<span class="sc">:</span>   <span class="fl">1.00</span>    Median <span class="sc">:</span>  <span class="fl">0.000</span>   Median <span class="sc">:</span>   <span class="fl">7.00</span>   Median <span class="sc">:</span>   <span class="fl">5.00</span>    Mean   <span class="sc">:</span>  <span class="fl">4.575</span>   Mean   <span class="sc">:</span>  <span class="fl">37.17</span>   Mean   <span class="sc">:</span>  <span class="fl">19.03</span>    <span class="dv">3</span>rd Qu.<span class="sc">:</span>  <span class="fl">2.000</span>   <span class="dv">3</span>rd Qu.<span class="sc">:</span>  <span class="fl">21.00</span>   <span class="dv">3</span>rd Qu.<span class="sc">:</span>  <span class="fl">14.00</span>    Max.   <span class="sc">:</span><span class="fl">399.000</span>   Max.   <span class="sc">:</span><span class="fl">6551.00</span>   Max.   <span class="sc">:</span><span class="fl">1994.00</span>   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Para tener una representación más visual de la diversidad dentro de las muestras (es decir, diversidad α), ahora podemos mirar un gráfico creado usando Phyloseq:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot_richness</span>(<span class="at">physeq =</span> merged_metagenomes,                <span class="at">measures =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>,<span class="st">"Chao1"</span>,<span class="st">"Shannon"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/diversidad3.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Cada una de estas métricas puede ofrecer una perspectiva de la distribución de las OTU en nuestras muestras. Por ejemplo, el índice de diversidad Chao1 otorga mayor peso a los singletons y doubletons observados en nuestras muestras, mientras que Shannon es un índice de entropía que señala la imposibilidad de extraer dos lecturas del metagenoma y que estas pertenecerán a la misma OTU.</p>
<p>Una precaución al comparar muestras es que las diferencias en algunos índices alfa pueden deberse a la diferencia en el número total de lecturas de las muestras. Una muestra con más lecturas tiene mayor probabilidad de tener más OTU diferentes, por lo que se requiere cierta normalización. En este caso, trabajaremos con abundancias relativas, pero otros enfoques podrían ayudar a reducir este sesgo.</p>
</section>
<section id="abundancias-absolutas-y-relativas" class="level2" data-number="17.6">
<h2 data-number="17.6" class="anchored" data-anchor-id="abundancias-absolutas-y-relativas"><span class="header-section-number">17.6</span> <strong>Abundancias absolutas y relativas</strong></h2>
<p>A partir de los recuentos de lecturas que acabamos de ver, es evidente que existe una gran diferencia en el número total de lecturas secuenciadas en cada muestra. Antes de continuar con el procesamiento de los datos, verifique si hay lecturas no identificadas. Marcadas como “en blanco” (es decir, ““) en los diferentes niveles taxonómicos:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(merged_metagenomes<span class="sc">@</span>tax_table<span class="sc">@</span>.Data<span class="sc">==</span> <span class="st">""</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>  Kingdom          Phylum          Class           Order           Family          Genus          Species         Mode <span class="sc">:</span>logical   Mode <span class="sc">:</span>logical   Mode <span class="sc">:</span>logical   Mode <span class="sc">:</span>logical   Mode <span class="sc">:</span>logical   Mode <span class="sc">:</span>logical   Mode <span class="sc">:</span>logical    <span class="cn">FALSE</span><span class="sc">:</span><span class="dv">4024</span>      <span class="cn">FALSE</span><span class="sc">:</span><span class="dv">4024</span>      <span class="cn">FALSE</span><span class="sc">:</span><span class="dv">3886</span>      <span class="cn">FALSE</span><span class="sc">:</span><span class="dv">4015</span>      <span class="cn">FALSE</span><span class="sc">:</span><span class="dv">3967</span>      <span class="cn">FALSE</span><span class="sc">:</span><span class="dv">3866</span>      <span class="cn">FALSE</span><span class="sc">:</span><span class="dv">3540</span>                                       <span class="cn">TRUE</span> <span class="sc">:</span><span class="dv">138</span>       <span class="cn">TRUE</span> <span class="sc">:</span><span class="dv">9</span>         <span class="cn">TRUE</span> <span class="sc">:</span><span class="dv">57</span>        <span class="cn">TRUE</span> <span class="sc">:</span><span class="dv">158</span>       <span class="cn">TRUE</span> <span class="sc">:</span><span class="dv">484</span>       </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Con el comando anterior, podemos ver espacios en blanco en diferentes niveles taxonómicos. Por ejemplo, tenemos 158 espacios en blanco a nivel de género. Aunque podríamos esperar ver algunos espacios en blanco a nivel de especie o incluso de género, eliminaremos los de género para continuar con el análisis.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> merged_metagenomes <span class="ot">&lt;-</span> <span class="fu">subset_taxa</span>(merged_metagenomes, Genus <span class="sc">!=</span> <span class="st">""</span>) <span class="co">#Only genus that are no blank &gt; summary(merged_metagenomes@tax_table@.Data== "") </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>  Kingdom          Phylum          Class           Order           Family          Genus          Species         Mode <span class="sc">:</span>logical   Mode <span class="sc">:</span>logical   Mode <span class="sc">:</span>logical   Mode <span class="sc">:</span>logical   Mode <span class="sc">:</span>logical   Mode <span class="sc">:</span>logical   Mode <span class="sc">:</span>logical    <span class="cn">FALSE</span><span class="sc">:</span><span class="dv">3866</span>      <span class="cn">FALSE</span><span class="sc">:</span><span class="dv">3866</span>      <span class="cn">FALSE</span><span class="sc">:</span><span class="dv">3739</span>      <span class="cn">FALSE</span><span class="sc">:</span><span class="dv">3860</span>      <span class="cn">FALSE</span><span class="sc">:</span><span class="dv">3858</span>      <span class="cn">FALSE</span><span class="sc">:</span><span class="dv">3866</span>      <span class="cn">FALSE</span><span class="sc">:</span><span class="dv">3527</span>                                       <span class="cn">TRUE</span> <span class="sc">:</span><span class="dv">127</span>       <span class="cn">TRUE</span> <span class="sc">:</span><span class="dv">6</span>         <span class="cn">TRUE</span> <span class="sc">:</span><span class="dv">8</span>                         <span class="cn">TRUE</span> <span class="sc">:</span><span class="dv">339</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A continuación, dado que nuestros metagenomas tienen diferentes tamaños, es imperativo convertir el número de lecturas asignadas (es decir, abundancia absoluta) en porcentajes (es decir, abundancias relativas) para compararlas.</p>
<p>En este momento nuestra tabla OTU se ve así:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">head</span>(merged_metagenomes<span class="sc">@</span>otu_table<span class="sc">@</span>.Data) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>        JC1A JP4D JP41 <span class="dv">1060</span>      <span class="dv">32</span>  <span class="dv">420</span>   <span class="dv">84</span> <span class="dv">1063</span>     <span class="dv">316</span> <span class="dv">5733</span> <span class="dv">1212</span> <span class="dv">2033869</span>  <span class="dv">135</span> <span class="dv">1232</span>  <span class="dv">146</span> <span class="dv">1850250</span>  <span class="dv">114</span>  <span class="dv">846</span>  <span class="dv">538</span> <span class="dv">1061</span>      <span class="dv">42</span> <span class="dv">1004</span>  <span class="dv">355</span> <span class="dv">265</span>       <span class="dv">42</span>  <span class="dv">975</span>  <span class="dv">205</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Para realizar esta transformación a porcentajes, aprovecharemos una función de Phyloseq.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> percentages <span class="ot">&lt;-</span> <span class="fu">transform_sample_counts</span>(merged_metagenomes, <span class="cf">function</span>(x) x<span class="sc">*</span><span class="dv">100</span> <span class="sc">/</span> <span class="fu">sum</span>(x) ) <span class="sc">&gt;</span> <span class="fu">head</span>(percentages<span class="sc">@</span>otu_table<span class="sc">@</span>.Data) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>             JC1A      JP4D      JP41 <span class="dv">1060</span>    <span class="fl">0.1877383</span> <span class="fl">0.3065134</span> <span class="fl">0.1179709</span> <span class="dv">1063</span>    <span class="fl">1.8539161</span> <span class="fl">4.1839080</span> <span class="fl">1.7021516</span> <span class="dv">2033869</span> <span class="fl">0.7920211</span> <span class="fl">0.8991060</span> <span class="fl">0.2050447</span> <span class="dv">1850250</span> <span class="fl">0.6688178</span> <span class="fl">0.6174056</span> <span class="fl">0.7555755</span> <span class="dv">1061</span>    <span class="fl">0.2464066</span> <span class="fl">0.7327130</span> <span class="fl">0.4985675</span> <span class="dv">265</span>     <span class="fl">0.2464066</span> <span class="fl">0.7115490</span> <span class="fl">0.2879052</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Ahora, estamos listos para comparar las abundancias dadas por porcentajes de las muestras con índices de diversidad beta.</p>
</section>
<section id="diversidad-beta" class="level2" data-number="17.7">
<h2 data-number="17.7" class="anchored" data-anchor-id="diversidad-beta"><span class="header-section-number">17.7</span> <strong>Diversidad beta</strong></h2>
<p>Como mencionamos anteriormente, la diversidad beta mide la similitud o diferencia entre nuestras muestras (superposición entre conjuntos de especies o unidades taxonómicas operativas definidas discretamente). Para medir esto, necesitamos calcular un índice que se ajuste a los objetivos de nuestra investigación. Con el siguiente código, podemos mostrar todas las posibles métricas de distancia que Phyloseq puede utilizar:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> distanceMethodList </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>UniFrac [<span class="dv">1</span>] <span class="st">"unifrac"</span>  <span class="st">"wunifrac"</span>  <span class="sc">$</span>DPCoA [<span class="dv">1</span>] <span class="st">"dpcoa"</span>  <span class="sc">$</span>JSD [<span class="dv">1</span>] <span class="st">"jsd"</span>  <span class="sc">$</span>vegdist  [<span class="dv">1</span>] <span class="st">"manhattan"</span>  <span class="st">"euclidean"</span>  <span class="st">"canberra"</span>   <span class="st">"bray"</span>       <span class="st">"kulczynski"</span> <span class="st">"jaccard"</span>    <span class="st">"gower"</span>       [<span class="dv">8</span>] <span class="st">"altGower"</span>   <span class="st">"morisita"</span>   <span class="st">"horn"</span>       <span class="st">"mountford"</span>  <span class="st">"raup"</span>       <span class="st">"binomial"</span>   <span class="st">"chao"</span>       [<span class="dv">15</span>] <span class="st">"cao"</span>         <span class="sc">$</span>betadiver  [<span class="dv">1</span>] <span class="st">"w"</span>   <span class="st">"-1"</span>  <span class="st">"c"</span>   <span class="st">"wb"</span>  <span class="st">"r"</span>   <span class="st">"I"</span>   <span class="st">"e"</span>   <span class="st">"t"</span>   <span class="st">"me"</span>  <span class="st">"j"</span>   <span class="st">"sor"</span> <span class="st">"m"</span>   <span class="st">"-2"</span>  <span class="st">"co"</span>  <span class="st">"cc"</span>  <span class="st">"g"</span>   [<span class="dv">17</span>] <span class="st">"-3"</span>  <span class="st">"l"</span>   <span class="st">"19"</span>  <span class="st">"hk"</span>  <span class="st">"rlb"</span> <span class="st">"sim"</span> <span class="st">"gl"</span>  <span class="st">"z"</span>    <span class="sc">$</span>dist [<span class="dv">1</span>] <span class="st">"maximum"</span>   <span class="st">"binary"</span>    <span class="st">"minkowski"</span>  <span class="sc">$</span>designdist [<span class="dv">1</span>] <span class="st">"ANY"</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Describir todas estas posibles métricas de distancia está más allá del alcance de esta lección, pero aquí mostramos cuáles son las que necesitan una relación filogenética entre las especies-OTU presentes en nuestras muestras:</p>
<ul>
<li><p>Unifrac</p></li>
<li><p>Peso-Unifrac</p></li>
<li><p>DPCoA</p></li>
</ul>
<p>No disponemos de un árbol filogenético ni de relaciones filogenéticas. Por lo tanto, no podemos usar ninguno de estos tres. Usaremos <a href="http://www.pelagicos.net/MARS6300/readings/Bray_&amp;_Curtis_1957.pdf">Bray-Curtis,</a> ya que es una de las métricas de distancia más robustas y utilizadas para calcular la diversidad beta.</p>
<p><strong>¡Sigamos así!</strong> Ya tenemos todo lo necesario para comenzar el análisis de diversidad beta. Usaremos el comando Phyloseq <code>ordinate</code>para generar un nuevo objeto donde se asignarán las distancias entre nuestras muestras después de calcularlas. Para este comando, debemos especificar el método que usaremos para generar una matriz. En este ejemplo, usaremos el Escalamiento Multidimensional No Métrico o <a href="https://academic.oup.com/bioinformatics/article/21/6/730/199398">NMDS</a> . NMDS intenta representar la disimilitud entre objetos en un espacio de baja dimensión; en este caso, un gráfico bidimensional.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> meta_ord <span class="ot">&lt;-</span> <span class="fu">ordinate</span>(<span class="at">physeq =</span> percentages, <span class="at">method =</span> <span class="st">"NMDS"</span>,                       <span class="at">distance =</span> <span class="st">"bray"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Si recibe algún mensaje de advertencia después de ejecutar este script, no se preocupe. Esto se debe a que solo tenemos tres muestras. Con pocas muestras, el algoritmo advierte sobre la poca dificultad para generar la matriz de distancias.</p>
<p>Por ahora, solo necesitamos el comando <code>plot_ordination()</code>para ver los resultados de nuestro análisis de diversidad beta:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot_ordination</span>(<span class="at">physeq =</span> percentages, <span class="at">ordination =</span> meta_ord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/diversidad4.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>En este gráfico NMDS, cada punto representa la abundancia combinada de todas sus OTU. Como se muestra, cada muestra ocupa espacio en el gráfico sin formar grupos. Este resultado se debe a que cada muestra es lo suficientemente diferente como para considerarse un punto independiente en el espacio NMDS.</p>
</section>
<section id="ejercicio-3-agregar-metadatos-a-la-visualización-de-la-diversidad-beta" class="level2" data-number="17.8">
<h2 data-number="17.8" class="anchored" data-anchor-id="ejercicio-3-agregar-metadatos-a-la-visualización-de-la-diversidad-beta"><span class="header-section-number">17.8</span> <strong>Ejercicio 3: Agregar metadatos a la visualización de la diversidad beta</strong></h2>
<p>En la siguiente figura, el gráfico de diversidad beta que generamos anteriormente se ha enriquecido. Observe el código a continuación y responda:<br>
1) ¿Qué instrucción coloreó las muestras según su tratamiento correspondiente?<br>
2) ¿Qué hizo la instrucción <code>geom_text</code>?<br>
3) ¿Qué otra diferencia observa con nuestro gráfico anterior?<br>
4) ¿Observa alguna agrupación de las muestras según su tratamiento?</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/diversidad5.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>metadata_cuatroc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample=</span><span class="fu">c</span>(<span class="st">"JC1A"</span>, <span class="st">"JP4D"</span>, <span class="st">"JP41"</span>), <span class="at">Treatment=</span><span class="fu">c</span>(<span class="st">"Control mesocosm"</span>, <span class="st">"Fertilized pond"</span>, <span class="st">"Unenriched pond"</span>)) <span class="co"># Making dataframe with metadata   rownames(metadata_cuatroc) &lt;- metadata_cuatroc$Sample # Using sample names as row names   percentages@sam_data &lt;- sample_data(metadata_cuatroc) # Adding metadata to sam_data table of phyloseq object percentages   meta_ord &lt;- ordinate(physeq = percentages, method = "NMDS", distance = "bray") # Calculating beta diversity     plot_ordination(physeq = percentages, ordination = meta_ord, color = "Treatment") + # Plotting beta diversity.       geom_text(mapping = aes(label = Sample), size = 3, vjust = 1.5)   </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="discusión-índices-de-diversidad" class="level2" data-number="17.9">
<h2 data-number="17.9" class="anchored" data-anchor-id="discusión-índices-de-diversidad"><span class="header-section-number">17.9</span> <strong>Discusión: Índices de diversidad</strong></h2>
<p>¿Por qué cree que necesitamos diferentes índices para evaluar la diversidad? ¿Qué índice utilizará para evaluar el impacto de los taxones raros y poco abundantes?</p>
<blockquote class="blockquote">
<h2 id="solución-1" data-number="17.10" class="anchored"><span class="header-section-number">17.10</span> <strong>Solución</strong></h2>
<p>Será difícil (si no imposible) tomar dos comunidades y observar la misma distribución de todos los miembros. Este resultado se debe a que hay muchos <strong>factores</strong> que afectan a estos linajes. Algunos de los <strong>factores ambientales</strong> son la temperatura, el pH y la concentración de nutrientes. Además, las interacciones de estas poblaciones, como la competencia, la inhibición de otras poblaciones y la velocidad de crecimiento, son un importante impulsor de la variación ( <strong>factor biótico</strong> ). Una combinación de los <strong>factores mencionados anteriormente</strong> puede interactuar para mantener algunas poblaciones con baja abundancia ( <strong>taxones raros).</strong> Para tener formas de evaluar hipótesis sobre cuáles de estos procesos pueden estar afectando a la comunidad, utilizamos todos estos diferentes índices. Algunos enfatizan el número de especies y otros la uniformidad de las OTU. Para evaluar el impacto de los linajes de baja abundancia, un índice de diversidad alfa ampliamente utilizado es el índice Chao1.</p>
</blockquote>
</section>
<section id="referencias" class="level2" data-number="17.11">
<h2 data-number="17.11" class="anchored" data-anchor-id="referencias"><span class="header-section-number">17.11</span> Referencias</h2>
<p><a href="https://ciespinosa.github.io/AlphaDiversidad/medidas-de-diversidad.html">Índices de diversidad</a></p>
<p><a href="https://geographyfieldwork.com/Simpson'sDiversityIndex.htm">Índice de diversidad de Simpson</a></p>
<p><a href="https://www.cd-genomics.com/microbioseq/the-use-and-types-of-alpha-diversity-metrics-in-microbial-ngs.html">Types of alpha diversity metrics in microbial NGS</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./16Binningmetagenomico.html" class="pagination-link" aria-label="Asignación taxonómica">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Asignación taxonómica</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./18Exploraciondetaxonomiaconr.html" class="pagination-link" aria-label="Análisis de taxonomía con R">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Análisis de taxonomía con R</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>