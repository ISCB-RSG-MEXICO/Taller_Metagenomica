[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Workshop",
    "section": "",
    "text": "Informaci√≥n general\n\n\nSobre el curso üìåRequisitos previosAgenda üìÜ\n\n\nEl contenido de este curso se realiz√≥ en base al material realizado por The Carpentries-lab.\n\nFechas: 22 y 23 de Mayo del 2025\nDuraci√≥n del curso: 12 horas\nHorario: 9 am a 4 pm\n\nInstructores:\n\nAaron Espinosa Jaime - UGA, Cinvestav Irapuato.\nJos√© Yahir Cabrera Gonz√°lez - Instituto de Biociencias, UNACH Tapachula.\nTania Vanessa Arellano Fern√°ndez - UGA, Cinvestav Irapuato\n\nAyudantes:\n\nMariana Devon - Estudiante de maestr√≠a, UAM.\nAndr√©s Arredondo - Ciencias Agrogen√≥micas, CCM-UNAM.\nCesar Ayala\nDaniel Ch√°vez, Universidad Aut√≥noma de Guerrero\nJohanna Castel√°n, Universidad Popular Aut√≥noma del Estado de Puebla\nJos√© Ovando\n\nResumen:\nEste taller tiene como objetivo principal abordar los conceptos b√°sicos, habilidades y herramientas para trabajar con datos metagen√≥micos. Este taller comprende varias lecciones que incluyen desde la organizaci√≥n y buenas pr√°cticas, introducci√≥n a la l√≠nea de comandos y su aplicaci√≥n para an√°lisis de calidad y por √∫ltimo el uso de R studio para comparar diversidad entre las muestras de estudio.\nObjetivos:\nEn este taller aprender√°s a:\n\nOrganizar y colectar metadatos para tu proyecto metagen√≥mico.\nAcceder a bases de datos p√∫blicos.\nTrabajar y vincularte a servidores remotos.\nNavegar en el contenido de tus carpetas desde la terminal de Shell.\nModificar, crear y mover archivos desde la terminal.\nUtilizar y familiarizarte con la interfaz de R studio.\nDescargar y emplear librer√≠as de R.\nAnalizar datos metagen√≥micos crudos.\nInterpretar tus resultados.\n\nCitar y reutilizar el material del curso\nLos datos del curso se pueden reutilizar y adaptar libremente con la debida atribuci√≥n. Todos los datos de los cursos de estos repositorios est√°n sujetos a la licencia Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0).\n\n\n\nDebes contar con una computadora o laptop con acceso a internet. No se recomienda el uso de tablets para este taller.\nNo es necesario que sepas utilizar la terminal o R studio. Sin embargo, es necesario que tengas los conocimientos b√°sicos de microbiolog√≠a y conceptos de biolog√≠a.\nNo es necesario descargar R studio y/o emuladores de terminal de Unix para este taller.\n\n\n\n\n\n\n\n\n\n\nTema\nTiempo\n\n\n\n\nüî∑ D√≠a 1 - 22 Mayo\n\n\n\nüî∑ Organizaci√≥n de proyectos\n9:00-10:30\n\n\n\nOrganizaci√≥n de datos\n\n20 min\n\n\n\nPlaneaci√≥n de proyectos NGS\n\n20 min\n\n\n\nExaminaci√≥n de datos (NCBI SRA)\n\n15 min\n\n\nüî∑¬† Introducci√≥n a l√≠nea de comandos |10:00-12:40\n\n\n\n\nIntroduccion a Shell\n\n30 min\n\n\n‚òï Coffee break (10:30-11:00) ‚òï | 30 min |\n\n\n\n\nOperaciones en archivos y carpetas\n\n20 min\n\n\n-¬† Redirecci√≥n\n30 min\n\n\n\nBucles y edici√≥n de archivos\n\n30 min\n\n\n\nOrganizaci√≥n de datos en terminal\n\n20 min\n\n\nüî∑ Introducci√≥n a R |12:40-14:30\n\n\n\n\nPrimeros pasos en R\n\n20 min\n\n\n‚òï Comida (13:00-14:00) ‚òï |60 min|\n\n\n\n\nTipos de datos en R\n\n15 min\n\n\n\nCreando gr√°ficos con ggplot2\n\n15 min\n\n\n\nTipos de datos en R\n\n15 min\n\n\nüî∑Procesamiento de datos metagen√≥micos\n15 min\n\n\n\nComenzando mi proyecto metagen√≥mico\n\n15 min\n\n\nüî∑ D√≠a 2 - 23 Mayo\n\n\n\nüî∑Procesamiento de datos metagen√≥micos\n9:00-10:30\n\n\n\nControl de calidad\n\n35 min\n\n\n\nCorte y filtrado de secuencias\n\n20 min\n\n\n‚òï Coffee break (10:30-11:00) ‚òï | 30 min |\n\n\n\n\nEnsamblaje metagen√≥mico\n\n40 min\n\n\n\nBinning metagen√≥mico\n\n40 min\n\n\n\nAsignaci√≥n de taxonom√≠a\n\n30 min\n\n\n\nExploraci√≥n de asignaci√≥n taxon√≥mica\n\n25 min\n\n\n‚òï Comida (13:00-14:00) ‚òï | 60 min |\n\n\n\n\nUso de R para an√°lisis de diversidad\n\n30 min\n\n\n\nAn√°lisis de taxonom√≠a con R\n\n30 min\n\n\n\nRecursos extra\n\n15 min",
    "crumbs": [
      "Informaci√≥n general"
    ]
  },
  {
    "objectID": "1Ordendedatos.html",
    "href": "1Ordendedatos.html",
    "title": "1¬† Organizaci√≥n de proyectos metagen√≥micos",
    "section": "",
    "text": "1.0.1 En esta lecci√≥n aprender√°s:",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Organizaci√≥n de proyectos metagen√≥micos</span>"
    ]
  },
  {
    "objectID": "1Ordendedatos.html#importancia-del-orden-en-experimentos",
    "href": "1Ordendedatos.html#importancia-del-orden-en-experimentos",
    "title": "1¬† Organizaci√≥n de proyectos metagen√≥micos",
    "section": "1.1 Importancia del orden en experimentos",
    "text": "1.1 Importancia del orden en experimentos\nCuando pensamos en los datos para un proyecto de secuenciaci√≥n, solemos empezar por pensar en los datos de secuenciaci√≥n que recibimos del centro de secuenciaci√≥n, pero igual de importante, o incluso m√°s, son los datos generados sobre las secuencias antes de que lleguen al centro. Estos datos se suelen denominar metadatos. Los datos de secuencia en s√≠ mismos son in√∫tiles sin la informaci√≥n sobre lo que secuenci√≥.\nLa base de cualquier proyecto de investigaci√≥n es el correcto orden de los datos. No solamente facilita el an√°lisis sino que adem√°s permite compartir y colaborar con otros grupos. Documentar un proyecto que implica secuenciaci√≥n de datos incluye varios componentes. Algunos de ellos incluyen la metadata de las condiciones del experimento, mediciones con los par√°metros experimentales, preparaci√≥n de secuenciaci√≥n, informaci√≥n de las muestras, las propias secuencias y los archivos y flujos de cualquier an√°lisis bioinform√°tico. La organizaci√≥n de tus datos experimentales te prepara para ejecutar proyectos bioinform√°ticos de manera efectiva.\n\n1.1.1 Contexto:\nEste taller utiliza datos de un ensayo medio ambiental: Genomic adaptations in information processing underpins trophic strategy in a whole-ecosystem nutrient enrichment experiment de Jordan G. Okie y colaboradores. En este trabajo los autores comparan las diferencias entre las comunidades microbianas en sus medios naturales, oligotr√≥ficos y deficientes de f√≥sforo, una poza de Cuatro Ci√©negas y la misma comunidad microbiana bajo tratamiento de fertilizaci√≥n.",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Organizaci√≥n de proyectos metagen√≥micos</span>"
    ]
  },
  {
    "objectID": "1Ordendedatos.html#discusi√≥n-1",
    "href": "1Ordendedatos.html#discusi√≥n-1",
    "title": "1¬† Organizaci√≥n de proyectos metagen√≥micos",
    "section": "1.2 Discusi√≥n 1",
    "text": "1.2 Discusi√≥n 1\nEn el archivo colaborativo de Etherpad, discute:\n¬øQu√© tipos de datos e informaci√≥n ha generado antes de enviar su ADN/ARN para secuenciar?\n\n1.3 Soluci√≥n\nTipos de archivos e informaci√≥n que ha generado:\n\nHoja de c√°lculo o datos tabulares con los datos de su experimento y todo lo que estaba midiendo para su estudio.\nNotas en el cuaderno de laboratorio sobre c√≥mo realiz√≥ esos experimentos.\nDatos en hojas de c√°lculo o tablas sobre las muestras enviadas para secuenciaci√≥n. Los centros de secuenciaci√≥n suelen tener un formato espec√≠fico que requieren, con el nombre de la muestra, la concentraci√≥n de ADN y otra informaci√≥n.\nAnotaciones del cuaderno de laboratorio sobre c√≥mo preparaste el ADN/ARN para la secuenciaci√≥n y el tipo de secuenciaci√≥n que est√°s realizando, por ejemplo, Illumina HiSeq de extremos emparejados. Probablemente tambi√©n habr√° otras ideas. ¬øEsta informaci√≥n y datos fueron mayores de lo que esperabas?",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Organizaci√≥n de proyectos metagen√≥micos</span>"
    ]
  },
  {
    "objectID": "1Ordendedatos.html#notas-sobre-su-experimento",
    "href": "1Ordendedatos.html#notas-sobre-su-experimento",
    "title": "1¬† Organizaci√≥n de proyectos metagen√≥micos",
    "section": "1.4 Notas sobre su experimento",
    "text": "1.4 Notas sobre su experimento\nLas notas sobre su experimento, incluyendo c√≥mo prepar√≥ sus muestras para la secuenciaci√≥n, deben estar en su cuaderno de laboratorio, ya sea f√≠sico o electr√≥nico. Para obtener m√°s instrucciones sobre buenos cuadernos de laboratorio, consulte la secci√≥n sobre Gesti√≥n de Datos y Cuadernos de Laboratorio del Instituto M√©dico Howard Hughes ‚ÄúMaking the Right Moves: A Practical Guide to Scientifƒ±c Management for Postdocs and New Faculty‚Äù.\nIncluir fechas en las p√°ginas de su cuaderno de laboratorio, en las propias muestras y en cualquier registro sobre ellas le ayudar√° a asociar todo posteriormente. Usar fechas tambi√©n ayuda a crear identificadores √∫nicos, ya que, incluso si procesa la misma muestra dos veces, no suele hacerlo el mismo d√≠a o, si lo hace, lo sabe y les asigna nombres como A y B.\n\n1.5 Identificadores √∫nicos\nLos identificadores √∫nicos son nombres √∫nicos para una muestra o un conjunto de datos de secuenciaci√≥n. Son nombres que solo existen para esos datos. Tener estos nombres √∫nicos facilita su posterior seguimiento.",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Organizaci√≥n de proyectos metagen√≥micos</span>"
    ]
  },
  {
    "objectID": "1Ordendedatos.html#metadatos-datos-sobre-el-experimento",
    "href": "1Ordendedatos.html#metadatos-datos-sobre-el-experimento",
    "title": "1¬† Organizaci√≥n de proyectos metagen√≥micos",
    "section": "1.6 Metadatos: Datos sobre el experimento",
    "text": "1.6 Metadatos: Datos sobre el experimento\nLos datos del experimento suelen recopilarse en hojas de c√°lculo , como Excel. Adem√°s de la hoja de c√°lculo, resulta pr√°ctico crear un archivo de texto llamado README . Este archivo contiene informaci√≥n sobre el proyecto de investigaci√≥n, c√≥mo se generaron las muestras y c√≥mo leer la hoja de c√°lculo de metadatos. Esta informaci√≥n es muy pr√°ctica cuando se trabaja en equipo, ya que m√°s personas se unen al proyecto incluso en las diferentes etapas del experimento. Este orden puede ayudar a tus colaboradores a comprender mejor la informaci√≥n.\n\n1.7 Est√°ndares de metadatos\nEl tipo de datos que se recopilar√°n depende del experimento. Dependiendo del √°rea, se tienen formas espec√≠ficas de estructurar sus metadatos, de modo que sean coherentes y se puedan entender y utilizar. El Centro de Curaci√≥n Digital mantiene una lista de est√°ndares de metadatos , y algunos de ellos, especialmente relevantes para los datos gen√≥micos, est√°n disponibles en el Consorcio de Est√°ndares Gen√≥micos . En particular, la calidad del ensamblaje y una estimaci√≥n de la integridad y contaminaci√≥n del genoma son est√°ndares para los Genomas Ensamblados de Metagenoma (MAG).\nLa Universidad de Cornell nos proporciona una gu√≠a √∫til y un archivo de plantilla para escribir metadatos de estilo README en caso de que no existan est√°ndares de metadatos para su tipo de datos. Al enviar datos a una organizaci√≥n, es posible que le proporcionen un archivo con especificaciones sobre\nlos metadatos necesarios para su plataforma. Por ejemplo, MG-RAST proporciona un archivo como este .",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Organizaci√≥n de proyectos metagen√≥micos</span>"
    ]
  },
  {
    "objectID": "1Ordendedatos.html#discusi√≥n-2.-qu√©-informaci√≥n-escribir√≠as-en-tu-archivo-readme",
    "href": "1Ordendedatos.html#discusi√≥n-2.-qu√©-informaci√≥n-escribir√≠as-en-tu-archivo-readme",
    "title": "1¬† Organizaci√≥n de proyectos metagen√≥micos",
    "section": "1.8 Discusi√≥n 2. ¬øQu√© informaci√≥n escribir√≠as en tu archivo README?",
    "text": "1.8 Discusi√≥n 2. ¬øQu√© informaci√≥n escribir√≠as en tu archivo README?\nSupongamos que en su campo a√∫n no existen est√°ndares de metadatos. Piense en la cantidad m√≠nima de informaci√≥n que alguien necesitar√≠a para poder trabajar con sus datos sin hablar con usted. ¬øQu√© tipo de informaci√≥n incluir√≠a en su archivo README?\n\n1.9 Soluci√≥n\nAlgunos ejemplos de aclaraciones que deben escribirse en el README son:\n\nFormato de fecha (mm-dd-aaaa o dd-mm-aaaa, por ejemplo).\nSignificado de abreviaturas.\nSignificado o patr√≥n seguido para construir los identificadores √∫nicos de las muestras.\nDetalles sobre la metodolog√≠a.\nInformaci√≥n de contacto de las personas que realizaron la recolecci√≥n y/o experimentos.\nSignificado de cada nombre de variable.\n\n\n\n1.9.1 Estructuraci√≥n de datos en hojas de c√°lculo\nA menudo, introducimos datos que nos facilitan la lectura y el trabajo, ¬°porque somos humanos! Las computadoras necesitan datos estructurados para poder utilizarlos. Por lo tanto, para usar estos datos en un flujo de trabajo computacional, debemos pensar como computadoras al usar hojas de c√°lculo.\nLas reglas m√°s importantes para utilizar programas de hojas de c√°lculo para datos:\n\nDeje los datos sin procesar, ¬°no los modifique!\nCada observaci√≥n debe localizarse en su propia fila.\nColoque todas sus variables en columnas. Las variables son la informaci√≥n que tenemos sobre nuestra muestra (genotipo, fenotipo, tratamiento, etc.).\nLos nombres de las columnas deben ser explicativos pero sin espacios. Use ‚Äò-‚Äô, ‚Äò_‚Äô o may√∫sculas y min√∫sculas en lugar de espacios. Por ejemplo, ‚Äúlibrary-prep-method‚Äù es mejor que ‚Äúlibrary Preparation Method‚Äù o ‚Äúprep‚Äù, ya que los ordenadores interpretan los espacios de forma espec√≠fica.\nExporte los datos limpios a un formato de texto como .csv (valores separados por comas). Este formato garantiza que cualquier persona pueda usar los datos que requieren la mayor√≠a de los repositorios.",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Organizaci√≥n de proyectos metagen√≥micos</span>"
    ]
  },
  {
    "objectID": "1Ordendedatos.html#discusi√≥n-3.-organizaci√≥n-de-hoja-de-c√°lculo-en-excel",
    "href": "1Ordendedatos.html#discusi√≥n-3.-organizaci√≥n-de-hoja-de-c√°lculo-en-excel",
    "title": "1¬† Organizaci√≥n de proyectos metagen√≥micos",
    "section": "1.10 Discusi√≥n 3. Organizaci√≥n de hoja de c√°lculo en Excel",
    "text": "1.10 Discusi√≥n 3. Organizaci√≥n de hoja de c√°lculo en Excel\nEstes es un ejemplo de una hoja de c√°lculo generada a partir de un experimento de secuenciaci√≥n. En el documento colaborativo Etherpad, discute los problemas que identificas en esta hoja.\n\n1.11 Soluci√≥n\nEsta hoja contiene una gran cantidad de potenciales errores. Haciendo algunos peque√±os cambios puedes impactar positivamente la eficiencia y confianza durante la limpieza y an√°lsis. A continuaci√≥n encontrar√°s una lista de correcciones:\n\nEvitar usar multiples tablas.\nEvitar usar multiples pesta√±as.\nNo rellenar con ceros.\nNo usar valores nulos.\nNo usar formatos de tablas (colores, negritas, etc).\nNo dejar comentarios en las celdas.\nEvita usar espacios tanto en nombres de columnas como en valores de celdas.\nCuidado con el formato de fechas.",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Organizaci√≥n de proyectos metagen√≥micos</span>"
    ]
  },
  {
    "objectID": "1Ordendedatos.html#notas-adicionales-sobre-la-limpieza-de-los-datos",
    "href": "1Ordendedatos.html#notas-adicionales-sobre-la-limpieza-de-los-datos",
    "title": "1¬† Organizaci√≥n de proyectos metagen√≥micos",
    "section": "1.12 Notas adicionales sobre la limpieza de los datos",
    "text": "1.12 Notas adicionales sobre la limpieza de los datos\n¬°No temas! Si ya comenzaste tu proyecto y no est√° configurado as√≠, a√∫n hay oportunidades para actualizarlo. Uno de los mayores desaf√≠os son los datos tabulares que no est√°n formateados para que las computadoras puedan usarlos o que presentan inconsistencias que dificultan su an√°lisis.\nAl trabajar en la l√≠nea de comandos, es problem√°tico poner espacios en los nombres de directorios y archivos.\nSe describe m√°s pr√°ctica sobre c√≥mo estructurar datos en nuestra lecci√≥n de hoja de c√°lculo de ecolog√≠a de carpinter√≠a de datos.\nHerramientas como OpenRefine pueden ayudarle a limpiar sus datos.",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Organizaci√≥n de proyectos metagen√≥micos</span>"
    ]
  },
  {
    "objectID": "1Ordendedatos.html#referencias",
    "href": "1Ordendedatos.html#referencias",
    "title": "1¬† Organizaci√≥n de proyectos metagen√≥micos",
    "section": "1.13 Referencias",
    "text": "1.13 Referencias\nOrganizaci√≥n de datos-Harvard\nLa metadata cuenta: art√≠culo",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Organizaci√≥n de proyectos metagen√≥micos</span>"
    ]
  },
  {
    "objectID": "2Planificaciondeproyectos.html",
    "href": "2Planificaciondeproyectos.html",
    "title": "2¬† Planificaci√≥n de proyectos",
    "section": "",
    "text": "2.1 Grandes conjuntos de datos\nEn el contexto m√°s importante, los m√©todos y enfoques que necesitamos en bioinform√°tica son los mismos que necesitamos en el laboratorio o en el campo:¬†planificar, documentar y organizar¬†son la clave para una ciencia reproducible y de calidad.",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Planificaci√≥n de proyectos</span>"
    ]
  },
  {
    "objectID": "2Planificaciondeproyectos.html#discusi√≥n1-cu√°les-son-los-principales-retos-al-trabajar-con-datos-de-secuenciaci√≥n",
    "href": "2Planificaciondeproyectos.html#discusi√≥n1-cu√°les-son-los-principales-retos-al-trabajar-con-datos-de-secuenciaci√≥n",
    "title": "2¬† Planificaci√≥n de proyectos",
    "section": "2.2 Discusi√≥n1: ¬øCu√°les son los principales retos al trabajar con datos de secuenciaci√≥n?",
    "text": "2.2 Discusi√≥n1: ¬øCu√°les son los principales retos al trabajar con datos de secuenciaci√≥n?\n\n2.3 Soluci√≥n\nCuando se trata de trabajar con grandes conjuntos de datos el primer reto es el almacenamiento. Dependiendo de la cantidad de datos que esperas, podr√≠as anticipar el espacio que necesitas no solo para almacenarlo.\nDe igual manera, es importante que identifiques las necesidades computacionales para analizar dicha cantidad de datos.\nEs una buena pr√°ctica: tener una copia de tus datos (crudos) y quitar permisos para que cualquiera pueda modificarlos.",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Planificaci√≥n de proyectos</span>"
    ]
  },
  {
    "objectID": "2Planificaciondeproyectos.html#env√≠o-de-muestras-a-la-instalaci√≥n",
    "href": "2Planificaciondeproyectos.html#env√≠o-de-muestras-a-la-instalaci√≥n",
    "title": "2¬† Planificaci√≥n de proyectos",
    "section": "2.4 Env√≠o de muestras a la instalaci√≥n",
    "text": "2.4 Env√≠o de muestras a la instalaci√≥n\nEl primer paso para enviar su muestra a secuenciaci√≥n ser√° completar un formulario que documente los metadatos. Consulte el siguiente ejemplo de hoja de c√°lculo de env√≠o. De manera grupal, identifica las posibles mejoras en el llenado de este formato.",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Planificaci√≥n de proyectos</span>"
    ]
  },
  {
    "objectID": "2Planificaciondeproyectos.html#recuperaci√≥n-de-datos-de-secuenciaci√≥n-de-muestras-de-la-instalaci√≥n",
    "href": "2Planificaciondeproyectos.html#recuperaci√≥n-de-datos-de-secuenciaci√≥n-de-muestras-de-la-instalaci√≥n",
    "title": "2¬† Planificaci√≥n de proyectos",
    "section": "2.5 Recuperaci√≥n de datos de secuenciaci√≥n de muestras de la instalaci√≥n",
    "text": "2.5 Recuperaci√≥n de datos de secuenciaci√≥n de muestras de la instalaci√≥n\nCuando reciba los datos del centro de secuenciaci√≥n, recibir√° documentaci√≥n (metadatos), as√≠ como los archivos de secuencia. En grupo, descarga y examina los siguientes archivos de ejemplo:\n\nResultados de la secuenciaci√≥n - texto\nResultados de secuenciaci√≥n - Excel\n\n\n2.5.1 Contesta las siguientes preguntas:\n\n¬øC√≥mo se organizan estas muestras?\nSi quisiera relacionar los nombres de los archivos con los nombres de muestra enviados anteriormente (por ejemplo, tipo salvaje), ¬øpodr√≠a hacerlo?\n¬øQu√© significan las extensiones _R1/_R2 en los nombres de archivos?\n¬øQu√© indica la extensi√≥n ‚Äò.gz‚Äô en los nombres de archivos?\n¬øCu√°l es el tama√±o total del archivo? ¬øQu√© desaf√≠os podr√≠an existir a la hora de descargar y compartir estos datos?\n\n\n2.5.2 Soluci√≥n\n\nLas muestras est√°n organizadas por sample_id\nPara relacionar nombres de archivos, utilice sample_id y haga una BUSCARV en la hoja de env√≠o\nLas extensiones _R1/_R2 significan ‚ÄúLectura 1‚Äù y ‚ÄúLectura 2‚Äù de cada muestra\nLa extensi√≥n ‚Äò.gz‚Äô significa que es un formato comprimido tipo ‚Äúgzip‚Äù para ahorrar espacio en disco.\nEl tama√±o de todos los archivos combinados es de 1113,60 GB (¬°m√°s de un terabyte!). Para transferir archivos de este tama√±o, debe validar el tama√±o del archivo despu√©s de la transferencia. Es posible realizar comprobaciones de integridad absoluta de los archivos despu√©s de las transferencias y utilizar m√©todos para acelerar las transferencias, pero esto queda fuera del alcance de esta lecci√≥n.",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Planificaci√≥n de proyectos</span>"
    ]
  },
  {
    "objectID": "2Planificaciondeproyectos.html#pautas-para-el-almacenamiento-de-datos",
    "href": "2Planificaciondeproyectos.html#pautas-para-el-almacenamiento-de-datos",
    "title": "2¬† Planificaci√≥n de proyectos",
    "section": "2.6 Pautas para el almacenamiento de datos",
    "text": "2.6 Pautas para el almacenamiento de datos\nLos datos crudos que recibir√°s de la compa√±√≠a de secuenciaci√≥n son los cimientos de tu an√°lisis. Es necesario que tengas acceso a estos datos en caso de que sea necesario volver a realizar an√°lisis o corroboraciones.\n\nGuarde los datos en un lugar accesible para usted y los dem√°s miembros de su laboratorio. Como m√≠nimo, usted y el responsable del laboratorio deber√≠an tener acceso.\nAlmacene los datos en un lugar con copias de seguridad redundantes. Deben estar respaldados en dos ubicaciones en diferentes √°reas f√≠sicas.\nDeje los datos sin procesar. Trabajar√° con estos datos, pero no desea modificar esta copia almacenada de los datos originales. Si modifica los datos, nunca podr√° acceder a esos archivos originales. Explicaremos c√≥mo evitar modificar archivos accidentalmente en una lecci√≥n posterior de este taller (consulte Permisos de archivos) .",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Planificaci√≥n de proyectos</span>"
    ]
  },
  {
    "objectID": "2Planificaciondeproyectos.html#referencias",
    "href": "2Planificaciondeproyectos.html#referencias",
    "title": "2¬† Planificaci√≥n de proyectos",
    "section": "2.7 Referencias",
    "text": "2.7 Referencias\nL. Welch, F. Lewitter, R. Schwartz, C. Brooksbank, P. Radivojac, B. Gaeta y M. Schneider, ‚Äò¬†Directrices curriculares de bioinform√°tica: hacia una definici√≥n de competencias b√°sicas¬†‚Äô, PLoS Comput Biol, vol.¬†10, no. 3, p.¬†e1003496, 2014.",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Planificaci√≥n de proyectos</span>"
    ]
  },
  {
    "objectID": "3DatosdeNCBI.html",
    "href": "3DatosdeNCBI.html",
    "title": "3¬† Examinando datos del NCBI",
    "section": "",
    "text": "3.1 Bases de datos\nEn la mayor√≠a de los experimentos normalmente pensamos en generar datos de secuenciaci√≥n. Sin embargo, casi todos los an√°lisis utilizan datos de referencia para comparar o anotar ciertos datos. Incluso podr√≠as realizar un proyecto solamente de datos que ya est√°n almacenados en bases de datos. Esta data es un recurso esencial para el an√°lisis de datos gen√≥micos.\nNormalmente cuando publicas un art√≠culo, las revistas requieren que almacenes tus datos en un repositorio p√∫blico. Compartir tus datos hace que puedan ser inclu√≠dos en otros trabajos y tener citas.\nHay una gran variedad de bases de datos p√∫blicas. Algunos organismos modelo cuentan con sus propias bases de datos. Las dos m√°s grandes son la National Center for Biotechnology Information (NCBI) y la European Nucleotide Archive (EMBL-EBI). El Sequence Read Archive (SRA) pertenece al NCBI.\nLa siguiente imagen muestra los archivos adicionales/suplementarios del art√≠culo y que contienen informaci√≥n de la localizaci√≥n de los datos de secuenciaci√≥n. Siempre puedes buscar en Disponibilidad de datos dentro de las secciones de los art√≠culos.\nSigue los siguientes pasos para accesar al SRA usando la infomaci√≥n de arriba.",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Examinando datos del NCBI</span>"
    ]
  },
  {
    "objectID": "3DatosdeNCBI.html#bases-de-datos",
    "href": "3DatosdeNCBI.html#bases-de-datos",
    "title": "3¬† Examinando datos del NCBI",
    "section": "",
    "text": "El art√≠culo refiere al BioProject con ID ‚ÄúPRJEB22811‚Äù en el NCBI. Ve al sitio web del NCBI y pega el ID.\nVer√°s un link al BioProject ‚ÄúCuatro Ci√©negas Lagunita Fertilization Experiment‚Äù.\nEn la p√°gina del BioProject, encuentra el acceso en SRA Experiments en la tabla de ‚ÄúProject Data‚Äù.\nEste link te guiar√° a todas (40) las muestras de este BioProject. Selecciona la muestra n√∫mero 40. En la parte superior de la pesta√±a encontrar√°s el enlace ‚ÄúSend results to Run Selector/Enviar los resultados a Run Selector‚Äù. Este enlace te redireccionar√° al SRA Run Selector. En esta p√°gina encontrar√°s los datos de secuenciaci√≥n as√≠ como los metadatos del experimento para la muestra #40.\nEn la secci√≥n Select podemos ver el n√∫mero de Runs, Bytes y Bases que contiene la muestra. Si das clic en metadata se descargar√° el archivo de metadatos de la muestra.\n\n\n\n\n\n\n\n3.1.1 Acerca de la Sequence Read Archive:\n\nSRA Documentaci√≥n\nSRA toolkit documentaci√≥n",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Examinando datos del NCBI</span>"
    ]
  },
  {
    "objectID": "3DatosdeNCBI.html#referencias",
    "href": "3DatosdeNCBI.html#referencias",
    "title": "3¬† Examinando datos del NCBI",
    "section": "3.2 Referencias:",
    "text": "3.2 Referencias:\nOkie JG, Poret-Peterson AT, Lee ZM, Richter A, Alcaraz LD, Eguiarte LE, Siefert JL, Souza V, Dupont CL, Elser JJ. Genomic adaptations in information processing underpin trophic strategy in a whole-ecosystem nutrient enrichment experiment. Elife. 2020 Jan 28;9:e49816. doi: 10.7554/eLife.49816. PMID: 31989922; PMCID: PMC7028357. Art√≠culo",
    "crumbs": [
      "**Secci√≥n 1** - Organizaci√≥n de proyectos metagen√≥micos",
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Examinando datos del NCBI</span>"
    ]
  },
  {
    "objectID": "4IntroduccionnavigationShell.html",
    "href": "4IntroduccionnavigationShell.html",
    "title": "4¬† Introducci√≥n a Shell",
    "section": "",
    "text": "5 &lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD\nUn Shell es un programa de computador que presenta una interfaz en l√≠nea de comando que permite ejecutar funciones en el computador utilizando comandos especiales en vez de tener un control a trav√©s de una interfaz gr√°fica que combina el uso de un rat√≥n o mouse y un teclado de computador.\nINSERTAR FOTO\nCOMENZAR CON CONEXI√ìN AL SERVIDOR (10 minutos)\nPath relativo y absoluto\nAlgunos comandos cd, mkdir, pwd\nejercicio (5 minutos) en equipos de encontrar el archivo.txt y poner el path absoluto de la ubicaci√≥n del archivo.\nRepaso de comandos",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Introducci√≥n a Shell</span>"
    ]
  },
  {
    "objectID": "4IntroduccionnavigationShell.html#preparaci√≥n-del-directorio-de-trabajo",
    "href": "4IntroduccionnavigationShell.html#preparaci√≥n-del-directorio-de-trabajo",
    "title": "4¬† Introducci√≥n a Shell",
    "section": "5.1 Preparaci√≥n del directorio de trabajo",
    "text": "5.1 Preparaci√≥n del directorio de trabajo\n\nRuta / Camino absoluto\ncd /home/usuario/data/\nRuta / Camino relativo\ncd ../ # Ir a la carpeta anterior",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Introducci√≥n a Shell</span>"
    ]
  },
  {
    "objectID": "4IntroduccionnavigationShell.html#comandos-b√°sicos",
    "href": "4IntroduccionnavigationShell.html#comandos-b√°sicos",
    "title": "4¬† Introducci√≥n a Shell",
    "section": "5.2 Comandos b√°sicos",
    "text": "5.2 Comandos b√°sicos\n\n\n\n\n\n\n\n\nComandos\nInformaci√≥n\nArgumentos\n\n\n\n\nssh\nConexi√≥n a servidores\nssh usuario@servidor.mx\n\n\nls\nObservar el contenido de los archivos en una carpeta\nls directorio/\n\n\ncd\nMoverse de directorios\ncd /home/usuario/data/\n\n\nmkdir\nCrear un nuevo directorio\nmkdir data\n\n\nrmdir\nEliminar el directorio\nrmkdir -rf data\n\n\nnano/vim\nEditores de texto plano\nnano Archivo.txt / vim Archivo.txt\n\n\ncp\nCopiar archivos\ncp Archivo1.txt /home/usuario/data/\n\n\nmv\nMover un archivo o carpeta\n\n\n\necho\nPara llamar y/o declarar variables\necho ‚ÄúHello world‚Äù\n\n\nchmod\nCambiar permisos del usuario\nchmod 777 data/\n\n\nrsync\nDescargar o subir archivos\n\n\n\nscp\nDescargar o subir archivos",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Introducci√≥n a Shell</span>"
    ]
  },
  {
    "objectID": "4IntroduccionnavigationShell.html#ejemplo",
    "href": "4IntroduccionnavigationShell.html#ejemplo",
    "title": "4¬† Introducci√≥n a Shell",
    "section": "7.1 üëâ Ejemplo:",
    "text": "7.1 üëâ Ejemplo:\nSi est√°s en /home/dcuser y quieres entrar a un subdirectorio:\ncd dc_workshop\n\n\n7.1.1 üìå 4 Subir un nivel en la estructura de carpetas:\ncd ..\n\n\n7.1.2 üìå 5 Volver al directorio principal:\ncd ~\n\n\n7.1.3 üìå 6 Atajos √∫tiles:\n\ncd - te lleva al √∫ltimo directorio en el que estuviste.\n\n================================\n\n\n7.1.4 üîπ Autocompletado (Tab):\nEs una funci√≥n que te permite completar nombres de archivos o carpetas\nal presionar la tecla ‚ÄúTab‚Äù.\nüëâ Ejemplo:\nSi escribes:\ncd dc&lt;tab&gt;\n# El Shell completar√° el nombre a dc_workshop si existe.",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Introducci√≥n a Shell</span>"
    ]
  },
  {
    "objectID": "4IntroduccionnavigationShell.html#permisos-de-archivos",
    "href": "4IntroduccionnavigationShell.html#permisos-de-archivos",
    "title": "4¬† Introducci√≥n a Shell",
    "section": "7.2 üîê 2. Permisos de archivos",
    "text": "7.2 üîê 2. Permisos de archivos\nVer permisos con ls -l\nls -l youfoundit.txt\n-rw-rw-r-- 1 usuario grupo 0 May 27 23:16 youfoundit.txt\n\nQuitar permiso de escritura al due√±o con chmod:\nchmod -w youfoundit.txt\nls -l youfoundit.txt\n# -r--r--r-- 1 usuario grupo 0 May 27 23:16 youfoundit.txt",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Introducci√≥n a Shell</span>"
    ]
  },
  {
    "objectID": "4IntroduccionnavigationShell.html#rutas-absolutas-vs.-relativas",
    "href": "4IntroduccionnavigationShell.html#rutas-absolutas-vs.-relativas",
    "title": "4¬† Introducci√≥n a Shell",
    "section": "7.3 3. Rutas absolutas vs.¬†relativas",
    "text": "7.3 3. Rutas absolutas vs.¬†relativas\n\nRuta absoluta: parte de /\ncd /home/usuario/dc_workshop/.hidden\nRuta relativa: parte de tu directorio actual\ncd dc_workshop/.hidden",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Introducci√≥n a Shell</span>"
    ]
  },
  {
    "objectID": "5Operacionesyexploraciondefastq.html",
    "href": "5Operacionesyexploraciondefastq.html",
    "title": "5¬† Trabajar con archivos y directorios",
    "section": "",
    "text": "5.1 Detalles sobre el formato FASTQ\nUn archivo FASTQ almacena lecturas de secuenciaci√≥n junto con sus puntuaciones de calidad. Cada lectura ocupa 4 l√≠neas con esta estructura:\nRealizamos un experimento de secuenciaci√≥n y tenemos cuatro archivos de resultados, que se almacenan en nuestro directorio untrimmed_fastq.\nNavegue hasta su directorio untrimmed_fastq.\nsi tus archivos est√°n comprimidos con extensi√≥n .gz (como los archivos .fastq.gz), puedes descomprimirlos usando el comando:\ncat como acabas de ver al ejecutar el comando, cuando el archivo es muy grande (como los que tenemos), puede resultar molesto. Siempre puedes usar Ctrl+C para detener el comando.\nEl programa lesses √∫til en este caso. lessAbre el archivo como de solo lectura y permite navegar por √©l.\nAlgunos comandos de navegaci√≥n en less :\n1.- Pulsa / (la barra)\n2.- Escribe la palabra o frase que buscas\n3.- Pulsa Enter\nless saltar√° a la primera vez que aparezca despu√©s de donde est√°s.\n1.- Sin escribir nada nuevo,\n2.- pulsa / Enter\nless saltar√° a la siguiente aparici√≥n en el archivo.\n1.- Pulsa ? (el signo de interrogaci√≥n) 2.- Escribe la palabra que buscas\n3.- Pulsa Enter\nless saltar√° a la √∫ltima aparici√≥n antes de donde est√°s.",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>**Trabajar con archivos y directorios**</span>"
    ]
  },
  {
    "objectID": "6Redireccion.html",
    "href": "6Redireccion.html",
    "title": "6¬† Redirecci√≥n de Entrada y Salida",
    "section": "",
    "text": "6.1 Objetivos\ngrepes una utilidad de l√≠nea de comandos para buscar en archivos de texto plano l√≠neas que coincidan con un conjunto espec√≠fico de caracteres (a veces llamado cadena) o un patr√≥n particular (que se puede especificar mediante expresiones regulares).\nEn esta lecci√≥n, buscaremos manualmente cadenas de N en los resultados de nuestra secuencia para ilustrar algunos principios de la b√∫squeda en archivos. Este tipo de b√∫squeda puede ser muy √∫til para evaluar la calidad de los resultados de la secuenciaci√≥n; sin embargo, en su investigaci√≥n, probablemente utilizar√° una herramienta bioinform√°tica con un programa integrado para filtrar lecturas de baja calidad. Aprender√° a usar esta herramienta en una lecci√≥n posterior .\nBusquemos la cadena NNNNNNNNNN en el archivo JC1A_R2.fastq.\nEste comando imprime en la terminal todas las l√≠neas del archivo JC1A_R2.fastq que contienen al menos 10 N consecutivas, sin importar lo largo o corto que sea el archivo.\nQuiz√° nos interese no solo la propia secuencia que contiene estas N, sino tambi√©n el identificador de la lectura (la l√≠nea que precede inmediatamente a la secuencia en un archivo FASTQ) y sus puntuaciones de calidad (las dos l√≠neas que siguen a la secuencia). Para obtener toda esta informaci√≥n de cada lectura, podemos usar:\nUno de los bloques de l√≠neas que devuelve este comando es:\nDe esta forma obtenemos, para cada lectura que contiene las 10 N consecutivas, su encabezado, la secuencia completa y la l√≠nea de calidad, todo en un solo paso.",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Redirecci√≥n de Entrada y Salida</span>"
    ]
  },
  {
    "objectID": "7Buclesscriptsdescarga.html",
    "href": "7Buclesscriptsdescarga.html",
    "title": "7¬† Escritura de scripts y trabajo con datos",
    "section": "",
    "text": "8 Escribir y editar archivos con Nano\nA veces necesitamos crear o modificar archivos de texto directamente en la terminal. Para ello usaremos Nano, un editor de texto sencillo.",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>**Escritura de scripts y trabajo con datos**</span>"
    ]
  },
  {
    "objectID": "7Buclesscriptsdescarga.html#referencias",
    "href": "7Buclesscriptsdescarga.html#referencias",
    "title": "7¬† Bucles",
    "section": "9.1 Referencias",
    "text": "9.1 Referencias\n\nHaydee tutorial: Temas Selectos de An√°lisis Num√©rico y Computaci√≥n Cient√≠fica: Computo cient√≠fico para el an√°lisis de datos\nAlejandra Medina tutorial: Control de versiones con GitHub y RStudio",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Bucles</span>"
    ]
  },
  {
    "objectID": "8Organizacionproyecto.html",
    "href": "8Organizacionproyecto.html",
    "title": "8¬† Organizaci√≥n de proyectos",
    "section": "",
    "text": "8.1 Referencias\nKey steps\nEjercicio 1: Making and organized file system (equipos de 5 x 5 minutos): Mensaje con pista: busqueda en el manual.\nDocumenta tu actividad en el proyecto\nhistory\nEjercicio 2: Crea un registro de los comandos que has utilizado el d√≠a de hoy.",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Organizaci√≥n de proyectos</span>"
    ]
  },
  {
    "objectID": "8Organizacionproyecto.html#referencias",
    "href": "8Organizacionproyecto.html#referencias",
    "title": "8¬† Organizaci√≥n de proyectos",
    "section": "",
    "text": "Haydee tutorial: Temas Selectos de An√°lisis Num√©rico y Computaci√≥n Cient√≠fica: Computo cient√≠fico para el an√°lisis de datos\nAlejandra Medina tutorial: Control de versiones con GitHub y RStudio\nWilson, et al.¬†2014. Best Practices for Scientific Computing. PLOS Biology\nEvelia Coss - tutorial Buenas practicas en R\nEvelia Coss - Make your CV tutorial",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Organizaci√≥n de proyectos</span>"
    ]
  },
  {
    "objectID": "9IntroduccionRStudio.html",
    "href": "9IntroduccionRStudio.html",
    "title": "9¬† Introducci√≥n a R",
    "section": "",
    "text": "9.1 Revisi√≥n de la configuraci√≥n\nR se utiliza para nombrar un lenguaje de programaci√≥n y el software que lee e interpreta las instrucciones escritas en el script. Se especializa en el an√°lisis estad√≠stico y la generaci√≥n de gr√°ficos.\nAlgunas de las ventajas de trabajar con R son:\nPor su parte, RStudio es el programa (en forma de interfaz gr√°fica) m√°s popular para la escritura de scripts que adem√°s nos permite navegar por los archivos, inspeccionar variables y visualizar nuestros gr√°ficos.\nAl abrir R Studio por primera vez, ver√°s tres paneles en la pantalla. Para ver los cuatro paneles de la imagen, deber√°s crear un nuevo script. Ve a la pesta√±a: Archivo/File &gt; New File/Nuevo Archivo &gt; R Script.\nComenzando de la esquina superior izquierda tenemos:\nAl igual que en la Shell o l√≠nea de comandos, es recomendable mantener los datos relacionados en una sola carpeta. En RStudio, a esta carpeta se le llama directorio de trabajo y es donde se guardar√°n y buscar√°n los archivos. Cuando se necesite comprobar la ubicaci√≥n del actual directorio de trabajo, se utiliza getwd() directo en la consola de R Studio, en el editor de scripts o en el panel de archivos.\nSi tu directorio de trabajo actual no es el esperado, puedes cambiarlo haciendo clic en el icono del engranaje azul en la opci√≥n Establecer como directorio de trabajo/Set as a working directory.",
    "crumbs": [
      "**Secci√≥n 3** - Primeros pasos con R Studio",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a R</span>"
    ]
  },
  {
    "objectID": "9IntroduccionRStudio.html#revisi√≥n-de-la-configuraci√≥n",
    "href": "9IntroduccionRStudio.html#revisi√≥n-de-la-configuraci√≥n",
    "title": "9¬† Introducci√≥n a R",
    "section": "",
    "text": "&gt; setwd(\"~/dc_workshop/taxonomy\")",
    "crumbs": [
      "**Secci√≥n 3** - Primeros pasos con R Studio",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a R</span>"
    ]
  },
  {
    "objectID": "9IntroduccionRStudio.html#c√≥digo-en-r",
    "href": "9IntroduccionRStudio.html#c√≥digo-en-r",
    "title": "9¬† Introducci√≥n a R",
    "section": "9.2 C√≥digo en R",
    "text": "9.2 C√≥digo en R\nEn la consola se pueden escribir y ejecutar comandos de manera inmediata. Aqu√≠ se mostrar√°n los resultados de la ejecuci√≥n de esos comandos (como en Shell). Puedes escribir instrucciones cuando veas signo ‚Äú&gt;‚Äù en la consola y pulsar ‚ÄúEnter‚Äù para ejecutar.\n&gt; 4+3\n&gt; addition &lt;- 4+3\n&gt; substraction &lt;-2+1\n&gt; total &lt;- addition +substraction\n&gt; total\nSin embargo, estas √≥rdenes y operaciones se olvidar√°n al cerrar la sesi√≥n. Aqu√≠ entra en juego la üí´reproducibilidadüí´.\nPor ello es conveniente escribir los comandos que queremos guardar en nuestro editor de scripts y guardarlo peri√≥dicamente. Podemos ejecutar nuestras l√≠neas de c√≥digo en el script con el atajo Ctrl + Enter (Cmd + Return). De esta manera el comando de la l√≠nea actual ser√° seleccionado y se enviar√° por la consola para su ejecuci√≥n.\nEl tiempo puede ser enemigo o aliado de la memoria. Por ello es importante asegurarnos de recordar por qu√© escribimos qu√© comandos en nuestros scripts. Se pueden dejar comentarios (l√≠neas de texto no ejecutables) comenzando una l√≠nea con #.\n#Hagamos matem√°ticas en RStudio. Cu√°ntas veces al a√±o los super mercados cambian el pan que usan de muestra?\n#Si es que lo hacen cada 15 d√≠as:\n&gt; 365/15",
    "crumbs": [
      "**Secci√≥n 3** - Primeros pasos con R Studio",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a R</span>"
    ]
  },
  {
    "objectID": "9IntroduccionRStudio.html#referencias",
    "href": "9IntroduccionRStudio.html#referencias",
    "title": "9¬† Introducci√≥n a R",
    "section": "9.3 Referencias",
    "text": "9.3 Referencias\nR para reci√©n salidos del cascar√≥n",
    "crumbs": [
      "**Secci√≥n 3** - Primeros pasos con R Studio",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a R</span>"
    ]
  },
  {
    "objectID": "10Tiposdedatos.html",
    "href": "10Tiposdedatos.html",
    "title": "10¬† Estructuras de datos en R",
    "section": "",
    "text": "No importa cu√°n complejo sea nuestro an√°lisis, todos los datos en R pertenecer√°n a alguno de los siguientes tipos:\n\ndoble\nentero\ncomplejo\nl√≥gico\ncaracter\n\nEste concepto nos ayudar√° a aprender una de las herramientas m√°s poderosas de R; la manipulaci√≥n de diversos tipos de datos en conjunto en lo que se denomina un data-frame.\n\n\n\n\n\nAdem√°s de los tipos de datos, existen diferentes maneras de organizar los datos en R, denominadas estructuras de datos. La estructura de datos m√°s simple es un vector, una secuencia de datos del mismo tipo. Un vector se puede crear con la funci√≥n c() .\n&gt; char_vector&lt;-c(\"a\",\"b\",\"c\",\"c\",\"d\")\n&gt; typeof(char_vector)\nUna estructura de datos m√°s compleja es el factor, que contiene nombres de las categor√≠as (llamados niveles) y una secuencia de ocurrencias de dichas categor√≠as.\nchar_factor&lt;-as.factor(char_vector)\nchar_factor\nlevels: a b c\n\n\n\n\n\n\nNota!\n\n\n\nSi usamos ‚Äú‚Äù para definir un objeto, R lo leer√° como un caracter, independientemente de que estemos escribiendo n√∫meros. La may√∫scula despu√©s de un n√∫mero indica que R lo guardar√° como entero.\n\n\n\n11 Manipulaci√≥n de data frames\nLos data frames son estructuras de datos potentes en R. Podemos comenzar a crear un conjunto de datos simulado:\nmusician &lt;- data.frame(people = c(\"Medtner\", \"Radwimps\", \"Shakira\"),\n                         pieces = c(722,187,68),\n                         likes = c(0,1,1))\n&gt; musician\nEl contenido de nuestro nuevo objeto:\n     people pieces likes \n   1  Medtner    722     0 \n   2 Radwimps    187     1 \n   3  Shakira     68     1\nPara comprobar que nuestro objeto es un data frame podemos usar class().\nclass(musician)\n\"data.frame\"\nUn dataframe es una colecci√≥n de vectores (una lista), cuyos componentes deben ser del mismo tipo de datos dentro de cada vector.\nPodemos explorar nuestro objeto extrayendo columnas con el operador $.\nmusician$people\nPodemos tambi√©n extraer informaci√≥n de un lugar espec√≠fico en nuestros datos utilizando la nomenclatura de matriz [-,-] donde el primer n√∫mero dentro de los corchetes especifica el n√∫mero de fila y el segundo el n√∫mero de columna:\n\n\n\n\n\nmusician[3,2]\n&gt; musician[1,\"pieces\"]",
    "crumbs": [
      "**Secci√≥n 3** - Primeros pasos con R Studio",
      "<span class='chapter-number'>10</span>¬† <span class='chapter-title'>Estructuras de datos en R</span>"
    ]
  },
  {
    "objectID": "11Graficandoconggplot.html",
    "href": "11Graficandoconggplot.html",
    "title": "11¬† Creando gr√°ficos con ggplot2",
    "section": "",
    "text": "11.1 Librer√≠as de R\nHasta ahora hemos usado las funciones b√°sicas incluidas en el lenguaje R. Sin embargo, R puede usar grupos de funciones para diversos prop√≥sitos. Estos se llaman paquetes o librer√≠as. Una librer√≠a es una familia de unidades de c√≥digo con funciones, clases y variables espec√≠ficas que juntas implementan una serie de tareas relacionadas.\nInstalar una librer√≠a es como comprar un nuevo equipo de laboratorio. Cargar un paquete es como sacar ese equipo de su caja y colocarlo en el espacio de trabajo. Los paquetes proporcionan funcionalidad adicional al c√≥digo base de R, similar a como el nuevo equipo de laboratorio agrega funcionalidad a un espacio de laboratorio.\nR tiene su propio sisteme de gr√°ficos b√°sico pero usaremos una librer√≠a que nos ayudar√° a crear figuras m√°s art√≠sticas: ggplot2.\nInstalamos la librer√≠a\nAhora que est√° instalada, debemos cargarla. Siempre se recomienda cargar todas las bibliotecas que se usar√°n en un script al inicio de la sesi√≥n.",
    "crumbs": [
      "**Secci√≥n 3** - Primeros pasos con R Studio",
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>Creando gr√°ficos con ggplot2</span>"
    ]
  },
  {
    "objectID": "11Graficandoconggplot.html#librer√≠as-de-r",
    "href": "11Graficandoconggplot.html#librer√≠as-de-r",
    "title": "11¬† Creando gr√°ficos con ggplot2",
    "section": "",
    "text": "install.packages(\"ggplot2\")\n\nlibrary(ggplot2)",
    "crumbs": [
      "**Secci√≥n 3** - Primeros pasos con R Studio",
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>Creando gr√°ficos con ggplot2</span>"
    ]
  },
  {
    "objectID": "11Graficandoconggplot.html#visualizaci√≥n-con-ggplot2",
    "href": "11Graficandoconggplot.html#visualizaci√≥n-con-ggplot2",
    "title": "11¬† Creando gr√°ficos con ggplot2",
    "section": "11.2 Visualizaci√≥n con ggplot2",
    "text": "11.2 Visualizaci√≥n con ggplot2\nggplot2 se cre√≥ con la idea de que cualquier gr√°fico puede expresarse con tres componentes:\n\nConjunto de datos\nCoordenadas\nConjunto de geoms (aka la representaci√≥n visual de los datos)\n\nEstas geoms pueden considerarse capas superpuestas, por lo que es necesario tener especial cuidado al mostrar capas de informaci√≥n √∫tiles que transmitan un mensaje.\n\n\n\n\n\nFigura de QCBS R Workshop\nmusician\nIntentaremos crear una figura s√≥lo con los datos y coordenadas de los componentes.\nggplot(data= musician,\n       mapping = aes(x = people, y = pieces))\n\n\n\n\n\nDescribiendo el c√≥digo anterior. Primero llamamos a la funci√≥n ggplot. Esto le dir√° a R que queremos crear una gr√°fica y los par√°metros indicados dentro de esta funci√≥n se aplicar√°n a todas las capas del gr√°fico. Dimos dos argumentos al c√≥digo:\n\nLos datos que queremos mostrar en nuestra figura, es decir data=musician\nLa forma de mostrarlos en el gr√°fico, es decir, mapping = aes(x=people, y=pieces), que le indicar√° a ggplot c√≥mo se mapear√°n las variables en el gr√°fico.\n\nEn este caso x es el nombre de los grupos, mientras que y es el n√∫mero de piezas que cada uno de ellos compuso. Con esto hemos hecho la base de nuestro gr√°fico, pero no podemos ver los datos porque no hemos elegido una forma gr√°fica de representarlos (geoms).\nggplot(data= musician,\n        mapping = aes(x = people, y = pieces))+\n  geom_col()\n\n\n\n\n\nAlgunos elementos del gr√°fico pueden ser informativos o meramente decorativos. si queremos que sean informativos deben estar dentro de la aes() e indicar qu√© informaci√≥n mostrar√°n. si queremos que sean decorativos, deben estar fuera de aes(). Veamos como funciona.\nggplot(data= musician,\n       mapping = aes(x = people, y = pieces))+\n  geom_col(color = \"blue\")\n\n\n\n\n\nggplot(data= musician,\n       mapping = aes(x = people, y = pieces))+\n  geom_col(aes(color= likes))\n\n\n\n\n\n\n11.2.1 Pidiendo ayuda\nSi alguna vez tienes problemas para correr alguna funci√≥n, puedes usar el signo ? para conseguir m√°s informaci√≥n desde la interfaz de RStudio. Por ejemplo ??barplot abrir√° la ventana de ayuda en el panel derecho inferior.",
    "crumbs": [
      "**Secci√≥n 3** - Primeros pasos con R Studio",
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>Creando gr√°ficos con ggplot2</span>"
    ]
  },
  {
    "objectID": "11Graficandoconggplot.html#el-cielo-es-el-l√≠mite",
    "href": "11Graficandoconggplot.html#el-cielo-es-el-l√≠mite",
    "title": "11¬† Creando gr√°ficos con ggplot2",
    "section": "11.3 El cielo es el l√≠mite",
    "text": "11.3 El cielo es el l√≠mite\nExisten muchas otras geoms por explorar. Claro que necesitamos un data frame mucho m√°s complejo para poder hacer figuras m√°s complejas. Tambi√©n depende c√≥mo quieres mostrar tus datos o qu√© quieres mostrar.\n\n11.3.1 Referencias\nWorkshop3: Introduction to ggplot2\nReproducibilidad gen√≥mica en R",
    "crumbs": [
      "**Secci√≥n 3** - Primeros pasos con R Studio",
      "<span class='chapter-number'>11</span>¬† <span class='chapter-title'>Creando gr√°ficos con ggplot2</span>"
    ]
  },
  {
    "objectID": "12Iniciandomiproyectometagenomico.html",
    "href": "12Iniciandomiproyectometagenomico.html",
    "title": "12¬† Iniciando mi proyecto metagen√≥mico",
    "section": "",
    "text": "12.0.1 Introducci√≥n\nMuchas de las herramientas para el an√°lisis metagen√≥mico se utilizan en l√≠nea de comando por las siguientes razones:\nEn esta secci√≥n aplicar√°s los conocimientos para implementar un workflow com√∫n en metagen√≥mica: identificar Unidades Taxon√≥micas Operacionales (OTU) en muestras tomadas de metagenomas.\nComenzaremos con un conjunto de lecturas/reads secuenciados en archivos con formato .fastq. Realizaremos algunos pasos de control de calidad, ensamblaremos los reads en contigs y finalizaremos identificando y visualizando los OTUs en estas muestras.\nToma en cuenta que a medida que avanzamos en esta secci√≥n, aunque no utilices el mismo flujo de trabajo, aprender√°s a implementar herramientas bioinform√°ticas importantes en l√≠nea de comandos.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>12</span>¬† <span class='chapter-title'>Iniciando mi proyecto metagen√≥mico</span>"
    ]
  },
  {
    "objectID": "12Iniciandomiproyectometagenomico.html#comienza-tu-proyecto-metagen√≥mico",
    "href": "12Iniciandomiproyectometagenomico.html#comienza-tu-proyecto-metagen√≥mico",
    "title": "12¬† Iniciando mi proyecto metagen√≥mico",
    "section": "12.1 Comienza tu proyecto metagen√≥mico",
    "text": "12.1 Comienza tu proyecto metagen√≥mico\n\n12.1.1 Metagen√≥mica\nLos metagen√≥mas son colecciones de secuencias gen√≥micas de varios microorganismos que coexisten en un determinado espacio. Nos brindan informaci√≥n sobre la composici√≥n taxon√≥mica, metabol√≥mica e incluso funcional de las comunidades que estudiamos. Los metagen√≥mas se emplean habitualmente para investigar la ecolog√≠a de nichos, como por ejemplo el intestino humano o el fondo marino.\nDado que los metagenomas son mezclas de secuencias que perteneven a diferentes especies, un flujo de trabajo metagen√≥mico est√° dise√±ado para responder dos preguntas:\n\n¬øQu√© especies est√°n representadas en la muestra?\n¬øQu√© son capaces de hacer?\n\nPara determinar qu√© especies est√°n presentes en un nicho, debemos realizar una asignaci√≥n taxon√≥mica de las secuencias obtenidas. Para determinar sus capacidades podemos examinar los genes codificados directamente en el metagenoma o encontrar genes asociados a las especies encontradas. Para determinar qu√© metodolog√≠a usar es fundamental saber qu√© preguntas queremos responder.\n\n\n12.1.2 Shotgun y amplicon\nExisten dos rutas para obtener informaci√≥n de una muestra:\n\nMetagen√≥mica por Shotgun\nMetabarcoding\n\nCon la metagen√≥mica por Shotgun, secuenciamos partes aleatorias (idealmente todas las partes del genoma) de los genomas presentes en una muestra. Podemos buscar el origen de estas piezas (es decir, su taxonom√≠a) y tratar de encontrar tambi√©n a qu√© parte corresponden. Es posible obtener genomas individuales completos de un metagenoma shotgun (MAGs). Sin embargo, el ensamblaje de MAG requiere muchas secuencias gen√≥micas de un organismo (gran profundidad de secuenciaci√≥n), lo cual se vuelve un reto cuando nuestra especie de inter√©s no es muy abundante en la muestra o ambiente. Finalmente la secuenciaci√≥n es costosa y hacer r√©plicas t√©cnicas y biol√≥gicas puede ser prohibitivamente costoso.\nPor el contrario, el metabarcoding suele ser una t√©cnica m√°s econ√≥mica. Este menor coste se debe a las especificaciones de la t√©cnica, la cual consiste en la recopilaci√≥n de peque√±os fragmentos gen√≥micos presentes en la comunidad y amplificados mediante PCR. La conservaci√≥n de regiones gen√≥micas entre especies es la raz√≥n por la que los amplicones m√°s populares para bacterias utilizados en esta metodolog√≠a con los 16S. Sin embargo, esta t√©cnica se limita a ofrecernos la taxonom√≠a del organismo. Interponiendo la posibilidad de proveer informaci√≥n metab√≥lica.\n\n\n\n\n\n\n\n12.1.3 Sobre los metadatos\nEn la mayor√≠a de los casos, las diferencias observadas al comparar metagenomas pueden correlacionarse con los metadatos, por lo que debemos dedicar una secci√≥n de nuestro dise√±o experimental a los metadatos que esperamos recopilar y registrar.\nLos datos que vamos a utilizar son de un estudio sobre la respuesta de la comunidad bacteriana de Cuatro Ci√©negas al enriquecimiento de nutrientes. La comparaci√≥n entre comunidades bacterianas demostr√≥ que algunos rasgos gen√≥micos como el tama√±o medio del genoma, el contenido de GC, el n√∫mero total de genes de ARNt y ARNr y el sesgo en el uso de codones, se modificaron significativamente cuando la comunidad bacteriana se someti√≥ a los distintos tratamientos (entorno natural, oligotr√≥fico, deficiente en f√≥sforo y un tratamiento de fertilizaci√≥n).\nDe acuerdo con los resultados de este estudio, ¬øqu√© estrategia crees que utilizaron en este estudio?\n\n\n12.1.4 En Etherpad:\nSeg√∫n la importancia de los metadatos, ¬øqu√© otra informaci√≥n puedes recomendar agregar a la tabla de metadatos?\n\n\n\n\n\n\nNote\n\n\n\nNota:\nLos resultados de este estudio, las secuencias sin procesar y los metadatos se pueden encontrar en el SRA del NCBI y se almacenaron en el BioProject PRJEB22811.\n\n\n\n\n\n\n\n\nNote\n\n\n\nNota:\nOtras bases de datos metagen√≥micos p√∫blicas son: MG-RAST, MGnify, GM Repo, Marine Metagenomics Portal y Terrestrial Metagenome DB.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>12</span>¬† <span class='chapter-title'>Iniciando mi proyecto metagen√≥mico</span>"
    ]
  },
  {
    "objectID": "12Iniciandomiproyectometagenomico.html#referencias",
    "href": "12Iniciandomiproyectometagenomico.html#referencias",
    "title": "12¬† Iniciando mi proyecto metagen√≥mico",
    "section": "12.2 Referencias",
    "text": "12.2 Referencias\nEpisodios 2 y 3 (An√°lisis de control de calidad y filtrado de secuencias) son adaptaciones de los episodios correspondientes en la lecci√≥n/taller Data Wrangling and Processing for Genomics en The Carpentries.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>12</span>¬† <span class='chapter-title'>Iniciando mi proyecto metagen√≥mico</span>"
    ]
  },
  {
    "objectID": "13Controldecalidad.html",
    "href": "13Controldecalidad.html",
    "title": "13¬† Control de calidad",
    "section": "",
    "text": "13.0.1 Flujos de an√°lisis bioinform√°tico en metagen√≥mica\nAl trabajar con datos de secuenciaci√≥n, los reads/lecturas que obtienes del secuenciador deben pasar a trav√©s de varias herramientas para generar el resultado final deseado. La ejecuci√≥n de este conjunto de herramientas en un orden espec√≠fico se conoce como pipeline o flujo de an√°lisis.\nEstos pipelines adoptan un enfoque plug-and-play en el sentido de que el archivo de salida de uno de ellos es f√°cilmente convertido en archivo de salida para el siguiente.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>13</span>¬† <span class='chapter-title'>Control de calidad</span>"
    ]
  },
  {
    "objectID": "13Controldecalidad.html#referencias",
    "href": "13Controldecalidad.html#referencias",
    "title": "13¬† Control de calidad",
    "section": "13.1 Referencias",
    "text": "13.1 Referencias\nAqu√≠ puedes encontrar mayor informaci√≥n sobre cada una de las secciones del resultado de FastQC.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>13</span>¬† <span class='chapter-title'>Control de calidad</span>"
    ]
  },
  {
    "objectID": "14Filtraciondedatosdesecuenciacion.html",
    "href": "14Filtraciondedatosdesecuenciacion.html",
    "title": "14¬† Filtraci√≥n de datos de secuenciaci√≥n",
    "section": "",
    "text": "14.1 Limpieza de reads o lecturas\nPara lograr eliminar secuencias de baja calidad, utilizaremos un programa llamado¬†Trimmomatic¬†. Esta √∫til herramienta filtra las lecturas de baja calidad y elimina las bases de baja calidad de las muestras especificadas. Trimmomatic cuenta con diversas opciones para realizar su tarea. Si ejecutamos el siguiente comando, podemos ver algunas de sus opciones:\nEs fundamental comprender los pasos que utiliza para limpiar sus datos. En nuestro an√°lisis, solo utilizaremos algunas opciones y pasos de recorte. Para m√°s informaci√≥n sobre los argumentos y opciones de Trimmomatic, consulte¬†el manual de Trimmomatic¬†.\nSin embargo, un comando completo para Trimmomatic se parecer√° al siguiente. Este comando es un ejemplo y no funcionar√°, ya que no disponemos de los archivos a los que hace referencia:\nEn este ejemplo, le hemos dicho a Trimmomatic:",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>14</span>¬† <span class='chapter-title'>Filtraci√≥n de datos de secuenciaci√≥n</span>"
    ]
  },
  {
    "objectID": "14Filtraciondedatosdesecuenciacion.html#referencias",
    "href": "14Filtraciondedatosdesecuenciacion.html#referencias",
    "title": "14¬† Filtraci√≥n de datos de secuenciaci√≥n",
    "section": "14.3 Referencias",
    "text": "14.3 Referencias\nTrimmomatic",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>14</span>¬† <span class='chapter-title'>Filtraci√≥n de datos de secuenciaci√≥n</span>"
    ]
  },
  {
    "objectID": "15Ensamblemetagenomico.html",
    "href": "15Ensamblemetagenomico.html",
    "title": "15¬† Binning metagen√≥mico",
    "section": "",
    "text": "15.0.1 Binning o agrupamiento metagen√≥mico\nLos genomas originales de la muestra pueden separarse mediante un proceso denominado binning. Este proceso permite el an√°lisis por separado de cada especie del metagenoma, con suficientes lecturas para reconstruir un genoma. Los genomas reconstruidos a partir de ensambles metagen√≥micos se denominan MAG (Genomas Ensamblados por Metagenoma). En este proceso, los contigs ensamblados del metagenoma se asignan a diferentes bins (archivos FASTA que contienen ciertos contigs). Idealmente, cada bin corresponde a un solo genoma original (un MAG).\nAunque una forma obvia de separar contigs que corresponden a especies diferentes es mediante su asignaci√≥n taxon√≥mica, existen m√©todos m√°s confiables que realizan la clasificaci√≥n utilizando caracter√≠sticas de los contigs, como su contenido de GC, el uso de tetranucle√≥tidos (composici√≥n) o su cobertura (abundancia).\nMaxbin es un algoritmo de binning que distingue entre contigs que pertenecen a diferentes bins seg√∫n sus niveles de cobertura y las frecuencias de tetranucle√≥tidos que tienen.\nBinemos o agrupemos la muestra que acabamos de ensamblar. El comando para ejecutar MaxBin es¬†run_MaxBin.pl, y los argumentos que necesita son el archivo FASTA del ensamblado, el FASTQ con las lecturas forward y reverse, el directorio de salida y su nombre.\nParece imposible clasificar nuestro ensamblaje porque el n√∫mero de genes marcadores es menor que 1. Podr√≠amos haber esperado esto ya que sabemos que es una muestra peque√±a.\nRealizaremos el proceso de binning con la otra muestra del mismo estudio, que es m√°s grande. El ensamblaje est√° precalculado en el ~/dc-workshop/mags/directorio.\nTardar√° unos minutos en ejecutarse. Adem√°s, finalizar√° con un resultado como este:\nCon el .summaryarchivo, podemos ver r√°pidamente los contenedores que produjo MaxBin.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>15</span>¬† <span class='chapter-title'>Binning metagen√≥mico</span>"
    ]
  },
  {
    "objectID": "15Ensamblemetagenomico.html#referencias",
    "href": "15Ensamblemetagenomico.html#referencias",
    "title": "15¬† Binning metagen√≥mico",
    "section": "15.2 Referencias",
    "text": "15.2 Referencias\nArt√≠culo de CheckM",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>15</span>¬† <span class='chapter-title'>Binning metagen√≥mico</span>"
    ]
  },
  {
    "objectID": "16Binningmetagenomico.html",
    "href": "16Binningmetagenomico.html",
    "title": "16¬† Asignaci√≥n taxon√≥mica",
    "section": "",
    "text": "16.0.1 ¬øQu√© es la asignaci√≥n taxon√≥mica?\nUna asignaci√≥n taxon√≥mica es un proceso que consiste en asignar una Unidad Taxon√≥mica Operativa (OTU, es decir, grupos de individuos relacionados) a secuencias que pueden ser lecturas o contigs. Las secuencias se comparan con una base de datos construida a partir de genomas completos. Cuando una secuencia encuentra una coincidencia suficientemente buena en la base de datos, se asigna a la OTU correspondiente.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>16</span>¬† <span class='chapter-title'>Asignaci√≥n taxon√≥mica</span>"
    ]
  },
  {
    "objectID": "16Binningmetagenomico.html#referencias",
    "href": "16Binningmetagenomico.html#referencias",
    "title": "16¬† Asignaci√≥n taxon√≥mica",
    "section": "16.5 Referencias",
    "text": "16.5 Referencias",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>16</span>¬† <span class='chapter-title'>Asignaci√≥n taxon√≥mica</span>"
    ]
  },
  {
    "objectID": "17Asignaciontaxonomica.html",
    "href": "17Asignaciontaxonomica.html",
    "title": "17¬† Explorando la diversidad con librer√≠as de R",
    "section": "",
    "text": "17.1 Primera inmersi√≥n en la diversidad\nLa diversidad de especies, en su definici√≥n m√°s simple, es el n√∫mero de especies en un √°rea determinada y su abundancia relativa (uniformidad). Una vez que conocemos la composici√≥n taxon√≥mica de nuestros metagenomas, podemos realizar an√°lisis de diversidad. Aqu√≠ analizaremos las dos m√©tricas de diversidad m√°s utilizadas: la diversidad Œ± (dentro de un metagenoma) y la diversidad Œ≤ (entre metagenomas).\nEn el siguiente ejemplo, analizaremos los componentes Œ± y Œ≤ de la diversidad de un conjunto de datos de peces en tres lagos. La forma m√°s sencilla de calcular la diversidad Œ≤ es calcular las especies distintas entre dos lagos (sitios). Tomemos como ejemplo la diversidad entre el lago A y el lago B. El n√∫mero de especies en el lago A es 3. A esta cantidad, restaremos el n√∫mero de estas especies que se comparten con el lago B: 2. Por lo tanto, el n√∫mero de especies √∫nicas en el lago A en comparaci√≥n con el lago B es (3-2) = 1. A este n√∫mero, sumaremos el resultado de las mismas operaciones, pero ahora tomaremos el lago B como nuestro sitio de referencia. Al final, la diversidad Œ≤ entre el lago A y el lago B es (3-2) + (3-2) = 2. Este proceso puede repetirse, tomando cada par de lagos como los sitios de enfoque.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>17</span>¬† <span class='chapter-title'>Explorando la diversidad con librer√≠as de R</span>"
    ]
  },
  {
    "objectID": "17Asignaciontaxonomica.html#referencias",
    "href": "17Asignaciontaxonomica.html#referencias",
    "title": "17¬† Explorando la diversidad con librer√≠as de R",
    "section": "17.11 Referencias",
    "text": "17.11 Referencias\n√çndices de diversidad\n√çndice de diversidad de Simpson\nTypes of alpha diversity metrics in microbial NGS",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>17</span>¬† <span class='chapter-title'>Explorando la diversidad con librer√≠as de R</span>"
    ]
  },
  {
    "objectID": "18Exploraciondetaxonomiaconr.html",
    "href": "18Exploraciondetaxonomiaconr.html",
    "title": "18¬† An√°lisis de taxonom√≠a con R",
    "section": "",
    "text": "18.1 Creaci√≥n de tablas de linajes y asignaci√≥n\nPaquetes como Qiime2, MEGAN, Vegan o Phyloseq en R nos permiten analizar la diversidad y la abundancia mediante la manipulaci√≥n de datos de asignaci√≥n taxon√≥mica. En esta lecci√≥n, usaremos Phyloseq. Para ello, necesitamos generar una matriz de abundancia a partir de los archivos de salida de Kraken. Un programa muy utilizado para este prop√≥sito es kraken-biom.\nPara ello, podr√≠amos usar nuestra ya conocida terminal Bash, pero RStudio tiene una terminal integrada que usa el mismo lenguaje que aprendimos en las lecciones de l√≠nea de comandos, as√≠ que aprovech√©mosla. Abramos RStudio y vayamos a la pesta√±a Terminal en el panel inferior izquierdo.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>18</span>¬† <span class='chapter-title'>An√°lisis de taxonom√≠a con R</span>"
    ]
  },
  {
    "objectID": "18Exploraciondetaxonomiaconr.html#referencias",
    "href": "18Exploraciondetaxonomiaconr.html#referencias",
    "title": "18¬† An√°lisis de taxonom√≠a con R",
    "section": "18.4 Referencias",
    "text": "18.4 Referencias",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>18</span>¬† <span class='chapter-title'>An√°lisis de taxonom√≠a con R</span>"
    ]
  },
  {
    "objectID": "19Exploraciondediversidad.html",
    "href": "19Exploraciondediversidad.html",
    "title": "19¬† Control de calidad",
    "section": "",
    "text": "19.1 Primer acercamiento la diversidad\nLa diversidad de especies, en su definici√≥n m√°s simple, es el n√∫mero de especies en un √°rea determinada y su abundancia relativa. Una vez que conocemos la composici√≥n taxon√≥mica de nuestros metagenomas, podemos realizar an√°lisis de diversidad. Analizaremos las dos m√©tricas de diversidad m√°s utilizadas: la diversidad Œ± (dentro de un metagenoma) y la diversidad Œ≤ (entre metagenomas).\nEn el siguiente ejemplo, analizaremos los componentes Œ± y Œ≤ de la diversidad de un conjunto de datos de peces en tres lagos. La forma m√°s sencilla de calcular la diversidad Œ≤ es calcular las especies distintas entre dos lagos (sitios). Tomemos como ejemplo la diversidad entre el lago A y el lago B. El n√∫mero de especies en el lago A es 3. A esta cantidad, restaremos el n√∫mero de estas especies que se comparten con el lago B: 2. Por lo tanto, el n√∫mero de especies √∫nicas en el lago A en comparaci√≥n con el lago B es (3-2) = 1. A este n√∫mero, sumaremos el resultado de las mismas operaciones, pero ahora tomaremos el lago B como nuestro sitio de referencia. Al final, la diversidad Œ≤ entre el lago A y el lago B es (3-2) + (3-2) = 2. Este proceso puede repetirse, tomando cada par de lagos como los sitios de enfoque.\nSi quieres leer m√°s sobre diversidad te recomendamos este¬†art√≠culo¬†sobre el concepto de diversidad.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>19</span>¬† <span class='chapter-title'>Control de calidad</span>"
    ]
  },
  {
    "objectID": "19Exploraciondediversidad.html#referencias",
    "href": "19Exploraciondediversidad.html#referencias",
    "title": "19¬† Control de calidad",
    "section": "19.6 Referencias",
    "text": "19.6 Referencias",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>19</span>¬† <span class='chapter-title'>Control de calidad</span>"
    ]
  },
  {
    "objectID": "20Analisistaxonomico.html",
    "href": "20Analisistaxonomico.html",
    "title": "20¬† An√°lisis taxon√≥mico con RStudio",
    "section": "",
    "text": "20.1 Explora nuestras muestras en niveles taxon√≥micos espec√≠ficos\nCon la informaci√≥n de asignaci√≥n taxon√≥mica obtenida de Kraken, hemos medido la diversidad y visualizaci√≥n de los taxones de cada muestra con Krona y Pavian. Phyloseq nos permite una visualizaci√≥n m√°s flexible y personalizada. Ahora, usaremos Phyloseq para generar gr√°ficos de abundancia de los taxones de nuestras muestras.\nComenzaremos nuestra exploraci√≥n a nivel de filo. Para agrupar todas las OTU que comparten la misma taxonom√≠a en un rango taxon√≥mico determinado, utilizaremos la funci√≥n tax_glom().\nOtra funci√≥n de phyloseq es psmelt(), que combina objetos phyloseq en un data.frame para manipularlos con paquetes como ggplot2y vegan.\nAhora, creemos otro marco de datos con los datos originales. Esta estructura nos permitir√° comparar la abundancia absoluta con la relativa y obtener una visi√≥n completa de nuestras muestras.\nEstos objetos podemos compararlos con un gr√°fico\nAhora, creemos la figura para los datos con abundancias absolutas (es decir, absolute_plot objeto)\nCon el comando position=\"stack\", le indicamos a la ggplot que los valores deben apilarse para cada muestra. De esta manera, tendremos todas nuestras diferentes categor√≠as (OTU) apiladas en una barra, y no cada una en una separada. Para m√°s informaci√≥n, position_stack\nA continuaci√≥n, crearemos la figura para la representaci√≥n de los datos de abundancia relativa y le pediremos a RStudio que nos muestre ambas gr√°ficas gracias a la |funci√≥n de la biblioteca patchwork:\nDe inmediato, podemos observar la diferencia entre las dos gr√°ficas y c√≥mo el procesamiento de los datos puede mejorar la visualizaci√≥n de los resultados reales. Sin embargo, es evidente que tenemos demasiados taxones para distinguir adecuadamente el color de cada uno, y menos de los que presentan la mayor abundancia. Para solucionar esto, utilizaremos el poder de los marcos de datos y R. Modificaremos la identificaci√≥n de las OTU cuya abundancia relativa sea inferior al 0,2 %:\nPidamos a R que muestre las cifras nuevamente ejecutando nuevamente nuestro c√≥digo:",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>20</span>¬† <span class='chapter-title'>An√°lisis taxon√≥mico con RStudio</span>"
    ]
  },
  {
    "objectID": "20Analisistaxonomico.html#referencias",
    "href": "20Analisistaxonomico.html#referencias",
    "title": "20¬† An√°lisis taxon√≥mico con RStudio",
    "section": "20.3 Referencias",
    "text": "20.3 Referencias\nIntroducci√≥n a Phyloseq\nPhyloseq by Joey711",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>20</span>¬† <span class='chapter-title'>An√°lisis taxon√≥mico con RStudio</span>"
    ]
  },
  {
    "objectID": "21Otrosrecursos.html",
    "href": "21Otrosrecursos.html",
    "title": "21¬† Otros recursos",
    "section": "",
    "text": "21.0.1 Cuatro Ci√©negas\nM√°s informaci√≥n sobre 4 Ci√©negas est√° disponible en estos podcasts Oasis mexicano en el desierto y Oasis mexicano , en este Video de Cuatro Ci√©negas , y finalmente, el manuscrito Cuatro Ci√©negas .",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>21</span>¬† <span class='chapter-title'>Otros recursos</span>"
    ]
  },
  {
    "objectID": "21Otrosrecursos.html#referencias",
    "href": "21Otrosrecursos.html#referencias",
    "title": "21¬† Otros recursos",
    "section": "21.1 Referencias",
    "text": "21.1 Referencias\nMG-RAST",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>21</span>¬† <span class='chapter-title'>Otros recursos</span>"
    ]
  },
  {
    "objectID": "5Operacionesyexploraciondefastq.html#crear-mover-copiar-y-eliminar",
    "href": "5Operacionesyexploraciondefastq.html#crear-mover-copiar-y-eliminar",
    "title": "5¬† Trabajar con archivos y directorios",
    "section": "5.2 üõ†Ô∏è Crear, mover, copiar y eliminar",
    "text": "5.2 üõ†Ô∏è Crear, mover, copiar y eliminar\n\n\n\nComando\nQu√© hace\n\n\n\n\ncp origen dest\nCopia un archivo\n\n\nmkdir nombre\nCrea un directorio\n\n\nmv origen dest\nMueve o renombra (si dest es un archivo)\n\n\nrm archivo\nElimina un archivo\n\n\nrm -r directorio\nElimina un directorio y su contenido\n\n\n\nCuando trabajas con muchos archivos (o en un servidor remoto), usar la l√≠nea de comandos es m√°s r√°pido y seguro.\n\n\n5.2.1 Copiar archivos (cp)\n$ cd ~/dc_workshop/data/untrimmed_fastq\n$ cp JC1A_R2.fastq JC1A_R2-copy.fastq\n\n\n5.2.2 Crear directorios (mkdir)\n$ mkdir backup\n\n\n5.2.3 Mover y renombrar (mv)\nMover a carpeta:\n$ mv JC1A_R2-copy.fastq backup/\n$ ls backup\n# JC1A_R2-copy.fastq\nRenombrar:\n$ cd backup\n$ mv JC1A_R2-copy.fastq JC1A_R2-backup.fastq\n$ ls\n# JC1A_R2-backup.fastq\n\n\n5.2.4 Eliminar archivos y directorios (rm)\nEliminar archivo:\n\nrm archivo.txt\n\nEliminar carpeta recursivamente:\nrm -r backup",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>**Trabajar con archivos y directorios**</span>"
    ]
  },
  {
    "objectID": "6Redireccion.html#objetivos",
    "href": "6Redireccion.html#objetivos",
    "title": "6¬† Redirecci√≥n de Entrada y Salida",
    "section": "",
    "text": "Buscar patrones en archivos (grep).\nGuardar o a√±adir resultados a archivos (&gt;, &gt;&gt;).\nContar l√≠neas (wc -l).\nEncadenar comandos con tuber√≠as (|).\nAutomatizar con bucles for.\n6.1.1 Buscar patrones en archivos (grep).\n\n\n\n\n$ grep NNNNNNNNNN JC1A_R2.fastq\n\n\n\n-B1 ‚áí devuelve 1 l√≠nea antes de cada coincidencia (el identificador que empieza con @)\n-A2 ‚áí devuelve 2 l√≠neas despu√©s de cada coincidencia (la l√≠nea + y la cadena de calidad)\n\n\n$ grep -B1 -A2 NNNNNNNNNN JC1A_R2.fastq\n\n\n@MISEQ-LAB244-W7:91:000000000-A5C7L:1:2111:5300:24013 2:N:0:TCGAAG\nNNNNNNNNNNNCNANNANNNNNCGCCGGTGTTCTNCTGGGGNACGGANACCGAGTAGATCGGAACAGCGTCGTGGAGNGAAAGAGTGTAGATCCCGGTGGGCGGCGTATCATTAAAAAAAAAACCTGCTGGTCCTTGTCTC\n+\nAAA11BB3333BGG1GGEC1E?0E0B0BFDGFHD2FBH110A1BEE?A/BAFBDGH///&gt;FEGGG&gt;&lt;@/#//?#?/#//????########################################################################################################################################################################",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Redirecci√≥n de Entrada y Salida</span>"
    ]
  },
  {
    "objectID": "6Redireccion.html#redirigir-salida-a-un-archivo",
    "href": "6Redireccion.html#redirigir-salida-a-un-archivo",
    "title": "6¬† Redirecci√≥n de Entrada y Salida",
    "section": "6.2 Redirigir salida a un archivo",
    "text": "6.2 Redirigir salida a un archivo\nCuando usamos grep para extraer lecturas de un FASTQ con un patr√≥n (p.¬†ej. NNNNNNNNNN), toda la salida se imprime en pantalla. Para procesar esos resultados m√°s adelante, es mejor redirigirlos a un archivo en lugar de dejarlos volar por la terminal.\n\n\n6.2.1 1Ô∏è‚É£ Redirecci√≥n con &gt;\n\nEl operador &gt; toma la salida est√°ndar de un comando y la escribe en un fichero (sobrescribi√©ndolo si ya existe).\nEjemplo: copiar todas las lecturas (identificador, secuencia y calidad) con 10 N consecutivas a bad_reads.txt:\n$ grep -B1 -A2 'NNNNNNNNNN' JC1A_R2.fastq &gt; bad_reads.txt\n$ ls  bad_reads.txt\n6.2.2 Contar l√≠neas, palabras y caracteres con wc\n\nwc por s√≠ solo muestra tres valores:\n\nN√∫mero de l√≠neas\nN√∫mero de palabras\nN√∫mero de caracteres\n$ wc bad_reads.txt\n# Por ejemplo: \" 402  489 50076 bad_reads.txt\"\n\nSi solo quieres el n√∫mero de l√≠neas (por ejemplo, para saber cu√°ntas lecturas capturaste), usa -l:\n$ wc -l bad_reads.txt\n# Por ejemplo: \"402 bad_reads.txt\"",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Redirecci√≥n de Entrada y Salida</span>"
    ]
  },
  {
    "objectID": "6Redireccion.html#evitar-sobrescritura-y-usar-tuber√≠as",
    "href": "6Redireccion.html#evitar-sobrescritura-y-usar-tuber√≠as",
    "title": "6¬† Redirecci√≥n de Entrada y Salida",
    "section": "6.3 Evitar sobrescritura y usar tuber√≠as",
    "text": "6.3 Evitar sobrescritura y usar tuber√≠as\n\n6.3.1 1Ô∏è‚É£ Sobreescribir (&gt;) vs Redirigir (&gt;&gt;)\n&gt; crea o sobrescribe el archivo de salida.\nSolo contiene resultados de JC1A_R1.fastq:\n$ grep -B1 -A2 'NNNNNNNNNN' JC1A_R1.fastq &gt; bad_reads.txt \n$ wc -l bad_reads.txt # ‚Üí 24 l√≠neas\n&gt;&gt; a√±ade al final del archivo sin borrar lo que ya hab√≠a.\nAhora a√±adimos de JC1A_R1.fastq sin borrar:\n$ grep -B1 -A2 'NNNNNNNNNN' JC1A_R1.fastq &gt;&gt; bad_reads.txt  \n$ wc -l bad_reads.txt  # ‚Üí 426 (402 + 24)\n\n\n6.3.2 Sin archivos intermedios: tuber√≠as (|)\nSi solo te interesa ver la salida o contar coincidencias, no necesitas crear bad_reads.txt. Usar pipes:\nVer con paginaci√≥n:\n$ grep -B1 -A2 'NNNNNNNNNN' JC1A_R2.fastq | less\nNavega con flechas o Space/b, sale con q.\nContar directamente:\n$ grep -B1 -A2 'NNNNNNNNNN' *.fastq | wc -l\nEsto te da el total de l√≠neas encontradas (divide entre 4 si quieres el n√∫mero de lecturas).",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Redirecci√≥n de Entrada y Salida</span>"
    ]
  },
  {
    "objectID": "6Redireccion.html#automatizar-tareas-con-bucles-for",
    "href": "6Redireccion.html#automatizar-tareas-con-bucles-for",
    "title": "6¬† Redirecci√≥n de Entrada y Salida",
    "section": "6.4 Automatizar tareas con bucles for",
    "text": "6.4 Automatizar tareas con bucles for\nLos bucles permiten repetir comandos sobre varios archivos sin volver a teclear cada uno.\n\n\n6.4.1 Sintaxis b√°sica\nfor variable in lista_de_elementos; \ndo \n# comandos usando \"$variable\"\ndone\n\n\n6.4.2 Ejemplo pr√°ctico\nGuardemos las dos primeras l√≠neas de cada archivo FASTQ en seq_info.txt:\nnos dirigimos a esta direcci√≥n $ cd ~/dc_workshop/data/untrimmed_fastq\n\n$ for filename in *.fastq\n&gt; do\n&gt; head -n 2 ${filename} &gt;&gt; seq_info.txt\n&gt; done\nfor filename in *.fastq; do head -n 2 \"${filename}\" &gt;&gt; seq_info.txt; done\nPara ver el contenido del peque√±o archivo que acabamos de crear es √∫til utilizar el catcomando.\ncat seq_info.txt\n\n\n\n\n\n\nOutput\n\n\n\n\n@MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:13417:1998 1:N:0:TCGNAG\nCTACGGCGCCATCGGCGNCCCCGGACGGTAGGAGACGGCGATGCTGGCCCTCGGCGCGGTCGCGTTCCTGAACCCCTGGCTGCTGGCGGCGCTCGCGGCGCTGCCGGTGCTCTGGGTGCTGCTGCGGGCGACGCCGCCGAGCCCGCGGCGGGTCGGATTCCCCGGCGTGCGCCCCCCGCTCCGGCTCGAGGACGCCGCACCGACGCCCCACCCCCCCCCCCGGTGGCTCCTCCTGCCGCCCTGCCTGATCC\n@MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:13417:1998 2:N:0:TCGNAG\nCGCGATCAGCAGCGGCCCGGAACCGGTCAGCCGCGCCNTGGGGTTCAGCACCGGCNNGGCGAAGGCCGCGATCGCGGCGGCGGCGATCAGGCAGCGCAGCAGCAGGAGCCACCAGGGCGTGCGGTCGGGCGTCCGTTCGGCGTCCTCGCGCCCCAGCAGCAGGCGCACGCCAGGGAATCCGACCCGCCGCCGGCTCGGCCGCGTCNCCCGCNCCCGCCCCCCGAGCACCCGNAGCCNCNCCACCGCCGCCC\n@MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:12622:2006 1:N:0:CTCAGA\nCCCGTTCCTCGGGCGTGCAGTCGGGCTTGCGGTCTGCCATGTCGTGTTCGGCGTCGGTGGTGCCGATCAGGGTGAAATCCGTCTCGTAGGGGATCGCGAAGATGATCCGCCCGTCCGTGCCCTGAAAGAAATAGCACTTGTCAGATCGGAAGAGCACACGTCTGAACTCCAGTCACCTCAGAATCTCGTATGCCGTCTTCTGCTTGAAAAAAAAAAAAGCAAACCTCTCACTCCCTCTACTCTACTCCCTT\n@MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:12622:2006 2:N:0:CTCAGA\nGACAAGTGCTATTTCTTTCAGGGCACGGACGGGCGGATCATCTTCGCGATCCCCTACGAGACGGATTTCACCCTGATCGGCACCACCGACGCCGAACACGACATGGCAGACCGCAAGCCCGACTGCACGCCCGAGGAACGGGAGATCGGAAGAGCGTCGTGTAGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATTAAAAAAAAAAAGCGATCAACTCGACCGACCTGTCTTATTATATCTCACGTAA\n\n\n\n\nfor filename in *.fastq ‚Üí recorre cada .fastq.\n\nfor: inicia un bucle.\nfilename: es el nombre de la variable que ir√° tomando un valor distinto en cada vuelta.\nin *.fastq: indica la ‚Äúlista de elementos‚Äù sobre la que vas a iterar ‚Äîen este caso, todos los archivos del directorio que acaben en .fastq.\n\nhead -n 2 \"$filename\" ‚Üí muestra las 2 primeras l√≠neas.\n&gt;&gt; seq_info.txt ‚Üí a√±ade esas l√≠neas al final del archivo.\ndone ‚Üí indica el fin del bucle.\ncat seq_info.txt ‚Üí muestra el contenido completo generado.\n\n\n\n\n6.4.3 ¬øPor qu√© usar &gt;&gt; y no &gt;?\n\n&gt; sobrescribe el fichero en cada iteraci√≥n, dejando solo el √∫ltimo resultado.\n&gt;&gt; a√±ade al final, acumulando la salida de todas las iteraciones.\n\n\nCon este patr√≥n puedes:\n\nDescomprimir muchos archivos (gunzip \"$f\").\nAplicar filtros o transformaciones a lotes de datos.\nExtraer estad√≠sticas en bloque.\n\nLos bucles for combinados con redirecci√≥n y comodines son una herramienta muy poderosa para procesar r√°pidamente grandes conjuntos de archivos de forma reproducible.",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Redirecci√≥n de Entrada y Salida</span>"
    ]
  },
  {
    "objectID": "6Redireccion.html#uso-de-basename-en-bucles-for",
    "href": "6Redireccion.html#uso-de-basename-en-bucles-for",
    "title": "6¬† Redirecci√≥n de Entrada y Salida",
    "section": "6.5 Uso de basename en bucles for",
    "text": "6.5 Uso de basename en bucles for\nbasename extrae el nombre ‚Äúbase‚Äù de un archivo, eliminando rutas y un sufijo com√∫n.\n\n\n6.5.1 Ejemplo sencillo\n$ basename JC1A_R2.fastq .fastq # ‚Üí JC1A_R2\nSi el sufijo no coincide (p.¬†ej. .fasta), devuelve el nombre completo:\n$ basename JC1A_R2.fastq .fasta # ‚Üí JC1A_R2.fastq",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Redirecci√≥n de Entrada y Salida</span>"
    ]
  },
  {
    "objectID": "14Filtraciondedatosdesecuenciacion.html#limpieza-de-reads-o-lecturas",
    "href": "14Filtraciondedatosdesecuenciacion.html#limpieza-de-reads-o-lecturas",
    "title": "14¬† Filtraci√≥n de datos de secuenciaci√≥n",
    "section": "",
    "text": "$ trimmomatic\nUsage:         \nPE [-version] [-threads &lt;threads&gt;] [-phred33|-phred64] [-trimlog &lt;trimLogFile&gt;] [-summary &lt;statsSummaryFile&gt;] [-quiet] [-validatePairs] [-basein &lt;inputBase&gt; | &lt;inputFile1&gt; &lt;inputFile2&gt;] [-baseout &lt;outputBase&gt; | &lt;outputFile1P&gt; &lt;outputFile1U&gt; &lt;outputFile2P&gt; &lt;outputFile2U&gt;] &lt;trimmer1&gt;...    or:         SE [-version] [-threads &lt;threads&gt;] [-phred33|-phred64] [-trimlog &lt;trimLogFile&gt;] [-summary &lt;statsSummaryFile&gt;] [-quiet] &lt;inputFile&gt; &lt;outputFile&gt; &lt;trimmer1&gt;...    or:         -version\n\n\n\n\n\n\n\n$ trimmomatic PE -threads 4 SRR_1056_1.fastq SRR_1056_2.fastq \\               SRR_1056_1.trimmed.fastq SRR_1056_1un.trimmed.fastq \\               SRR_1056_2.trimmed.fastq SRR_1056_2un.trimmed.fastq \\               ILLUMINACLIP:SRR_adapters.fa SLIDINGWINDOW:4:20 ILLUMINACLIP:TruSeq3-PE.fa:2:40:15\n\n\n\n\n\n\n\n\nc√≥digo\nsignificado\n\n\n\n\nPE\nque tomar√° un archivo de extremos emparejados como entrada\n\n\n-threads 4\nutilizar cuatro subprocesos inform√°ticos para ejecutar (esto acelerar√° nuestra ejecuci√≥n)\n\n\nSRR_1056_1.fastq\nEl primer nombre del archivo de entrada. Adelante\n\n\nSRR_1056_2.fastq\nel segundo nombre del archivo de entrada. Invertir\n\n\nSRR_1056_1.trimmed.fastq\nEl archivo de salida para los pares supervivientes del _1archivo\n\n\nSRR_1056_1un.trimmed.fastq\nEl archivo de salida para lecturas hu√©rfanas del _1archivo\n\n\nSRR_1056_2.trimmed.fastq\nEl archivo de salida para los pares supervivientes del _2archivo\n\n\nSRR_1056_2un.trimmed.fastq\nEl archivo de salida para lecturas hu√©rfanas del _2archivo\n\n\nILLUMINACLIP:SRR_adapters.fa\npara recortar los adaptadores Illumina del archivo de entrada utilizando las secuencias de adaptadores enumeradas enSRR_adapters.fa\n\n\nSLIDINGWINDOW:4:20\nutilizar una ventana deslizante de tama√±o 4 que eliminar√° las bases si su puntuaci√≥n Phred es inferior a 20\n\n\nILLUMINACLIP:TruSeq3-PE.fa:2:40:15\nbuscar los adaptadores en las lecturas usando el archivo TruSeq3-PE.fa, permitiendo hasta 2 errores en el alineamiento inicial, y que solo recorte si el alineamiento tiene una puntuaci√≥n m√≠nima de 15, evaluada con una puntuaci√≥n m√°xima de 40 para la coincidencia.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>14</span>¬† <span class='chapter-title'>Filtraci√≥n de datos de secuenciaci√≥n</span>"
    ]
  },
  {
    "objectID": "14Filtraciondedatosdesecuenciacion.html#ejecuci√≥n-de-trimmomatic",
    "href": "14Filtraciondedatosdesecuenciacion.html#ejecuci√≥n-de-trimmomatic",
    "title": "14¬† Filtraci√≥n de datos de secuenciaci√≥n",
    "section": "14.2 Ejecuci√≥n de trimmomatic",
    "text": "14.2 Ejecuci√≥n de trimmomatic\nAhora, ejecutaremos Trimmomatic en nuestros datos. Ve a la carpeta untrimmed_fastq y verifica que te encuentras en esa carpeta:\n$ cd ~/dc_workshop/data/untrimmed_fastq \n$ pwd \n$ /home/dcuser/dc_workshop/data/untrimmed_fastq \nDeber√≠a tener solo cuatro archivos en este directorio. Estos archivos corresponden a las lecturas forward y reverse de las muestras JC1A y JP4D.\n$ ls \n$ JC1A_R1.fastq.gz  JC1A_R2.fastq.gz  JP4D_R1.fastq  JP4D_R2.fastq.gz  TruSeq3-PE.fa \nPara poder correr Trimmomatic los archivos deben estar comprimidos usando gzip\n$ trimmomatic PE JP4D_R1.fastq.gz JP4D_R2.fastq.gz \\ JP4D_R1.trim.fastq.gz  JP4D_R1un.trim.fastq.gz \\ JP4D_R2.trim.fastq.gz  JP4D_R2un.trim.fastq.gz \\ SLIDINGWINDOW:4:20 MINLEN:35 ILLUMINACLIP:TruSeq3-PE.fa:2:40:15 \nEn la pantalla podemos ver un resumen del resultado, centr√°ndonos en el porcentaje de lecturas descartadas (Dropped) y lecturas que se mantuvieron para ambas forward y reverse (Both surviving).\nTrimmomaticPE: Started with arguments:  JP4D_R1.fastq.gz JP4D_R2.fastq.gz JP4D_R1.trim.fastq.gz JP4D_R1un.trim.fastq.gz JP4D_R2.trim.fastq.gz JP4D_R2un.trim.fastq.gz SLIDINGWINDOW:4:20 MINLEN:35 ILLUMINACLIP:TruSeq3-PE.fa:2:40:15 Multiple cores found: Using 2 threads Using PrefixPair: 'TACACTCTTTCCCTACACGACGCTCTTCCGATCT' and 'GTGACTGGAGTTCAGACGTGTGCTCTTCCGATCT' ILLUMINACLIP: Using 1 prefix pairs, 0 forward/reverse sequences, 0 forward only sequences, 0 reverse only sequences Quality encoding detected as phred33 Input Read Pairs: 1123987 Both Surviving: 751427 (66.85%) Forward Only Surviving: 341434 (30.38%) Reverse Only Surviving: 11303 (1.01%) Dropped: 19823 (1.76%) TrimmomaticPE: Completed successfully\nLos archivos de salida tambi√©n son archivos FASTQ. Deber√≠an ser m√°s peque√±os que el archivo de entrada, ya que hemos eliminado las lecturas. Podemos confirmarlo con este comando:\n$ ls JP4D* -l -h \n-rw-r--r-- 1 dcuser dcuser 179M Nov 26 12:44 JP4D_R1.fastq.gz -rw-rw-r-- 1 dcuser dcuser 107M Mar 11 23:05 JP4D_R1.trim.fastq.gz \n-rw-rw-r-- 1 dcuser dcuser  43M Mar 11 23:05 JP4D_R1un.trim.fastq.gz \n-rw-r--r-- 1 dcuser dcuser 203M Nov 26 12:51 JP4D_R2.fastq.gz -rw-rw-r-- 1 dcuser dcuser 109M Mar 11 23:05 JP4D_R2.trim.fastq.gz \n-rw-rw-r-- 1 dcuser dcuser 1.3M Mar 11 23:05 JP4D_R2un.trim.fastq.gz\nAcabamos de ejecutar Trimmomatic con √©xito en uno de nuestros archivos FASTQ. Sin embargo, tenemos malas noticias. Trimmomatic solo puede operar con una muestra a la vez, y tenemos m√°s de una. La buena noticia es que podemos usar un¬†forbucle para iterar r√°pidamente entre nuestros archivos de muestra.\n$ for infile in *_R1.fastq.gz \ndo \nbase=$(basename ${infile} _R1.fastq.gz) \ntrimmomatic PE ${infile} ${base}_R2.fastq.gz \\ \n${base}_R1.trim.fastq.gz ${base}_R1un.trim.fastq.gz \\ ${base}_R2.trim.fastq.gz ${base}_R2un.trim.fastq.gz \\ SLIDINGWINDOW:4:20 MINLEN:35 ILLUMINACLIP:TruSeq3-PE.fa:2:40:15 done \nObserva que, aunque ejecutamos Trimmomatic en el archivo¬†JP4Dantes de ejecutar el bucle for, solo hay un conjunto de archivos para √©l. Como coincidimos con la terminaci√≥n¬†_R1.fastq.gz, volvimos a ejecutar Trimmomatic en este archivo, sobrescribiendo nuestros primeros resultados. Esto est√° bien, pero es bueno tener en cuenta que ocurri√≥.\n ls \nJC1A_R1.fastq.gz                     JP4D_R1.fastq.gz         JC1A_R1.trim.fastq.gz                JP4D_R1.trim.fastq.gz    JC1A_R1un.trim.fastq.gz              JP4D_R1un.trim.fastq.gz  JC1A_R2.fastq.gz                     JP4D_R2.fastq.gz         JC1A_R2.trim.fastq.gz                JP4D_R2.trim.fastq.gz    JC1A_R2un.trim.fastq.gz              JP4D_R2un.trim.fastq.gz  TruSeq3-PE.fa  \n¬°Hemos completado los pasos de recorte y filtrado de nuestro proceso de control de calidad! Antes de continuar, transfiramos nuestros archivos FASTQ recortados a un nuevo subdirectorio dentro de nuestro directorio data/.\n$ cd ~/dc_workshop/data/untrimmed_fastq \n$ mkdir ../trimmed_fastq \n$ mv *.trim* ../trimmed_fastq $ cd ../trimmed_fastq $ ls \nJC1A_R1.trim.fastq.gz    JP4D_R1.trim.fastq.gz                 JC1A_R1un.trim.fastq.gz  JP4D_R1un.trim.fastq.gz               JC1A_R2.trim.fastq.gz    JP4D_R2.trim.fastq.gz                 JC1A_R2un.trim.fastq.gz  JP4D_R2un.trim.fastq.gz  \n\n\n\n\n\n\nTip de double check! Prueba de calidad despu√©s del filtrado\n\n\n\nPuedes reanalizar los archivos que acabas de filtrar, deber√≠an tener un mejor desempe√±o en las pruebas realizadas por FASTQC",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>14</span>¬† <span class='chapter-title'>Filtraci√≥n de datos de secuenciaci√≥n</span>"
    ]
  },
  {
    "objectID": "15Ensamblemetagenomico.html#control-de-calidad",
    "href": "15Ensamblemetagenomico.html#control-de-calidad",
    "title": "15¬† Binning metagen√≥mico",
    "section": "15.1 Control de calidad",
    "text": "15.1 Control de calidad\nLa calidad de un MAG depende en gran medida del tama√±o del genoma de la especie, su abundancia en la comunidad y la profundidad de su secuenciaci√≥n. Dos aspectos importantes que se pueden medir para determinar su calidad son la integridad (¬øes el MAG un genoma completo?) y si est√° contaminado (¬øcontiene el MAG solo un genoma?).\nCheckM es una herramienta que evalua la calidad de nuestros MAGs. Mide la integridad y la contaminaci√≥n mediante el recuento de genes marcadores en los MAG. El flujo de trabajo de CheckM coloca los bins en un √°rbol de referencia para determinar a qu√© linaje corresponde y utilizar los genes marcadores adecuados para estimar los par√°metros de calidad. Desafortunadamente, el flujo de trabajo de linaje consume mucha memoria, por lo que no puede ejecutarse en nuestros equipos. Sin embargo, podemos indicarle a CheckM que utilice solo genes marcadores de bacterias para reducir el consumo de memoria. Este m√©todo es menos preciso, pero tambi√©n puede ser ventajoso si desea analizar todos sus bins con los mismos marcadores.\nEjecutaremos el flujo de trabajo de taxonom√≠a especificando el uso de marcadores a nivel de dominio, espec√≠fico para el rango Bacteria, especificaremos que nuestros bins est√°n en formato FASTA, que est√°n ubicados en el directorio MAXBINy que queremos nuestra salida en el directorio CHECKM/.\n$ mkdir CHECKM \n$ checkm taxonomy_wf domain Bacteria -x fasta MAXBIN/ CHECKM/ \nhe run will end with our results printed in the console.\n--------------------------------------------------------------------------------------------------------------------------------------------------------   Bin Id     Marker lineage   # genomes   # markers   # marker sets   0    1    2    3    4   5+   Completeness   Contamination   Strain heterogeneity   --------------------------------------------------------------------------------------------------------------------------------------------------------   \nJP4D.002      Bacteria         5449        104            58        3    34   40   21   5   1       94.83           76.99              11.19             \nJP4D.004      Bacteria         5449        104            58        12   40   46   6    0   0       87.30           51.64               3.12             \nJP4D.001      Bacteria         5449        104            58        24   65   11   3    1   0       70.48           13.09               0.00             \nJP4D.003      Bacteria         5449        104            58        44   49   11   0    0   0       64.44           10.27               0.00           --------------------------------------------------------------------------------------------------------------------------------------------------------\nPodemos ejecutar el paso de calidad de CheckM checkm qa y hacer que imprima la salida en una TSVtabla en lugar de la consola. En este paso, podemos solicitar a CheckM que nos proporcione m√°s par√°metros, como el n√∫mero y la longitud del contig.\nIdealmente, nos gustar√≠a obtener solo un contig por bin, con una longitud similar al tama√±o del genoma de los taxones correspondientes. Dado que este escenario es complejo de obtener, podemos usar par√°metros que muestran la calidad de nuestro ensamblaje. Por ejemplo el N50, el cual es una m√©trica que se utiliza para describir la completitud del ensamble de un genoma. ¬øQu√© es N50?‚Äù\nPara obtener la tabla con estos par√°metros extras, necesitamos especificar el archivo de los marcadores que CheckM utiliz√≥ en el paso anterior Bacteria.ms, el nombre del archivo de salida que queremos quality_JP4D.tsv, que queremos una tabla --tab_table, y la opci√≥n n√∫mero 2 -o 2es solicitar los par√°metros extras impresos en la tabla.\n$  checkm qa CHECKM/Bacteria.ms CHECKM/ --file CHECKM/quality_JP4D.tsv --tab_table -o 2 \nLa tabla que acabamos de crear se ve as√≠. Ser√° muy √∫til cuando necesites documentar o comunicar tu trabajo.\nLa cuesti√≥n de cu√°nta contaminaci√≥n podemos tolerar y cu√°nta completitud necesitamos ciertamente depende de la cuesti√≥n cient√≠fica que se est√© abordando, pero en el art√≠culo de CheckM hay algunos par√°metros que podemos seguir.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>15</span>¬† <span class='chapter-title'>Binning metagen√≥mico</span>"
    ]
  },
  {
    "objectID": "16Binningmetagenomico.html#usando-kraken-2",
    "href": "16Binningmetagenomico.html#usando-kraken-2",
    "title": "16¬† Asignaci√≥n taxon√≥mica",
    "section": "16.1 Usando Kraken 2",
    "text": "16.1 Usando Kraken 2\nKraken 2 es la versi√≥n m√°s nueva de Kraken, un sistema de clasificaci√≥n taxon√≥mica que utiliza coincidencias exactas de k-mer para lograr una alta precisi√≥n y velocidades de clasificaci√≥n r√°pidas. kraken2ya est√° instalado en el entorno de metagen√≥mica , echemos un vistazo a kraken2la ayuda.\n$ kraken2  --help \nNeed to specify input filenames! Usage: kraken2 [options] &lt;filename(s)&gt;  Options:   --db NAME               Name for Kraken 2 DB                           (default: none)   --threads NUM           Number of threads (default: 1)   --quick                 Quick operation (use first hit or hits)   --unclassified-out FILENAME                           Print unclassified sequences to filename   --classified-out FILENAME                           Print classified sequences to filename   --output FILENAME       Print output to filename (default: stdout); \"-\" will                           suppress normal output   --confidence FLOAT      Confidence score threshold (default: 0.0); must be                           in [0, 1].   --minimum-base-quality NUM                           Minimum base quality used in classification (def: 0,                           only effective with FASTQ input).   --report FILENAME       Print a report with aggregate counts/clade to file   --use-mpa-style         With --report, format report output like Kraken 1's                           kraken-mpa-report   --report-zero-counts    With --report, report counts for ALL taxa, even if                           counts are zero   --report-minimizer-data With --report, report minimizer, and distinct minimizer                           count information in addition to normal Kraken report   --memory-mapping        Avoids loading database into RAM   --paired                The filenames provided have paired-end reads   --use-names             Print scientific names instead of just taxids   --gzip-compressed       Input files are compressed with gzip   --bzip2-compressed      Input files are compressed with bzip2   --minimum-hit-groups NUM                           Minimum number of hit groups (overlapping k-mers                           sharing the same minimizer) needed to make a call                           (default: 2)   --help                  Print this message   --version               Print version information  If none of the *-compressed flags are specified, and the filename provided is a regular file, automatic format detection is attempted.  \nEn la ayuda, vemos que, adem√°s de nuestros archivos de entrada, tambi√©n necesitamos una base de datos para compararlos. La base de datos que utilice determinar√° el resultado que obtenga. Imagine que busca un linaje recientemente descubierto que no forma parte de las bases de datos disponibles. ¬øLo encontrar√≠a?\nExisten varias bases de datos compatibles para ser utilizadas con kraken2 en el proceso de asignaci√≥n taxon√≥mica.\nDesafortunadamente, incluso la base de datos m√°s peque√±a de Kraken, Minikraken, que requiere 8 GB de RAM libre, no es lo suficientemente peque√±a para las m√°quinas que usamos, por lo que no podremos ejecutarlakraken2 . Podemos comprobar nuestra RAM disponible con free -hpara asegurarnos.\n$ free -h \n              total        used        free      shared  buff/cache   available Mem:           3.9G        272M        3.3G         48M        251M        3.3G Swap:            0B          0B          0B \n\n16.1.1 Asignaci√≥n taxon√≥mica de lecturas metagen√≥micas\nComo hemos aprendido, las asignaciones taxon√≥micas pueden intentarse antes del ensamblaje. En este caso, usar√≠amos archivos FASTQ como entrada, que ser√≠an JP4D_R1.trim.fastq.gzy JP4D_R2.trim.fastq.gz. Y las salidas ser√≠an dos archivos: el informe JP4D.reporty el archivo Kraken JP4D.kraken.\nPara ejecutar kraken2, usar√≠amos un comando como este:\nNo es necesario ejecutar esto\n$ mkdir TAXONOMY_READS $ kraken2 --db kraken-db --threads 8 --paired JP4D_R1.trim.fastq.gz JP4D_R2.trim.fastq.gz --output TAXONOMY_READS/JP4D.kraken --report TAXONOMY_READS/JP4D.report \nComo no podemos ejecutarlo kraken2aqu√≠, precalculamos sus resultados en un servidor, es decir, en una m√°quina m√°s potente. En el servidor, ejecutamos kraken2y obtuvimos [ JP4D-kraken.krakeny] JP4D.report.\nVeamos las salidas precalculadas kraken2para nuestras lecturas JP4D.\nhead ~/dc_workshop/taxonomy/JP4D.kraken   \nU   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:19691:2037   0   250|251 0:216 |:| 0:217 U   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:14127:2052   0   250|238 0:216 |:| 0:204 U   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:14766:2063   0   251|251 0:217 |:| 0:217 C   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:15697:2078   2219696 250|120 0:28 350054:5 1224:2 0:1 2:5 0:77 2219696:5 0:93 |:| 379:4 0:82 U   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:15529:2080   0   250|149 0:216 |:| 0:115 U   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:14172:2086   0   251|250 0:217 |:| 0:216 U   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:17552:2088   0   251|249 0:217 |:| 0:215 U   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:14217:2104   0   251|227 0:217 |:| 0:193 C   MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:15110:2108   2109625 136|169 0:51 31989:5 2109625:7 0:39 |:| 0:5 74033:2 31989:5 1077935:1 31989:7 0:7 60890:2 0:105 2109625:1 C MISEQ-LAB244-W7:156:000000000-A80CV:1:1101:19558:2111   119045  251|133 0:18 1224:9 2:5 119045:4 0:181 |:| 0:99 \nEsta informaci√≥n podr√≠a necesitar aclaraci√≥n. Consultemos nuestra hoja de referencia para comprender algunos de sus componentes:\n\n\n\n\n\n\n\nEjemplo de columna\nDescripci√≥n\n\n\n\n\ndo\nClasificado o no clasificado\n\n\nMISEQ-LAB244-W7:156:000000000-A80CV:1:1101:15697:2078\nEncabezado FASTA de la secuencia\n\n\n2219696\nIdentificaci√≥n fiscal\n\n\n250:120\nLongitud de lectura\n\n\n0:28 350054:5 1224:2 0:1 2:5 0:77 2219696:5 0:93 379:4 0:82\nLos kmers coinciden con un ID taxon√≥mico , p.¬†ej., el ID fiscal 350054 tiene cinco coincidencias, el ID fiscal 1224 tiene dos coincidencias, etc.\n\n\n\nEl archivo Kraken podr√≠a ser m√°s legible. Analicemos el archivo del informe:\nhead ~/dc_workshop/taxonomy/JP4D.report \n 78.13  587119  587119  U   0   unclassified  21.87 164308  1166    R   1   root  21.64 162584  0   R1  131567    cellular organisms  21.64 162584  3225    D   2       Bacteria  18.21 136871  3411    P   1224          Proteobacteria  14.21 106746  3663    C   28211           Alphaproteobacteria   7.71  57950   21  O   204455            Rhodobacterales   7.66    57527   6551    F   31989               Rhodobacteraceae   1.23 9235    420 G   1060                  Rhodobacter   0.76    5733    4446    S   1063                    Rhodobacter sphaeroides \n\n\n\n\n\n\n\nEjemplo de columna\nDescripci√≥n\n\n\n\n\n78.13\nPorcentaje de lecturas cubiertas por el clado enraizado en este tax√≥n\n\n\n587119\nN√∫mero de lecturas cubiertas por el clado enraizado en este tax√≥n\n\n\n587119\nN√∫mero de lecturas asignadas directamente a este tax√≥n\n\n\nT√∫\nUn c√≥digo de rango que indica (Sin)clasificar, (Dominio), (Reino), (Filo), (Clase), (Orden), (Familia), (G√©nero) o (Especie. Todos los dem√°s rangos se indican simplemente con ‚Äò-‚Äô.\n\n\n0\nIdentificaci√≥n de taxonom√≠a del NCBI\n\n\nsin clasificar\nNombre cient√≠fico con sangr√≠a\n\n\n\n\n\n16.1.2 Asignaci√≥n taxon√≥mica de los contigs de un MAG\nAhora tenemos la identidad taxon√≥mica de las lecturas de todo el metagenoma, pero necesitamos saber a qu√© tax√≥n corresponden nuestros MAG. Para ello, debemos realizar la asignaci√≥n taxon√≥mica con sus contigs en lugar de sus lecturas, ya que no disponemos de las lecturas correspondientes a un MAG separadas de las lecturas de toda la muestra.\nPara esto, kraken2es un poco diferente; aqu√≠ podemos ver el comando para el JP4D.001.fastaMAG:\nNo es necesario ejecutar esto\n$ mkdir TAXONOMY_MAG $ kraken2 --db kraken-db --threads 12 -input JP4D.001.fasta --output TAXONOMY_MAG/JP4D.001.kraken --report TAXONOMY_MAG/JP4D.001.report \nLos resultados de esto se calculan previamente en el ~/dc_workshop/taxonomy/mags_taxonomy/directorio.\n$ cd ~/dc_workshop/taxonomy/mags_taxonomy $ ls \nJP4D.001.kraken JP4D.001.report \nmore ~/dc_workshop/taxonomy/mags_taxonomy/JP4D.001.report \n 50.96  955 955 U   0   unclassified  49.04 919 1   R   1   root  48.83 915 0   R1  131567    cellular organisms  48.83 915 16  D   2       Bacteria  44.40 832 52  P   1224          Proteobacteria  19.37 363 16  C   28216           Betaproteobacteria  16.22   304 17  O   80840             Burkholderiales   5.66    106 12  F   506             Alcaligenaceae   2.72   51  3   G   517               Bordetella   1.12 21  21  S   2163011                 Bordetella sp. HZ20   .   .   . \nAl examinar el informe, observamos que la mitad de los contigs no est√°n clasificados y que a una peque√±a proporci√≥n se les ha asignado una OTU. Este resultado es extra√±o, ya que esper√°bamos encontrar solo un genoma en el bin.\nPara ejemplificar c√≥mo deber√≠a ser un informe de un MAG completo y no contaminado, veamos el informe de este MAG de otro estudio:\n100.00  108 0   R   1   root 100.00 108 0   R1  131567    cellular organisms 100.00 108 0   D   2       Bacteria 100.00 108 0   P   1224          Proteobacteria 100.00 108 0   C   28211           Alphaproteobacteria 100.00  108 0   O   356           Rhizobiales 100.00    108 0   F   41294               Bradyrhizobiaceae 100.00    108 0   G   374               Bradyrhizobium 100.00 108 108 S   2057741                 Bradyrhizobium sp. SK17",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>16</span>¬† <span class='chapter-title'>Asignaci√≥n taxon√≥mica</span>"
    ]
  },
  {
    "objectID": "16Binningmetagenomico.html#visualizaci√≥n-de-los-resultados-de-la-asignaci√≥n-taxon√≥mica",
    "href": "16Binningmetagenomico.html#visualizaci√≥n-de-los-resultados-de-la-asignaci√≥n-taxon√≥mica",
    "title": "16¬† Asignaci√≥n taxon√≥mica",
    "section": "16.2 Visualizaci√≥n de los resultados de la asignaci√≥n taxon√≥mica",
    "text": "16.2 Visualizaci√≥n de los resultados de la asignaci√≥n taxon√≥mica\nTras asignar la taxonom√≠a, a continuaci√≥n se presenta una visualizaci√≥n de nuestros resultados. Krona es un software de visualizaci√≥n de datos jer√°rquico. Krona permite explorar los datos con zoom y gr√°ficos circulares multicapa, y es compatible con diversas herramientas bioinform√°ticas y formatos de datos sin procesar. Para usar Krona en nuestros resultados, primero accedamos a nuestro directorio de taxonom√≠a, que contiene los resultados precalculados de Kraken.\n\n16.2.1 Corona\nCon Krona, exploraremos la taxonom√≠a del JP4D.001 MAG.\n$ cd ~/dc_workshop/taxonomy/mags_taxonomy \nKrona se llama con el ktImportTaxonomycomando que requiere un archivo de entrada y uno de salida.\nEn nuestro caso, crearemos el archivo de entrada con las columnas tres y cuatro del JP4D.001.krakenarchivo.\n$ cut -f2,3 JP4D.001.kraken &gt; JP4D.001.krona.input \nAhora llamamos a Krona en nuestro JP4D.001.krona.inputarchivo y guardamos los resultados en formato JP4D.001.krona.out.html.\n$ ktImportTaxonomy JP4D.001.krona.input -o JP4D.001.krona.out.html \nLoading taxonomy... Importing JP4D.001.krona.input...    [ WARNING ]  The following taxonomy IDs were not found in the local database and were set to root                 (if they were recently added to NCBI, use updateTaxonomy.sh to update the local                 database): 1804984 2109625 2259134 \nY finalmente, abra otra terminal en su computadora local, descargue la salida de Krona y √°brala en un navegador.\n$ scp dcuser@ec2-3-235-238-92.compute-1.amazonaws.com:~/dc_workshop/taxonomy/JP4D.001.krona.out.html .  \nVer√°s una p√°gina como √©sta:\n\n\n\n\n\n\n\n16.2.2 Pav√≠a\nPavian es otra herramienta de visualizaci√≥n que permite comparar m√∫ltiples muestras. Pavian debe instalarse localmente y requiere R y Shiny, pero podemos probar el sitio web de demostraci√≥n de Pavian para visualizar nuestros resultados.\nPrimero, necesitamos descargar los archivos necesarios como entrada en Pavian; en esta ocasi√≥n, visualizaremos la asignaci√≥n de las lecturas de ambas muestras: JC1A.reporty JP4D.report.\nEstos archivos corresponden a nuestros informes de Kraken. De nuevo en nuestra m√°quina local, usemos el scpcomando.\n$ scp dcuser@ec2-3-235-238-92.compute-1.amazonaws.com:~/dc_workshop/taxonomy/*report .  \nAccedemos al sitio web de demostraci√≥n de Pavian , hacemos clic en ‚ÄúExplorar‚Äù y seleccionamos nuestros informes. Debe seleccionar ambos informes a la vez.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>16</span>¬† <span class='chapter-title'>Asignaci√≥n taxon√≥mica</span>"
    ]
  },
  {
    "objectID": "16Binningmetagenomico.html#section",
    "href": "16Binningmetagenomico.html#section",
    "title": "16¬† Asignaci√≥n taxon√≥mica",
    "section": "16.3 ",
    "text": "16.3",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>16</span>¬† <span class='chapter-title'>Asignaci√≥n taxon√≥mica</span>"
    ]
  },
  {
    "objectID": "16Binningmetagenomico.html#section-1",
    "href": "16Binningmetagenomico.html#section-1",
    "title": "16¬† Asignaci√≥n taxon√≥mica",
    "section": "16.4 ",
    "text": "16.4 \n\n16.4.1 Lecturas no clasificadas\nComo puede ver, un porcentaje de nuestros datos no pudo asignarse a una OTU espec√≠fica.\n¬øQu√© factores pueden afectar la asignaci√≥n taxon√≥mica para que una lectura no se clasifique?\nLas lecturas no clasificadas¬†pueden ser el resultado de diferentes factores que pueden ir desde errores de secuenciaci√≥n hasta problemas con el algoritmo que se utiliza para generar el resultado. Las plataformas de secuenciaci√≥n de pr√≥xima generaci√≥n (NGS) ampliamente utilizadas mostraron una¬†tasa de error promedio de 0,24 ¬± 0,06 % por base¬†. Adem√°s del error de secuenciaci√≥n, debemos considerar el estado de la base de datos que se utiliza para realizar la asignaci√≥n taxon√≥mica.\nTodos los genomas caracterizados obtenidos por diferentes grupos de investigaci√≥n se encuentran dispersos en diferentes repositorios, p√°ginas y bancos en la nube. Algunos a√∫n no se han publicado. Las bases de datos incompletas pueden afectar el rendimiento de la asignaci√≥n taxon√≥mica. Imagine que la OTU dominante en su muestra pertenece a un linaje que nunca se ha caracterizado y no tiene un genoma p√∫blico disponible para ser utilizado como plantilla para la base de datos. Esta posibilidad hace que la asignaci√≥n sea una tarea imposible y puede promover la generaci√≥n de falsos positivos porque el algoritmo asignar√° una identidad diferente a todas esas lecturas.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>16</span>¬† <span class='chapter-title'>Asignaci√≥n taxon√≥mica</span>"
    ]
  },
  {
    "objectID": "17Asignaciontaxonomica.html#primera-inmersi√≥n-en-la-diversidad",
    "href": "17Asignaciontaxonomica.html#primera-inmersi√≥n-en-la-diversidad",
    "title": "17¬† Explorando la diversidad con librer√≠as de R",
    "section": "",
    "text": "Diversidad Œ±: Puede representarse √∫nicamente como riqueza ( es decir, el n√∫mero de especies diferentes en un entorno), o tambi√©n puede medirse considerando la abundancia de las especies en el entorno ( es decir, el n√∫mero de individuos de cada especie en el entorno). Para medir la diversidad Œ±, utilizamos √≠ndices como el de Shannon, el de Simpson, el de Chao1, etc.\n\n\n\n\n\n\n\nLa diversidad Œ≤ es la diferencia (medida como distancia) entre dos o m√°s entornos. Puede medirse con m√©tricas como la disimilitud de Bray-Curtis, la distancia de Jaccard o la distancia Unifrac, por nombrar algunas. Cada una de estas medidas se centra en una caracter√≠stica de la comunidad ( p.¬†ej., la distancia Unifrac mide la relaci√≥n filogen√©tica entre las especies de la comunidad).",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>17</span>¬† <span class='chapter-title'>Explorando la diversidad con librer√≠as de R</span>"
    ]
  },
  {
    "objectID": "17Asignaciontaxonomica.html#diversidad-Œ±",
    "href": "17Asignaciontaxonomica.html#diversidad-Œ±",
    "title": "17¬† Explorando la diversidad con librer√≠as de R",
    "section": "17.2 diversidad Œ±",
    "text": "17.2 diversidad Œ±\n\n\n\n\n\n\n\n√çndices de diversidad\nDescripci√≥n\n\n\n\n\nShannon (H)\nEstimaci√≥n de la riqueza y la uniformidad de especies. Mayor importancia para la riqueza.\n\n\nSimpson (D)\nEstimaci√≥n de la riqueza y la uniformidad de especies. Mayor importancia para la uniformidad.\n\n\nCaos1\nAbundancia basada en especies representadas por un solo individuo (singletons) y dos individuos (doubletons).\n\n\n\n\nShannon (H):\n\n\n\n\nVariable\nDefinici√≥n\n\n\n\n\nH= ‚àí‚àëSyo = 1pagienpagiH=‚àí‚àëi=1Spagien‚Å°pagi\nDefinici√≥n\n\n\nSS\nN√∫mero de OTU\n\n\npagipagi\nLa proporci√≥n de la comunidad representada por OTU i\n\n\n\n\nSimpson (D)\n\n\n\n\nVariable\nDefinici√≥n\n\n\n\n\nD =1‚àëSyo = 1pag2iD=1‚àëi=1Spagi2\nDefinici√≥n\n\n\nSS\nN√∫mero total de especies en la comunidad\n\n\npagipagi\nProporci√≥n de la comunidad representada por OTU i\n\n\n\n\nCaos1\n\n\n\n\n\n\n\n\nVariable\nDefinici√≥n\n\n\n\n\nSc h a o 1=SObs‚Äã‚Äã+F1√ó (F1‚àí 1 )2 √ó (F2+ 1 )Sdohao1=SOhbs+F1√ó(F1‚àí1)2√ó(F2+1)\nRecuento de singletons y doubletons respectivamente\n\n\nF1,F2F1,F2\nRecuento de singletons y doubletons respectivamente\n\n\nSc h a o 1=SObs‚Äã‚ÄãSdohao1=SOhbs\nEl n√∫mero de especies observadas\n\n\n\n\n17.2.1 diversidad Œ≤\nLa diversidad Œ≤ mide qu√© tan diferentes son dos o m√°s comunidades, ya sea en su composici√≥n (riqueza) o en la abundancia de los organismos que la componen (abundancia).\n\nDisimilitud de Bray-Curtis: Diferencia en riqueza y abundancia entre entornos (muestras). Ponderaci√≥n de la abundancia. Mide las diferencias de 0 (comunidades iguales) a 1 (comunidades diferentes).\nDistancia de Jaccard: Se basa en la presencia o ausencia de especies (diversidad). Va de 0 (misma especie en la comunidad) a 1 (ninguna especie en com√∫n).\nUniFrac: Mide la distancia filogen√©tica; la similitud entre los √°rboles de cada comunidad. Existen dos tipos: sin ponderaciones (diversidad) y con ponderaciones (diversidad y abundancia).",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>17</span>¬† <span class='chapter-title'>Explorando la diversidad con librer√≠as de R</span>"
    ]
  },
  {
    "objectID": "17Asignaciontaxonomica.html#ejercicio-1-medida-simple-de-diversidades-alfa-y-beta.",
    "href": "17Asignaciontaxonomica.html#ejercicio-1-medida-simple-de-diversidades-alfa-y-beta.",
    "title": "17¬† Explorando la diversidad con librer√≠as de R",
    "section": "17.3 Ejercicio 1: Medida simple de diversidades alfa y beta.",
    "text": "17.3 Ejercicio 1: Medida simple de diversidades alfa y beta.\nEn la siguiente imagen se muestran dos lagos con diferentes especies de peces: Figura 3.\n¬øCu√°l de las siguientes opciones es verdadera para la diversidad alfa en los lagos A y B, y la diversidad beta entre los lagos A y B, respectivamente?\n\n4, 3, 1\n4, 3, 5\n9, 7, 16\n\nPor favor, pegue su resultado en el documento colaborativo proporcionado por los instructores. ¬° Aqu√≠ hay leones !",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>17</span>¬† <span class='chapter-title'>Explorando la diversidad con librer√≠as de R</span>"
    ]
  },
  {
    "objectID": "17Asignaciontaxonomica.html#soluci√≥n",
    "href": "17Asignaciontaxonomica.html#soluci√≥n",
    "title": "17¬† Explorando la diversidad con librer√≠as de R",
    "section": "17.4 Soluci√≥n",
    "text": "17.4 Soluci√≥n\nRespuesta: 2. 4, 3, 5. La diversidad alfa , en este caso, es la suma de las especies. El lago A tiene 4 especies y el lago B 3. La diversidad beta se refiere a la diferencia entre el lago A y el lago B. Si usamos la f√≥rmula de la Figura 2, vemos que para calcular la diversidad beta, debemos detectar el n√∫mero de especies y el n√∫mero de especies compartidas en ambos lagos. Solo hay una especie compartida, as√≠ que debemos restar el n√∫mero de especies compartidas al total de especies y sumar el resultado. En este caso, en el lago A, tenemos 4 especies y una especie compartida, siendo el lago B (4-1)=3, y en el lago B tenemos tres especies y una especie compartida, siendo el lago A (3-1)=2. Si sumamos 3+2, el resultado es 5.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>17</span>¬† <span class='chapter-title'>Explorando la diversidad con librer√≠as de R</span>"
    ]
  },
  {
    "objectID": "17Asignaciontaxonomica.html#diversidad-alfa-de-la-gr√°fica",
    "href": "17Asignaciontaxonomica.html#diversidad-alfa-de-la-gr√°fica",
    "title": "17¬† Explorando la diversidad con librer√≠as de R",
    "section": "17.5 Diversidad alfa de la gr√°fica",
    "text": "17.5 Diversidad alfa de la gr√°fica\nQueremos conocer la diversidad bacteriana, as√≠ que eliminaremos todos los organismos no bacterianos de nuestro merged_metagenomesobjeto Phyloseq. Para ello, crearemos un subconjunto de todos los grupos bacterianos y lo guardaremos.\n&gt; merged_metagenomes &lt;- subset_taxa(merged_metagenomes, Kingdom == \"Bacteria\") \nAhora veamos algunas estad√≠sticas de nuestros metagenomas. La salida del sample_sums()comando muestra cu√°ntas lecturas hay en la biblioteca. La biblioteca JC1A es la m√°s peque√±a, con 18412 lecturas, mientras que la biblioteca JP4D es la m√°s grande, con 149590 lecturas.\n&gt; merged_metagenomes \nphyloseq-class experiment-level object otu_table()   OTU Table:         [ 4024 taxa and 3 samples ] tax_table()   Taxonomy Table:    [ 4024 taxa by 7 taxonomic ranks ] \n&gt; sample_sums(merged_metagenomes) \n  JC1A   JP4D   JP41   18412 149590  76589  \nAdem√°s, los valores m√°ximo, m√≠nimo y medio de la salida summary()nos dan una idea de la uniformidad. Por ejemplo, la OTU que aparece m√°s veces en la muestra JC1A aparece 399 veces, y en promedio, en la muestra JP4D, una OTU aparece en 37,17 lecturas.\n&gt; summary(merged_metagenomes@otu_table@.Data) \n      JC1A              JP4D              JP41          Min.   :  0.000   Min.   :   0.00   Min.   :   0.00    1st Qu.:  0.000   1st Qu.:   3.00   1st Qu.:   1.00    Median :  0.000   Median :   7.00   Median :   5.00    Mean   :  4.575   Mean   :  37.17   Mean   :  19.03    3rd Qu.:  2.000   3rd Qu.:  21.00   3rd Qu.:  14.00    Max.   :399.000   Max.   :6551.00   Max.   :1994.00   \nPara tener una representaci√≥n m√°s visual de la diversidad dentro de las muestras (es decir, diversidad Œ±), ahora podemos mirar un gr√°fico creado usando Phyloseq:\n&gt; plot_richness(physeq = merged_metagenomes,                measures = c(\"Observed\",\"Chao1\",\"Shannon\")) \n\n\n\n\n\nCada una de estas m√©tricas puede ofrecer una perspectiva de la distribuci√≥n de las OTU en nuestras muestras. Por ejemplo, el √≠ndice de diversidad Chao1 otorga mayor peso a los singletons y doubletons observados en nuestras muestras, mientras que Shannon es un √≠ndice de entrop√≠a que se√±ala la imposibilidad de extraer dos lecturas del metagenoma y que estas pertenecer√°n a la misma OTU.\nUna precauci√≥n al comparar muestras es que las diferencias en algunos √≠ndices alfa pueden deberse a la diferencia en el n√∫mero total de lecturas de las muestras. Una muestra con m√°s lecturas tiene mayor probabilidad de tener m√°s OTU diferentes, por lo que se requiere cierta normalizaci√≥n. En este caso, trabajaremos con abundancias relativas, pero otros enfoques podr√≠an ayudar a reducir este sesgo.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>17</span>¬† <span class='chapter-title'>Explorando la diversidad con librer√≠as de R</span>"
    ]
  },
  {
    "objectID": "17Asignaciontaxonomica.html#abundancias-absolutas-y-relativas",
    "href": "17Asignaciontaxonomica.html#abundancias-absolutas-y-relativas",
    "title": "17¬† Explorando la diversidad con librer√≠as de R",
    "section": "17.6 Abundancias absolutas y relativas",
    "text": "17.6 Abundancias absolutas y relativas\nA partir de los recuentos de lecturas que acabamos de ver, es evidente que existe una gran diferencia en el n√∫mero total de lecturas secuenciadas en cada muestra. Antes de continuar con el procesamiento de los datos, verifique si hay lecturas no identificadas. Marcadas como ‚Äúen blanco‚Äù (es decir, ‚Äú‚Äú) en los diferentes niveles taxon√≥micos:\n&gt; summary(merged_metagenomes@tax_table@.Data== \"\") \n  Kingdom          Phylum          Class           Order           Family          Genus          Species         Mode :logical   Mode :logical   Mode :logical   Mode :logical   Mode :logical   Mode :logical   Mode :logical    FALSE:4024      FALSE:4024      FALSE:3886      FALSE:4015      FALSE:3967      FALSE:3866      FALSE:3540                                       TRUE :138       TRUE :9         TRUE :57        TRUE :158       TRUE :484       \nCon el comando anterior, podemos ver espacios en blanco en diferentes niveles taxon√≥micos. Por ejemplo, tenemos 158 espacios en blanco a nivel de g√©nero. Aunque podr√≠amos esperar ver algunos espacios en blanco a nivel de especie o incluso de g√©nero, eliminaremos los de g√©nero para continuar con el an√°lisis.\n&gt; merged_metagenomes &lt;- subset_taxa(merged_metagenomes, Genus != \"\") #Only genus that are no blank &gt; summary(merged_metagenomes@tax_table@.Data== \"\") \n  Kingdom          Phylum          Class           Order           Family          Genus          Species         Mode :logical   Mode :logical   Mode :logical   Mode :logical   Mode :logical   Mode :logical   Mode :logical    FALSE:3866      FALSE:3866      FALSE:3739      FALSE:3860      FALSE:3858      FALSE:3866      FALSE:3527                                       TRUE :127       TRUE :6         TRUE :8                         TRUE :339  \nA continuaci√≥n, dado que nuestros metagenomas tienen diferentes tama√±os, es imperativo convertir el n√∫mero de lecturas asignadas (es decir, abundancia absoluta) en porcentajes (es decir, abundancias relativas) para compararlas.\nEn este momento nuestra tabla OTU se ve as√≠:\n&gt; head(merged_metagenomes@otu_table@.Data) \n        JC1A JP4D JP41 1060      32  420   84 1063     316 5733 1212 2033869  135 1232  146 1850250  114  846  538 1061      42 1004  355 265       42  975  205 \nPara realizar esta transformaci√≥n a porcentajes, aprovecharemos una funci√≥n de Phyloseq.\n&gt; percentages &lt;- transform_sample_counts(merged_metagenomes, function(x) x*100 / sum(x) ) &gt; head(percentages@otu_table@.Data) \n             JC1A      JP4D      JP41 1060    0.1877383 0.3065134 0.1179709 1063    1.8539161 4.1839080 1.7021516 2033869 0.7920211 0.8991060 0.2050447 1850250 0.6688178 0.6174056 0.7555755 1061    0.2464066 0.7327130 0.4985675 265     0.2464066 0.7115490 0.2879052 \nAhora, estamos listos para comparar las abundancias dadas por porcentajes de las muestras con √≠ndices de diversidad beta.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>17</span>¬† <span class='chapter-title'>Explorando la diversidad con librer√≠as de R</span>"
    ]
  },
  {
    "objectID": "17Asignaciontaxonomica.html#diversidad-beta",
    "href": "17Asignaciontaxonomica.html#diversidad-beta",
    "title": "17¬† Explorando la diversidad con librer√≠as de R",
    "section": "17.7 Diversidad beta",
    "text": "17.7 Diversidad beta\nComo mencionamos anteriormente, la diversidad beta mide la similitud o diferencia entre nuestras muestras (superposici√≥n entre conjuntos de especies o unidades taxon√≥micas operativas definidas discretamente). Para medir esto, necesitamos calcular un √≠ndice que se ajuste a los objetivos de nuestra investigaci√≥n. Con el siguiente c√≥digo, podemos mostrar todas las posibles m√©tricas de distancia que Phyloseq puede utilizar:\n&gt; distanceMethodList \n$UniFrac [1] \"unifrac\"  \"wunifrac\"  $DPCoA [1] \"dpcoa\"  $JSD [1] \"jsd\"  $vegdist  [1] \"manhattan\"  \"euclidean\"  \"canberra\"   \"bray\"       \"kulczynski\" \"jaccard\"    \"gower\"       [8] \"altGower\"   \"morisita\"   \"horn\"       \"mountford\"  \"raup\"       \"binomial\"   \"chao\"       [15] \"cao\"         $betadiver  [1] \"w\"   \"-1\"  \"c\"   \"wb\"  \"r\"   \"I\"   \"e\"   \"t\"   \"me\"  \"j\"   \"sor\" \"m\"   \"-2\"  \"co\"  \"cc\"  \"g\"   [17] \"-3\"  \"l\"   \"19\"  \"hk\"  \"rlb\" \"sim\" \"gl\"  \"z\"    $dist [1] \"maximum\"   \"binary\"    \"minkowski\"  $designdist [1] \"ANY\" \nDescribir todas estas posibles m√©tricas de distancia est√° m√°s all√° del alcance de esta lecci√≥n, pero aqu√≠ mostramos cu√°les son las que necesitan una relaci√≥n filogen√©tica entre las especies-OTU presentes en nuestras muestras:\n\nUnifrac\nPeso-Unifrac\nDPCoA\n\nNo disponemos de un √°rbol filogen√©tico ni de relaciones filogen√©ticas. Por lo tanto, no podemos usar ninguno de estos tres. Usaremos Bray-Curtis, ya que es una de las m√©tricas de distancia m√°s robustas y utilizadas para calcular la diversidad beta.\n¬°Sigamos as√≠! Ya tenemos todo lo necesario para comenzar el an√°lisis de diversidad beta. Usaremos el comando Phyloseq ordinatepara generar un nuevo objeto donde se asignar√°n las distancias entre nuestras muestras despu√©s de calcularlas. Para este comando, debemos especificar el m√©todo que usaremos para generar una matriz. En este ejemplo, usaremos el Escalamiento Multidimensional No M√©trico o NMDS . NMDS intenta representar la disimilitud entre objetos en un espacio de baja dimensi√≥n; en este caso, un gr√°fico bidimensional.\n&gt; meta_ord &lt;- ordinate(physeq = percentages, method = \"NMDS\",                       distance = \"bray\") \nSi recibe alg√∫n mensaje de advertencia despu√©s de ejecutar este script, no se preocupe. Esto se debe a que solo tenemos tres muestras. Con pocas muestras, el algoritmo advierte sobre la poca dificultad para generar la matriz de distancias.\nPor ahora, solo necesitamos el comando plot_ordination()para ver los resultados de nuestro an√°lisis de diversidad beta:\n&gt; plot_ordination(physeq = percentages, ordination = meta_ord)\n\n\n\n\n\nEn este gr√°fico NMDS, cada punto representa la abundancia combinada de todas sus OTU. Como se muestra, cada muestra ocupa espacio en el gr√°fico sin formar grupos. Este resultado se debe a que cada muestra es lo suficientemente diferente como para considerarse un punto independiente en el espacio NMDS.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>17</span>¬† <span class='chapter-title'>Explorando la diversidad con librer√≠as de R</span>"
    ]
  },
  {
    "objectID": "17Asignaciontaxonomica.html#ejercicio-3-agregar-metadatos-a-la-visualizaci√≥n-de-la-diversidad-beta",
    "href": "17Asignaciontaxonomica.html#ejercicio-3-agregar-metadatos-a-la-visualizaci√≥n-de-la-diversidad-beta",
    "title": "17¬† Explorando la diversidad con librer√≠as de R",
    "section": "17.8 Ejercicio 3: Agregar metadatos a la visualizaci√≥n de la diversidad beta",
    "text": "17.8 Ejercicio 3: Agregar metadatos a la visualizaci√≥n de la diversidad beta\nEn la siguiente figura, el gr√°fico de diversidad beta que generamos anteriormente se ha enriquecido. Observe el c√≥digo a continuaci√≥n y responda:\n1) ¬øQu√© instrucci√≥n colore√≥ las muestras seg√∫n su tratamiento correspondiente?\n2) ¬øQu√© hizo la instrucci√≥n geom_text?\n3) ¬øQu√© otra diferencia observa con nuestro gr√°fico anterior?\n4) ¬øObserva alguna agrupaci√≥n de las muestras seg√∫n su tratamiento?\n\n\n\n\n\nmetadata_cuatroc &lt;- data.frame(Sample=c(\"JC1A\", \"JP4D\", \"JP41\"), Treatment=c(\"Control mesocosm\", \"Fertilized pond\", \"Unenriched pond\")) # Making dataframe with metadata   rownames(metadata_cuatroc) &lt;- metadata_cuatroc$Sample # Using sample names as row names   percentages@sam_data &lt;- sample_data(metadata_cuatroc) # Adding metadata to sam_data table of phyloseq object percentages   meta_ord &lt;- ordinate(physeq = percentages, method = \"NMDS\", distance = \"bray\") # Calculating beta diversity     plot_ordination(physeq = percentages, ordination = meta_ord, color = \"Treatment\") + # Plotting beta diversity.       geom_text(mapping = aes(label = Sample), size = 3, vjust = 1.5)",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>17</span>¬† <span class='chapter-title'>Explorando la diversidad con librer√≠as de R</span>"
    ]
  },
  {
    "objectID": "17Asignaciontaxonomica.html#discusi√≥n-√≠ndices-de-diversidad",
    "href": "17Asignaciontaxonomica.html#discusi√≥n-√≠ndices-de-diversidad",
    "title": "17¬† Explorando la diversidad con librer√≠as de R",
    "section": "17.9 Discusi√≥n: √çndices de diversidad",
    "text": "17.9 Discusi√≥n: √çndices de diversidad\n¬øPor qu√© cree que necesitamos diferentes √≠ndices para evaluar la diversidad? ¬øQu√© √≠ndice utilizar√° para evaluar el impacto de los taxones raros y poco abundantes?\n\n17.10 Soluci√≥n\nSer√° dif√≠cil (si no imposible) tomar dos comunidades y observar la misma distribuci√≥n de todos los miembros. Este resultado se debe a que hay muchos factores que afectan a estos linajes. Algunos de los factores ambientales son la temperatura, el pH y la concentraci√≥n de nutrientes. Adem√°s, las interacciones de estas poblaciones, como la competencia, la inhibici√≥n de otras poblaciones y la velocidad de crecimiento, son un importante impulsor de la variaci√≥n ( factor bi√≥tico ). Una combinaci√≥n de los factores mencionados anteriormente puede interactuar para mantener algunas poblaciones con baja abundancia ( taxones raros). Para tener formas de evaluar hip√≥tesis sobre cu√°les de estos procesos pueden estar afectando a la comunidad, utilizamos todos estos diferentes √≠ndices. Algunos enfatizan el n√∫mero de especies y otros la uniformidad de las OTU. Para evaluar el impacto de los linajes de baja abundancia, un √≠ndice de diversidad alfa ampliamente utilizado es el √≠ndice Chao1.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>17</span>¬† <span class='chapter-title'>Explorando la diversidad con librer√≠as de R</span>"
    ]
  },
  {
    "objectID": "7Buclesscriptsdescarga.html#crear-o-abrir-un-archivo",
    "href": "7Buclesscriptsdescarga.html#crear-o-abrir-un-archivo",
    "title": "7¬† Escritura de scripts y trabajo con datos",
    "section": "8.1 1Ô∏è‚É£ Crear o abrir un archivo",
    "text": "8.1 1Ô∏è‚É£ Crear o abrir un archivo\n$ cd ~/dc_workshop/data/untrimmed_fastq\n$ nano README.txt\n\n\nEscribe tu texto normalmente.\nPara guardar pulsa Ctrl + O (WriteOut), luego Enter para aceptar el nombre.\nPara salir pulsa Ctrl + X.",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>**Escritura de scripts y trabajo con datos**</span>"
    ]
  },
  {
    "objectID": "7Buclesscriptsdescarga.html#escritura-de-scripts",
    "href": "7Buclesscriptsdescarga.html#escritura-de-scripts",
    "title": "7¬† Escritura de scripts y trabajo con datos",
    "section": "8.2 Escritura de scripts",
    "text": "8.2 Escritura de scripts\nUna caracter√≠stica realmente poderosa de la l√≠nea de comandos es la posibilidad de escribir scripts. Los scripts permiten guardar comandos para ejecutarlos y tambi√©n combinar varios comandos. Si bien escribir scripts puede requerir una inversi√≥n de tiempo adicional al principio, esto puede ahorrarle tiempo al ejecutarlos repetidamente. Los scripts tambi√©n pueden abordar el desaf√≠o de la reproducibilidad: si necesita repetir el an√°lisis, conserva un registro del historial de comandos dentro del script.\nAlgo que solemos hacer con los resultados de secuenciaci√≥n es extraer las lecturas incorrectas y guardarlas en un archivo para ver si podemos averiguar qu√© sucede. Buscaremos lecturas con secuencias largas de N como hicimos antes, pero ahora escribiremos un script para ejecutarlo cada vez que obtengamos nuevas secuencias, en lugar de escribir el c√≥digo manualmente cada vez.\n$ grep -B1 -A2 NNNNNNNNNN *.fastq &gt; scripted_bad_reads.txt\npuedes guardar esa l√≠nea en un script (bad-reads-script.sh) y luego ejecutarlo siempre con:\n$ bash bad-reads-script.sh\nDe ese modo s√≥lo escribes una vez el comando y obtienes, en cada ejecuci√≥n, un archivo scripted_bad_reads.txt con todas las lecturas problem√°ticas, sin tener que volver a escribirlo a mano.",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>**Escritura de scripts y trabajo con datos**</span>"
    ]
  },
  {
    "objectID": "7Buclesscriptsdescarga.html#convertir-el-script-en-un-programa-y-comprimir-datos",
    "href": "7Buclesscriptsdescarga.html#convertir-el-script-en-un-programa-y-comprimir-datos",
    "title": "7¬† Escritura de scripts y trabajo con datos",
    "section": "8.3 Convertir el script en un programa y comprimir datos",
    "text": "8.3 Convertir el script en un programa y comprimir datos\nHemos escrito un script (bad-reads-script.sh) que extrae las lecturas con diez N consecutivas de todos los archivos FASTQ. Cada vez que lo ejecut√°bamos con bash bad-reads-script.sh, funcionaba, pero a√∫n ten√≠amos que invocar expl√≠citamente Bash.\nPara simplificarlo, vamos a:\n\nHacer que el script sea ejecutable\n\nEjecutarlo directamente\n\n\n\n8.3.1 1. Ver permisos actuales\nPrimero comprobamos los permisos del script:\n\n $ ls -l bad-reads-script.sh # -rw-rw-r-- 1 dcuser dcuser 42 Oct 25 21:46 bad-reads-script.sh\n\nAqu√≠ vemos -rw-rw-r--, lo que significa que podemos leer y escribir el archivo, pero no ejecutarlo.\n\n\n8.3.2 2. A√±adir permiso de ejecuci√≥n\nUsamos chmod +x para que el sistema sepa que nuestro script es un programa:\n$ chmod +x bad-reads-script.sh\n$ ls -l bad-reads-script.sh\n# -rwxrwxr-x 1 dcuser dcuser   42 Oct 25 21:46 bad-reads-script.sh\nAhora aparece x en los permisos (-rwxrwxr-x), indicando que podemos ejecutarlo.\n\n\n8.3.3 3. Ejecutar el script como programa\nYa no necesitamos escribir bash cada vez. Simplemente:\n$ ./bad-reads-script.sh\nEl script corre de la misma forma, generando el archivo scripted_bad_reads.txt con todas las lecturas ‚Äúmalas‚Äù.\n\n\n8.3.4 4. Comprimir los archivos FASTQ\nCuando terminemos de analizarlos, es buena pr√°ctica comprimirlos para liberar espacio:\n$ gzip ~/dc_workshop/data/untrimmed_fastq/*.fastq\nConfirmamos que ahora solo hay archivos .fastq.gz y su tama√±o reducido:\n$ ls -lh ~/dc_workshop/data/untrimmed_fastq/*.fastq.gz\n# total 428M\n# -rw-r--r-- 1 dcuser dcuser  24M Nov 26 12:36 JC1A_R1.fastq.gz\n# -rw-r--r-- 1 dcuser dcuser  24M Nov 26 12:37 JC1A_R2.fastq.gz\n# -rw-r--r-- 1 dcuser dcuser 179M Nov 26 12:44 JP4D_R1.fastq.gz\n# -rw-r--r-- 1 dcuser dcuser 203M Nov 26 12:51 JP4D_R2.fastq.gz\n\nTenemos un programa propio (bad-reads-script.sh) que ejecutamos con ./bad-reads-script.sh.\nMantenemos nuestro directorio de datos limpio y ligero, dejando los FASTQ comprimidos cuando no los usamos.\n8.4 Mover y descargar datos en la l√≠nea de comandos\n\nEn lugar de trabajar solo con datos preinstalados en el servidor, normalmente tendr√°s que traer nuevos archivos desde Internet o desde tu m√°quina local.\n\n\n\n8.4.1 1Ô∏è‚É£ ¬øTienes wget o curl?\nPara descargar desde la web, usas wget o curl. Comprueba cu√°l est√° disponible:\n$ which wget # si est√° instalado, muestra su ruta \n$ which curl # idem para curl\n\nSi ves una ruta bajo /usr/bin/‚Ä¶, ese programa est√° instalado.\nSi no retorna nada, no lo tienes y debes usar el otro.\n\n\n\n8.4.2 2Ô∏è‚É£ Descargar con wget\nwget descarga por defecto al archivo con el mismo nombre:\n$ cd ~\nwget ftp://ftp.ensemblgenomes.org/pub/release-37/bacteria/species_EnsemblBacteria.txt\nSin flags adicionales, guarda species_EnsemblBacteria.txt en tu directorio actual.\n\n\n8.4.3 3Ô∏è‚É£ Descargar con curl\nPara curl necesitas la opci√≥n -O para grabar en disco:\n$ cd ~\ncurl -O ftp://ftp.ensemblgenomes.org/pub/release-37/bacteria/species_EnsemblBacteria.txt\n\n-O (‚Äúremote Output‚Äù) descarga y usa el mismo nombre de archivo que en el servidor.\nEs importante tener en cuenta que tanto curl como wgetse descargan en el equipo al que pertenece la l√≠nea de comandos. Por lo tanto, si inicia sesi√≥n en AWS desde la l√≠nea de comandos y ejecuta el curlcomando anterior en la terminal de AWS, el archivo se descargar√° en su equipo de AWS, no en el local.\n\n\n\n8.4.4 Mover archivos entre su computadora port√°til y su instancia\n¬øQu√© sucede si los datos que necesita est√°n en su computadora local, pero necesita transferirlos a la nube? Hay varias maneras de hacerlo. Al seguir esta lecci√≥n, puede que est√© usando la interfaz de RStudio con una terminal, otra terminal o su propia computadora local. Dependiendo de su configuraci√≥n, existen varias alternativas para transferir los archivos. Aqu√≠ describimos c√≥mo usar la interfaz de RStudio para transferir archivos.\n\n8.4.5 Escenarios de transferencia de archivos\n\nSi trabajas en tu ordenador local , no necesitas transferir archivos, ya que los tienes localmente.\nEn ese caso, solo necesitas saber el directorio en el que trabajas.\nSi trabaja en una m√°quina remota, como una instancia de AWS, puede usar el scpcomando. En ese caso, siempre es m√°s f√°cil iniciar la transferencia localmente. Si escribe en una terminal, esta no deber√≠a estar conectada a su instancia. Deber√≠a mostrar su computadora local. Si usa un programa de transferencia, debe instalarlo en su m√°quina local, no en su instancia.\nSi est√° utilizando el servidor RStudio desde la instancia de AWS, puede transferir archivos entre su m√°quina local y su m√°quina remota utilizando la interfaz gr√°fica de RStudio.\n\n\n\n\n8.4.6 Descargar archivos en RStudio\nSeguiremos los siguientes cinco pasos para descargar archivos con la interfaz RStudio.\n\nPrimero seleccionamos el archivo a descargar desde el panel inferior derecho.\n\nLuego, elegimos ‚ÄúM√°s‚Äù para mostrar m√°s acciones para el archivo seleccionado.\n\n\nWithin the ‚ÄúMore‚Äù menu, the ‚Äúexport‚Äù button should become available.\n\nUna ventana emergente deber√≠a aparecer en tu pantalla donde podr√°s seleccionar la opci√≥n ‚ÄúDescargar‚Äù.\n\nTu archivo ahora deber√≠a estar descargado en tu computadora local.\n\n\n\n8.4.7 Subir archivos a AWS desde RStudio\nAhora que aprendimos c√≥mo descargar archivos desde la interfaz de RStudio, aprenderemos la acci√≥n opuesta: subir archivos desde tu computadora local a tu m√°quina remota en AWS.\n\nSelecciona la opci√≥n ‚ÄúUpload‚Äù (Subir) en la interfaz de RStudio.\n\n\n\n\n\n\nThe Upload button is highlighted.\n\n\nDespu√©s de que aparezca una ventana emergente en tu pantalla, selecciona la opci√≥n ‚ÄúSelect file‚Äù (Seleccionar archivo).\n\n\n\nSelect filed button highlighted in the emergent window\n\n\nAparecer√° una nueva ventana en tu computadora donde deber√°s elegir el archivo que deseas subir. Selecciona el archivo y haz clic en ‚ÄúAbrir‚Äù.\n\n\n\nfile to upload and open button are highlighted in the window of the local filesystem\n\n\nFinalmente, si el archivo es correcto, haz clic en ‚ÄúAceptar‚Äù y comenzar√° la carga.\nAhora podr√°s ver el nuevo archivo en tu interfaz de RStudio.",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>**Escritura de scripts y trabajo con datos**</span>"
    ]
  },
  {
    "objectID": "7Buclesscriptsdescarga.html#transferir-archivos-entre-tu-m√°quina-local-y-la-instancia-remota-con-scp",
    "href": "7Buclesscriptsdescarga.html#transferir-archivos-entre-tu-m√°quina-local-y-la-instancia-remota-con-scp",
    "title": "7¬† Bucles",
    "section": "11.5 Transferir archivos entre tu m√°quina local y la instancia remota con scp",
    "text": "11.5 Transferir archivos entre tu m√°quina local y la instancia remota con scp\nscp (‚Äúsecure copy protocol‚Äù) te permite copiar archivos de forma segura entre dos ordenadores (local ‚ÜîÔ∏é remoto).\n\n11.5.1 Sintaxis b√°sica\n$ scp origen destino\norigen y destino pueden ser rutas locales o remotas.\nPara especificar una m√°quina remota usas el formato usuario@host:/ruta/al/archivo.\n\n\n11.5.2",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Bucles</span>"
    ]
  },
  {
    "objectID": "8Organizacionproyecto.html#poniendo-en-marcha-tu-proyecto-yahir",
    "href": "8Organizacionproyecto.html#poniendo-en-marcha-tu-proyecto-yahir",
    "title": "8¬† Organizaci√≥n de proyectos",
    "section": "8.2 Poniendo en marcha tu proyecto (yahir)",
    "text": "8.2 Poniendo en marcha tu proyecto (yahir)\nOrganizar tu espacio de trabajo de forma clara es tan importante como dise√±ar el experimento. Una buena estructura y documentaci√≥n te evitar√°n confusiones (¬ød√≥nde dej√© mis mejores alineamientos? ¬øqu√© par√°metros us√©?) y facilitar√°n la colaboraci√≥n y la redacci√≥n de m√©todos.\nPiensa en tu ‚Äúyo futuro‚Äù como un colaborador: cuanta m√°s claridad dejes, mejor.\n\n\n8.2.1 Ejercicio: crear tu estructura de carpetas\n\nVe a tu carpeta de inicio\ncd ~\npwd # debe mostrar /home/dcuser\n\nCrea los directorios\nmkdir workshop\nmkdir workshop/docs\nmkdir workshop/data\nmkdir workshop/results\nVerifica recursivamente\n$ ls -R workshop\n# workshop/:\n#   data  docs  results\n#\n# workshop/data/:\n#\n# workshop/docs/:\n#\n# workshop/results/:\nCon esta estructura tendr√°s un lugar claro para tu documentaci√≥n (docs), tus datos crudos (data) y tus resultados (results). Tu ‚Äúyo futuro‚Äù te lo agradecer√°.",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Organizaci√≥n de proyectos</span>"
    ]
  },
  {
    "objectID": "18Exploraciondetaxonomiaconr.html#biom-de-kraken",
    "href": "18Exploraciondetaxonomiaconr.html#biom-de-kraken",
    "title": "18¬† An√°lisis de taxonom√≠a con R",
    "section": "18.2 Biom de Kraken",
    "text": "18.2 Biom de Kraken\nKraken-biom es un programa que crea tablas BIOM a partir de la salida de Kraken.\nPara ejecutar Kraken-biom, debemos movernos a la carpeta donde se encuentran nuestros archivos de datos taxon√≥micos:\n$ cd ~/dc_workshop/taxonomy \nPrimero, visualizaremos el contenido de nuestro directorio mediante el lscomando.\n$ ls \nJC1A.kraken  JC1A.report  JP41.report  JP4D.kraken  JP4D.report  mags_taxonomy \nLa herramienta kraken-biom est√° instalada dentro de nuestro ambiente metagenomics, act√≠valo.\n$ conda activate metagenomics  \nEchemos un vistazo a las diferentes banderas que kraken-biomtiene:\n$ kraken-biom -h                   \nusage: kraken-biom [-h] [--max {D,P,C,O,F,G,S}] [--min {D,P,C,O,F,G,S}]                    [-o OUTPUT_FP] [--otu_fp OTU_FP] [--fmt {hdf5,json,tsv}]                    [--gzip] [--version] [-v]                    kraken_reports [kraken_reports ...]  Create BIOM-format tables (http://biom-format.org) from Kraken output (http://ccb.jhu.edu/software/kraken/). . . . \nAl observar detenidamente las primeras l√≠neas de salida, se nota que necesitamos una salida espec√≠fica de Kraken: el archivo .reports.\nCon el siguiente comando, crearemos una tabla en formato Biom llamada cuatroc.biom . Incluiremos las muestras con las que hemos estado trabajando ( JC1Ay JP4D) y agregaremos un par de muestras m√°s ( JP41) para poder realizar an√°lisis espec√≠ficos posteriormente.\n$ kraken-biom JC1A.report JP4D.report JP41.report --fmt json -o cuatroc.biom \nSi inspeccionamos nuestra carpeta, veremos que el cuatroc.biomarchivo se ha creado. Este objeto biomcontiene la abundancia como el ID (un n√∫mero) de cada OTU.\nCon este resultado, estamos listos para volver a la consola de RStudio y empezar a manipular nuestros datos taxon√≥micos.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>18</span>¬† <span class='chapter-title'>An√°lisis de taxonom√≠a con R</span>"
    ]
  },
  {
    "objectID": "18Exploraciondetaxonomiaconr.html#creaci√≥n-y-manipulaci√≥n-de-objetos-phyloseq",
    "href": "18Exploraciondetaxonomiaconr.html#creaci√≥n-y-manipulaci√≥n-de-objetos-phyloseq",
    "title": "18¬† An√°lisis de taxonom√≠a con R",
    "section": "18.3 Creaci√≥n y manipulaci√≥n de objetos Phyloseq",
    "text": "18.3 Creaci√≥n y manipulaci√≥n de objetos Phyloseq\n\n18.3.1 Cargar los paquetes requeridos\nPhyloseq es una biblioteca con herramientas para analizar y representar gr√°ficamente la informaci√≥n de asignaci√≥n taxon√≥mica y abundancia de sus muestras metagen√≥micas. Instalemos Phyloseq (esta instrucci√≥n podr√≠a no funcionar en ciertas versiones de R) y otras bibliotecas necesarias para su ejecuci√≥n:\n&gt; if (!requireNamespace(\"BiocManager\", quietly = TRUE))     install.packages(\"BiocManager\")  \n&gt; BiocManager::install(\"phyloseq\") # Install phyloseq  \n&gt; install.packages(c(\"RColorBrewer\", \"patchwork\")) #install patchwork to chart publication-quality plots and readr to read rectangular datasets. \nUna vez instaladas las bibliotecas debemos cargarlas o llamarlas (este proceso es necesario cada vez que iniciamos una nueva sesi√≥n de trabajo en R):\n&gt; library(\"phyloseq\") \n&gt; library(\"ggplot2\") \n&gt; library(\"RColorBrewer\") \n&gt; library(\"patchwork\") \n\n\n18.3.2 Creando el objeto phyloseq\nLe pedimos a R qu√© nos situe en el directorio taxonomy.\n&gt; setwd(\"~/dc_workshop/taxonomy/\") \nAhora debemos crear el objeto phyloseq con el comando import_biom:\n&gt; merged_metagenomes &lt;- import_biom(\"cuatroc.biom\") \nInspeccionamos el objeto:\n&gt; class(merged_metagenomes) \n[1] \"phyloseq\" attr(\"package\") [1] \"phyloseq\" \nEl comando ‚Äúclass‚Äù indica que ya tenemos nuestro objeto phyloseq.\n\n\n18.3.3 Explorando las etiquetas taxon√≥micas\nAccedamos a los datos almacenados en el objeto merged_metagenomes. Dado que un objeto phyloseq es un objeto especial en R, necesitamos usar el operador @para explorar las subsecciones de datos dentro de merged_metagenomes. Si escribimos merged_metagenomes@, se muestran cinco opciones; tax_tabley otu_tableson las que usaremos. Despu√©s de escribir merged_metagenomes@otu_tableo merged_metagenomes@tax_table, la opci√≥n de .Data ser√° la elegida en ambos casos. Veamos qu√© hay dentro de nuestro tax_table:\n&gt; View(merged_metagenomes@tax_table@.Data)\n\n\n\n\n\nLos n√∫meros en la columna de la izquiera (en negritas) identifican cada uno de los OTUs.\nA continuaci√≥n, eliminemos algunos de los caracteres innecesarios en el id de las OTU y pongamos nombres a los rangos taxon√≥micos usando la funci√≥n substring(). Esta funci√≥n es muy flexible, especialmente seleccionando caracteres de diferentes longitudes, como en este caso.\nCada car√°cter en¬†.Dataest√° precedido por tres espacios ocupados por una letra y dos guiones bajos, por ejemplo:¬†o__Rhodobacterales. En este caso, ‚ÄúRodobacterales‚Äù comienza en la posici√≥n 4 con una R. Por lo tanto, para eliminar los caracteres innecesarios, usaremos el siguiente c√≥digo:\n&gt; merged_metagenomes@tax_table@.Data &lt;- substring(merged_metagenomes@tax_table@.Data, 4) \n&gt; colnames(merged_metagenomes@tax_table@.Data)&lt;- c(\"Kingdom\", \"Phylum\", \"Class\", \"Order\", \"Family\", \"Genus\", \"Species\")\n\n\n\n\n\nUsaremos un comando llamado unique()para explorar cu√°ntos phylum tenemos. Veamos el resultado del siguiente c√≥digo:\n&gt; unique(merged_metagenomes@tax_table@.Data[,\"Phylum\"])\nConocer los filos es √∫til, pero lo que necesitamos saber es cu√°ntas de nuestras OTU se han asignado al filo Firmicutes. Usemos el comando sum()para preguntarle a R:\n&gt; sum(merged_metagenomes@tax_table@.Data[,\"Phylum\"] == \"Firmicutes\")\nAhora, para saber para ese filo en particular qu√© taxones hay en un determinado rango, tambi√©n podemos preguntarle por phyloseq.\n&gt; unique(merged_metagenomes@tax_table@.Data[merged_metagenomes@tax_table@.Data[,\"Phylum\"] == \"Firmicutes\", \"Class\"])\n\n\n18.3.4 Explorando la tabla de abundancia\nHasta ahora, hemos analizado la parte del objeto phyloseq que almacena la informaci√≥n sobre la taxonom√≠a (en todos los niveles posibles) de cada OTU presente en nuestras muestras. Sin embargo, tambi√©n hay una parte del objeto phyloseq que almacena la informaci√≥n sobre cu√°ntas lecturas secuenciadas correspondientes a una OTU espec√≠fica hay en cada muestra. Esta tabla es la otu_table.\n&gt; View(merged_metagenomes@otu_table@.Data)\n\n\n\n\n\nmerged_metagenomes@otu_table@.Data[\"1077935\",]\nJC1A JP4D JP41    \n42  782  257",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>18</span>¬† <span class='chapter-title'>An√°lisis de taxonom√≠a con R</span>"
    ]
  },
  {
    "objectID": "19Exploraciondediversidad.html#primer-acercamiento-la-diversidad",
    "href": "19Exploraciondediversidad.html#primer-acercamiento-la-diversidad",
    "title": "19¬† Control de calidad",
    "section": "",
    "text": "Diversidad Œ±: Puede representarse √∫nicamente como riqueza (¬†es decir,¬†el n√∫mero de especies diferentes en un entorno), o tambi√©n puede medirse considerando la abundancia de las especies en el entorno (¬†es decir,¬†el n√∫mero de individuos de cada especie en el entorno). Para medir la diversidad Œ±, utilizamos √≠ndices como el de Shannon, el de Simpson, el de Chao1, etc.\nAqu√≠, la diversidad alfa se representa en su forma m√°s simple: la riqueza.\n\n\n\n\n\n\n\nLa diversidad Œ≤ es la diferencia (medida como distancia) entre dos o m√°s entornos. Puede medirse con m√©tricas como la disimilitud de Bray-Curtis, la distancia de Jaccard o la distancia Unifrac, por nombrar algunas. Cada una de estas medidas se centra en una caracter√≠stica de la comunidad ( p.¬†ej., la distancia Unifrac mide la relaci√≥n filogen√©tica entre las especies de la comunidad).",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>19</span>¬† <span class='chapter-title'>Control de calidad</span>"
    ]
  },
  {
    "objectID": "19Exploraciondediversidad.html#diversidad-Œ±",
    "href": "19Exploraciondediversidad.html#diversidad-Œ±",
    "title": "19¬† Control de calidad",
    "section": "19.2 diversidad Œ±",
    "text": "19.2 diversidad Œ±\n\n\n\n\n\n\n\n√çndices de diversidad\nDescripci√≥n\n\n\n\n\nShannon (H)\nEstimaci√≥n de la riqueza y la uniformidad de especies. Mayor importancia para la riqueza. Sensible a especies raras.\n\n\nSimpson (D)\nEstimaci√≥n de la riqueza y la uniformidad de especies. Mayor importancia para la uniformidad. Sensible a especies dominantes.\n\n\nCaos1\nAbundancia basada en especies representadas por un solo individuo (singletons) y dos individuos (doubletons).\n\n\n\n\n19.2.1 ¬øCu√°l usar?\n\nSi te interesa capturar tanto riqueza como distribuci√≥n sin que las especies dominantes dominen la m√©trica, usa Shannon.\nSi est√°s interesado en el dominio de pocas especies o en c√≥mo se distribuye el peso de las especies m√°s abundantes, usa Simpson.\n\n\n\n19.2.2 diversidad Œ≤\nLa diversidad Œ≤ mide qu√© tan diferentes son dos o m√°s comunidades, ya sea en su composici√≥n (riqueza) o en la abundancia de los organismos que la componen (abundancia).\n\nDisimilitud de Bray-Curtis: Diferencia en riqueza y abundancia entre muestras. Ponderaci√≥n de la abundancia. Mide las diferencias de 0 (comunidades iguales) a 1 (comunidades diferentes).\nDistancia de Jaccard: Se basa en la presencia o ausencia de especies (diversidad). Va de 0 (misma especie en la comunidad) a 1 (ninguna especie en com√∫n).\nUniFrac: Mide la distancia filogen√©tica; la similitud entre los √°rboles de cada comunidad. Existen dos tipos: sin ponderaciones (diversidad) y con ponderaciones (diversidad y abundancia).\n\nExisten diferentes maneras de graficar y mostrar los resultados de dicho an√°lisis. Entre ellas, se utilizan ampliamente el an√°lisis PCA, el PCoA o el NMDS.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>19</span>¬† <span class='chapter-title'>Control de calidad</span>"
    ]
  },
  {
    "objectID": "19Exploraciondediversidad.html#diversidad-alfa-de-la-gr√°fica",
    "href": "19Exploraciondediversidad.html#diversidad-alfa-de-la-gr√°fica",
    "title": "19¬† Control de calidad",
    "section": "19.3 Diversidad alfa de la gr√°fica",
    "text": "19.3 Diversidad alfa de la gr√°fica\nQueremos conocer la diversidad bacteriana, as√≠ que eliminaremos todos los organismos no bacterianos de nuestro merged_metagenomesobjeto Phyloseq. Para ello, crearemos un subconjunto de todos los grupos bacterianos y lo guardaremos.\n&gt; merged_metagenomes &lt;- subset_taxa(merged_metagenomes, Kingdom == \"Bacteria\") \nAhora veamos algunas estad√≠sticas de nuestros metagenomas. La salida del sample_sums()comando muestra cu√°ntas lecturas hay en la biblioteca. La biblioteca JC1A es la m√°s peque√±a, con 18412 lecturas, mientras que la biblioteca JP4D es la m√°s grande, con 149590 lecturas.\n&gt; merged_metagenomes \nphyloseq-class experiment-level object otu_table()   OTU Table:         [ 4024 taxa and 3 samples ] tax_table()   Taxonomy Table:    [ 4024 taxa by 7 taxonomic ranks ] \n&gt; sample_sums(merged_metagenomes) \n  JC1A   JP4D   JP41   18412 149590  76589  \nAdem√°s, los valores m√°ximo, m√≠nimo y medio de la salida summary()nos dan una idea de la uniformidad. Por ejemplo, la OTU que aparece m√°s veces en la muestra JC1A aparece 399 veces, y en promedio, en la muestra JP4D, una OTU aparece en 37,17 lecturas.\n&gt; summary(merged_metagenomes@otu_table@.Data) \n      JC1A              JP4D              JP41          Min.   :  0.000   Min.   :   0.00   Min.   :   0.00    1st Qu.:  0.000   1st Qu.:   3.00   1st Qu.:   1.00    Median :  0.000   Median :   7.00   Median :   5.00    Mean   :  4.575   Mean   :  37.17   Mean   :  19.03    3rd Qu.:  2.000   3rd Qu.:  21.00   3rd Qu.:  14.00    Max.   :399.000   Max.   :6551.00   Max.   :1994.00   \nPara tener una representaci√≥n m√°s visual de la diversidad dentro de las muestras (es decir, diversidad Œ±), ahora podemos mirar un gr√°fico creado usando Phyloseq:\n&gt; plot_richness(physeq = merged_metagenomes,                measures = c(\"Observed\",\"Chao1\",\"Shannon\")) \n\n\n\n\n\nCada una de estas m√©tricas puede ofrecer una perspectiva de la distribuci√≥n de las OTU en nuestras muestras. Por ejemplo, el √≠ndice de diversidad Chao1 otorga mayor peso a los singletons y doubletons observados en nuestras muestras, mientras que Shannon es un √≠ndice de entrop√≠a que se√±ala la imposibilidad de extraer dos lecturas del metagenoma y que estas pertenecer√°n a la misma OTU.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>19</span>¬† <span class='chapter-title'>Control de calidad</span>"
    ]
  },
  {
    "objectID": "19Exploraciondediversidad.html#abundancias-absolutas-y-relativas",
    "href": "19Exploraciondediversidad.html#abundancias-absolutas-y-relativas",
    "title": "19¬† Control de calidad",
    "section": "19.4 Abundancias absolutas y relativas",
    "text": "19.4 Abundancias absolutas y relativas\nA partir de los recuentos de lecturas que acabamos de ver, es evidente que existe una gran diferencia en el n√∫mero total de lecturas secuenciadas en cada muestra. Antes de continuar con el procesamiento de los datos, verifica si hay lecturas no identificadas. Marcadas como ‚Äúen blanco‚Äù (es decir, ‚Äú‚Äú) en los diferentes niveles taxon√≥micos:\n&gt; summary(merged_metagenomes@tax_table@.Data== \"\") \n  Kingdom          Phylum          Class           Order           Family          Genus          Species         Mode :logical   Mode :logical   Mode :logical   Mode :logical   Mode :logical   Mode :logical   Mode :logical    FALSE:4024      FALSE:4024      FALSE:3886      FALSE:4015      FALSE:3967      FALSE:3866      FALSE:3540                                       TRUE :138       TRUE :9         TRUE :57        TRUE :158       TRUE :484       \nCon el comando anterior, podemos ver espacios en blanco en diferentes niveles taxon√≥micos. Por ejemplo, tenemos 158 espacios en blanco a nivel de g√©nero. Aunque podr√≠amos esperar ver algunos espacios en blanco a nivel de especie o incluso de g√©nero, eliminaremos los de g√©nero para continuar con el an√°lisis.\n&gt; merged_metagenomes &lt;- subset_taxa(merged_metagenomes, Genus != \"\") #Only genus that are no blank \n&gt; summary(merged_metagenomes@tax_table@.Data== \"\") \n  Kingdom          Phylum          Class           Order           Family          Genus          Species         Mode :logical   Mode :logical   Mode :logical   Mode :logical   Mode :logical   Mode :logical   Mode :logical    FALSE:3866      FALSE:3866      FALSE:3739      FALSE:3860      FALSE:3858      FALSE:3866      FALSE:3527                                       TRUE :127       TRUE :6         TRUE :8                         TRUE :339  \nA continuaci√≥n, dado que nuestros metagenomas tienen diferentes tama√±os, es esencial convertir el n√∫mero de lecturas asignadas (es decir, abundancia absoluta) en porcentajes (es decir, en abundancias relativas) para poder compararlas compararlas.\nEn este momento nuestra tabla OTU se ve as√≠:\n&gt; head(merged_metagenomes@otu_table@.Data) \n        JC1A JP4D JP41 1060      \n        32  420   84 1063     \n        316 5733 1212 2033869  \n        135 1232  146 1850250  \n        114  846  538 1061      \n        42 1004  355 265       \n        42  975  205 \nPara realizar esta transformaci√≥n a porcentajes, aprovecharemos una funci√≥n de Phyloseq.\n&gt; percentages &lt;- transform_sample_counts(merged_metagenomes, function(x) x*100 / sum(x) ) \n&gt; head(percentages@otu_table@.Data) \nJC1A      JP4D      JP41 \n1060    0.1877383 0.3065134 0.1179709 \n1063    1.8539161 4.1839080 1.7021516 \n2033869 0.7920211 0.8991060 0.2050447 \n1850250 0.6688178 0.6174056 0.7555755 \n1061    0.2464066 0.7327130 0.4985675 \n265     0.2464066 0.7115490 0.2879052 \nAhora, estamos listos para comparar las abundancias dadas por porcentajes de las muestras con √≠ndices de diversidad beta.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>19</span>¬† <span class='chapter-title'>Control de calidad</span>"
    ]
  },
  {
    "objectID": "19Exploraciondediversidad.html#diversidad-beta",
    "href": "19Exploraciondediversidad.html#diversidad-beta",
    "title": "19¬† Control de calidad",
    "section": "19.5 Diversidad beta",
    "text": "19.5 Diversidad beta\nComo mencionamos anteriormente, la diversidad beta mide la similitud o diferencia entre nuestras muestras (superposici√≥n entre conjuntos de especies o unidades taxon√≥micas operativas definidas). Para medir esto, necesitamos calcular un √≠ndice que se ajuste a los objetivos de nuestra investigaci√≥n. Con el siguiente c√≥digo, podemos mostrar todas las posibles m√©tricas de distancia que Phyloseq puede utilizar:\n&gt; distanceMethodList \n$UniFrac [1] \"unifrac\"  \"wunifrac\"  \n$DPCoA [1] \"dpcoa\"  \n$JSD [1] \"jsd\"  \n$vegdist  [1] \"manhattan\"  \"euclidean\"  \"canberra\"   \"bray\"       \"kulczynski\" \"jaccard\"    \"gower\"       [8] \"altGower\"   \"morisita\"   \"horn\"       \"mountford\"  \"raup\"       \"binomial\"   \"chao\"       [15] \"cao\"       $betadiver  [1] \"w\"   \"-1\"  \"c\"   \"wb\"  \"r\"   \"I\"   \"e\"   \"t\"   \"me\"  \"j\"   \"sor\" \"m\"   \"-2\"  \"co\"  \"cc\"  \"g\"   [17] \"-3\"  \"l\"   \"19\"  \"hk\"  \"rlb\" \"sim\" \"gl\"  \"z\"    $dist [1] \"maximum\"   \"binary\"    \"minkowski\"  $designdist [1] \"ANY\" \nDescribir todas estas posibles m√©tricas de distancia est√° m√°s all√° del alcance de esta lecci√≥n, pero aqu√≠ mostramos cu√°les son las que necesitan una relaci√≥n filogen√©tica entre las especies-OTU presentes en nuestras muestras:\n\nUnifrac\nPeso-Unifrac\nDPCoA\n\nNo disponemos de un √°rbol filogen√©tico ni de relaciones filogen√©ticas. Por lo tanto, no podemos usar ninguno de estos tres. Usaremos Bray-Curtis, ya que es una de las m√©tricas de distancia m√°s robustas y utilizadas para calcular la diversidad beta.\n¬°Sigamos as√≠! Ya tenemos todo lo necesario para comenzar el an√°lisis de diversidad beta. Usaremos el comando Phyloseq ordinatepara generar un nuevo objeto donde se asignar√°n las distancias entre nuestras muestras despu√©s de calcularlas. Para este comando, debemos especificar el m√©todo que usaremos para generar una matriz. En este ejemplo, usaremos el Escalamiento Multidimensional No M√©trico o NMDS . NMDS intenta representar la disimilitud entre objetos en un espacio de baja dimensi√≥n; en este caso, un gr√°fico bidimensional.\n&gt; meta_ord &lt;- ordinate(physeq = percentages, method = \"NMDS\",                       distance = \"bray\") \nEs com√∫n recibir mensajes de advertencia en la consola de R cuando se ejecuta este script, no te preocupes. Esto se debe a que solo tenemos tres muestras. Con pocas muestras, el algoritmo advierte sobre la poca dificultad para generar la matriz de distancias.\nPor ahora, solo necesitamos el comando plot_ordination()para ver los resultados de nuestro an√°lisis de diversidad beta:\n&gt; plot_ordination(physeq = percentages, ordination = meta_ord)\n\n\n\n\n\nEn este gr√°fico NMDS, cada punto representa la abundancia combinada de todas sus OTU. Como se muestra, cada muestra ocupa espacio en el gr√°fico sin formar grupos. Este resultado se debe a que cada muestra es lo suficientemente diferente como para considerarse un punto independiente en el espacio NMDS.\nUn ejemplo de un estudio con mayor n√∫mero de muestras se ve de este modo:\n\n\n\n\n\nEn el ejemplo podemos ver la estructura de las comunidades diferenciadas de acuerdo con su regi√≥n geogr√°fica y a si son hongos o bacterias. Si quieres saber m√°s de este ejemplo, puedes leer el art√≠culo:\nRegional biogeography versus intra-annual dynamics of the root and soil microbiome.\n\n\n\n\n\n\nDiscusi√≥n: √çndices de diversidad\n\n\n\n¬øPor qu√© cree que necesitamos diferentes √≠ndices para evaluar la diversidad?\nSer√° dif√≠cil (si no imposible) tomar dos comunidades y observar la misma distribuci√≥n de todos los miembros. Este resultado se debe a que hay muchos¬†factores¬†que afectan a estos linajes. Algunos de los¬†factores ambientales¬†son la temperatura, el pH y la concentraci√≥n de nutrientes. Adem√°s, las interacciones de estas poblaciones, como la competencia, la inhibici√≥n de otras poblaciones y la velocidad de crecimiento, son un importante impulsor de la variaci√≥n (¬†factor bi√≥tico¬†). Una combinaci√≥n de los¬†factores mencionados anteriormente¬†puede interactuar para mantener algunas poblaciones con baja abundancia (¬†taxones raros).¬†Para tener formas de evaluar hip√≥tesis sobre cu√°les de estos procesos pueden estar afectando a la comunidad, utilizamos todos estos diferentes √≠ndices. Algunos enfatizan el n√∫mero de especies y otros la uniformidad de las OTU.",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>19</span>¬† <span class='chapter-title'>Control de calidad</span>"
    ]
  },
  {
    "objectID": "20Analisistaxonomico.html#explora-nuestras-muestras-en-niveles-taxon√≥micos-espec√≠ficos",
    "href": "20Analisistaxonomico.html#explora-nuestras-muestras-en-niveles-taxon√≥micos-espec√≠ficos",
    "title": "20¬† An√°lisis taxon√≥mico con RStudio",
    "section": "",
    "text": "&gt; percentages_glom &lt;- tax_glom(percentages, taxrank = 'Phylum') &gt; View(percentages_glom@tax_table@.Data)\n\n\n\n\n\n\n&gt; percentages_df &lt;- psmelt(percentages_glom) &gt; str(percentages_df)\n\n&gt; absolute_glom &lt;- tax_glom(physeq = merged_metagenomes, taxrank = \"Phylum\") \n&gt; absolute_df &lt;- psmelt(absolute_glom) \n&gt; str(absolute_df)\n\n &gt; absolute_df$Phylum &lt;- as.factor(absolute_df$Phylum) \n &gt; phylum_colors_abs&lt;- colorRampPalette(brewer.pal(8,\"Dark2\")) (length(levels(absolute_df$Phylum))) \n\n&gt; absolute_plot &lt;- ggplot(data= absolute_df, aes(x=Sample, y=Abundance, fill=Phylum))+      geom_bar(aes(), stat=\"identity\", position=\"stack\")+     scale_fill_manual(values = phylum_colors_abs)\n\n\n&gt; percentages_df$Phylum &lt;- as.factor(percentages_df$Phylum) \n&gt; phylum_colors_rel&lt;- colorRampPalette(brewer.pal(8,\"Dark2\")) (length(levels(percentages_df$Phylum))) \n&gt; relative_plot &lt;- ggplot(data=percentages_df, aes(x=Sample, y=Abundance, fill=Phylum))+      geom_bar(aes(), stat=\"identity\", position=\"stack\")+     scale_fill_manual(values = phylum_colors_rel) \n&gt; absolute_plot | relative_plot\n\n\n\n\n\n\n&gt; percentages_df$Phylum &lt;- as.character(percentages_df$Phylum) # Return the Phylum column to be of type character \n&gt; percentages_df$Phylum[percentages_df$Abundance &lt; 0.5] &lt;- \"Phyla &lt; 0.5% abund.\" \n&gt; unique(percentages_df$Phylum)\n\n&gt; percentages_df$Phylum &lt;- as.factor(percentages_df$Phylum) &gt; phylum_colors_rel&lt;- colorRampPalette(brewer.pal(8,\"Dark2\")) (length(levels(percentages_df$Phylum))) &gt; relative_plot &lt;- ggplot(data=percentages_df, aes(x=Sample, y=Abundance, fill=Phylum))+    geom_bar(aes(), stat=\"identity\", position=\"stack\")+   scale_fill_manual(values = phylum_colors_rel) &gt; absolute_plot | relative_plot",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>20</span>¬† <span class='chapter-title'>An√°lisis taxon√≥mico con RStudio</span>"
    ]
  },
  {
    "objectID": "20Analisistaxonomico.html#explorando-linajes",
    "href": "20Analisistaxonomico.html#explorando-linajes",
    "title": "20¬† An√°lisis taxon√≥mico con RStudio",
    "section": "20.2 Explorando linajes",
    "text": "20.2 Explorando linajes\nPhyloseq ofrece numerosas herramientas para gestionar y explorar datos. Analicemos una funci√≥n que ya usamos, el comando subset_taxa se usa para extraer linajes espec√≠ficos de un nivel taxon√≥mico determinado; lo hemos usado para descartar las lecturas que no pertenecen a bacterias con merged_metagenomes &lt;- subset_taxa(merged_metagenomes, Kingdom == \"Bacteria\").\nLo usaremos ahora para extraer un filo espec√≠fico de nuestros datos y explorarlo a un nivel taxon√≥mico inferior: g√©nero. Tomaremos como ejemplo el filo cianobacterias.\n&gt; cyanos &lt;- subset_taxa(merged_metagenomes, Phylum == \"Cyanobacteria\") &gt; unique(cyanos@tax_table@.Data[,2])\nHagamos un peque√±o repaso de todo lo que vimos hoy: Transformaci√≥n de los datos; Manipulaci√≥n de la informaci√≥n; y graficaci√≥n :\n&gt; cyanos_percentages &lt;- transform_sample_counts(cyanos, function(x) x*100 / sum(x) ) \n&gt; cyanos_glom &lt;- tax_glom(cyanos_percentages, taxrank = \"Genus\") \n&gt; cyanos_df &lt;- psmelt(cyanos_glom) \n&gt; cyanos_df$Genus[cyanos_df$Abundance &lt; 10] &lt;- \"Genera &lt; 10.0 abund\" \n&gt; cyanos_df$Genus &lt;- as.factor(cyanos_df$Genus) \n&gt; genus_colors_cyanos&lt;- colorRampPalette(brewer.pal(8,\"Dark2\")) (length(levels(cyanos_df$Genus)))   \n&gt; plot_cyanos &lt;- ggplot(data=cyanos_df, aes(x=Sample, y=Abundance, fill=Genus))+      geom_bar(aes(), stat=\"identity\", position=\"stack\")+     scale_fill_manual(values = genus_colors_cyanos) \n&gt; plot_cyanos",
    "crumbs": [
      "**Secci√≥n 4** - Procesamiento y visualizaci√≥n de datos metagen√≥micos",
      "<span class='chapter-number'>20</span>¬† <span class='chapter-title'>An√°lisis taxon√≥mico con RStudio</span>"
    ]
  },
  {
    "objectID": "4IntroduccionnavigationShell.html#paso-1-verifica-los-requisitos-previos",
    "href": "4IntroduccionnavigationShell.html#paso-1-verifica-los-requisitos-previos",
    "title": "4¬† Introducci√≥n a Shell",
    "section": "6.1 Paso 1: Verifica los requisitos previos",
    "text": "6.1 Paso 1: Verifica los requisitos previos\nAntes de comenzar, aseg√∫rate de contar con lo siguiente:\n\nUn navegador web actualizado (Chrome, Firefox o Edge).\nCredenciales de acceso: nombre de usuario y contrase√±a, proporcionados por el administrador del servidor.\nEl enlace de acceso al servidor Betterlab: https://bioinformatica.matmor.unam.mx/rstudio/auth-sign-in?appUri=%2F\n\n\nLos instructores te han proporcionado la lista de usuarios de Betterlab.Escribe tu nombre en alguno de los usuarios disponibles y toma nota de tu usuario y contrase√±a.",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Introducci√≥n a Shell</span>"
    ]
  },
  {
    "objectID": "4IntroduccionnavigationShell.html#paso-2-accede-al-enlace",
    "href": "4IntroduccionnavigationShell.html#paso-2-accede-al-enlace",
    "title": "4¬† Introducci√≥n a Shell",
    "section": "6.2 Paso 2: Accede al enlace",
    "text": "6.2 Paso 2: Accede al enlace\n\nAbre tu navegador web e ingresa el siguiente URL en la barra de direcciones (copia y pega o da clic al link): https://bioinformatica.matmor.unam.mx/rstudio/auth-sign-in?appUri=%2F\nPresiona Enter para cargar la p√°gina.",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Introducci√≥n a Shell</span>"
    ]
  },
  {
    "objectID": "4IntroduccionnavigationShell.html#paso-3-inicia-sesi√≥n",
    "href": "4IntroduccionnavigationShell.html#paso-3-inicia-sesi√≥n",
    "title": "4¬† Introducci√≥n a Shell",
    "section": "6.3 Paso 3: Inicia sesi√≥n",
    "text": "6.3 Paso 3: Inicia sesi√≥n\nEn la pantalla de inicio de sesi√≥n, introduce tus credenciales, por ejemplo:\n\nUsuario: alumno10.\nContrase√±a: (Escribe la contrase√±a correspondiente de la hoja de usuarios)\nHaz clic en Iniciar sesi√≥n o presiona Enter.",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Introducci√≥n a Shell</span>"
    ]
  },
  {
    "objectID": "4IntroduccionnavigationShell.html#paso-4-explora-rstudio-en-bettertab",
    "href": "4IntroduccionnavigationShell.html#paso-4-explora-rstudio-en-bettertab",
    "title": "4¬† Introducci√≥n a Shell",
    "section": "6.4 Paso 4: Explora RStudio en Bettertab",
    "text": "6.4 Paso 4: Explora RStudio en Bettertab\nUna vez que hayas iniciado sesi√≥n, se abrir√° la interfaz de usuario de RStudio. Aqu√≠ puedes:\n\nCrear, cargar y ejecutar scripts en R.\nGestionar tus proyectos.\nAcceder a datos y recursos alojados en el servidor Bettertab.\nCuando entramos veremos cuatro ventanas:\n\n\n\n6.4.1 Script o Editor de C√≥digo (Ventana superior izquierda)\n\nUso: Aqu√≠ escribes, editas y guardas tus scripts de R.\n\nCaracter√≠sticas principales:\n\nPuedes abrir varios archivos a la vez en pesta√±as.\nPermite ejecutar l√≠neas o bloques de c√≥digo presionando Ctrl+Enter (o Cmd+Enter en Mac).\nPrueba: Haz el comando getwd() para saber cual es tu directorio de trabajo\n\n\n\n\n6.4.2 Consola (Console) (Ventana inferior izquierda)\n\nUso: Aqu√≠ se ejecuta el c√≥digo de manera directa.\nMuestra los resultados y mensajes de salida.\n\nCaracter√≠sticas:\n\nPuedes escribir comandos directamente para probar ideas r√°pidas.\nRepite el mismo ejercicio anterior.\n\n\n\n6.4.3 3.4.3 3. Entorno y/o Historial (Ventana superior derecha)\n\nPesta√±a Entorno: Muestra los objetos que has creado (como variables, funciones, y datos cargados).\nPesta√±a Historial: Muestra todos los comandos ejecutados en la sesi√≥n.\nTip: Puedes hacer clic en los objetos para inspeccionarlos o eliminarlos (bot√≥n de escoba).\n\n\n\n\n6.4.4 Archivos, Gr√°ficos, Paquetes, y Ayuda (Ventana inferior derecha)\nUso:\n\nArchivos: Explora las carpetas y archivos en tu directorio de trabajo.\nGr√°ficos: Muestra los gr√°ficos generados con tu c√≥digo.\nPaquetes: Administra e instala paquetes de R.\nAyuda: Busca documentaci√≥n sobre funciones y comandos de R.\n\n\n\n\n6.4.5 Terminal (Bash)\n\nPesta√±a en la ventana inferior izquierda, junto a la Consola.\n\nUso:\n\nEs un terminal de l√≠nea de comandos para ejecutar comandos en Bash directamente desde RStudio.\n√ötil para tareas del sistema, como mover archivos, instalar software o trabajar con Git.\nEjemplo: Puedes usar ls para listar archivos.\n\nPaso 5: Cerrar sesi√≥n\nCuando termines de trabajar:\n\nHaz clic en el bot√≥n Cerrar sesi√≥n ubicado en la esquina superior derecha.\nCierra la pesta√±a del navegador para garantizar que tu sesi√≥n quede cerrada.",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Introducci√≥n a Shell</span>"
    ]
  },
  {
    "objectID": "5Operacionesyexploraciondefastq.html#detalles-sobre-el-formato-fastq",
    "href": "5Operacionesyexploraciondefastq.html#detalles-sobre-el-formato-fastq",
    "title": "5¬† Trabajar con archivos y directorios",
    "section": "",
    "text": "L√≠nea\nContenido\n\n\n\n\n1\nComienza con @, seguida del identificador de la lectura\n\n\n2\nSecuencia de ADN (A, T, G, C, o N si hay ambig√ºedad)\n\n\n3\nComienza con + (a veces repite el identificador)\n\n\n4\nCadena de caracteres que representa la calidad de cada base\n\n\n\n\n\n$ cd ~/dc_workshop/data/untrimmed_fastq\n\n$ gunzip *.gz\n$ cat JC1A_R2.fastq\n\n\n$ less JC1A_R2.fastq\n\n\n\nBuscar hacia adelante\n\n\n\n\n\n\nRepetir la misma b√∫squeda hacia adelante\n\n\n\n\n\nBuscar hacia atr√°s\n\n\n\n\n\n5.1.1 Ver solo el principio o el final\nA veces solo quieres echar un vistazo r√°pido al inicio o al cierre de un archivo muy largo. Para ello:\n\nPrimeras l√≠neas con head\nhead``archivo.txt muestra las primeras 10 l√≠neas por defecto head -n 5 archivo.txtmuestra solo las primeras 5 l√≠neas\nUltimas l√≠neas con tail\ntail archivo.txt muestra las √∫ltimas 10 l√≠neas por defecto tail -n 5 archivo.txtmuestra solo las √∫ltimas 5 l√≠neas",
    "crumbs": [
      "**Secci√≥n 2** - Introducci√≥n a l√≠nea de comandos",
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>**Trabajar con archivos y directorios**</span>"
    ]
  }
]